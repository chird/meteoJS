/*! meteoJS v1.6.0 | (c) Ivo Sonderegger, SRF Meteo | https://chird.github.io/meteoJS/LICENSE */
var meteoJS=function(t){var e={};function i(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(n,o,function(e){return t[e]}.bind(null,o));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=7)}([function(t,e){t.exports=$},function(t,e){t.exports=SVG},function(t,e,i){var n,o,r;function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}r=function(){"use strict";function t(t,n,o,r,s){!function t(i,n,o,r,s){for(;r>o;){if(r-o>600){var a=r-o+1,u=n-o+1,l=Math.log(a),c=.5*Math.exp(2*l/3),h=.5*Math.sqrt(l*c*(a-c)/a)*(u-a/2<0?-1:1),f=Math.max(o,Math.floor(n-u*c/a+h)),p=Math.min(r,Math.floor(n+(a-u)*c/a+h));t(i,n,f,p,s)}var d=i[n],y=o,v=r;for(e(i,o,n),s(i[r],d)>0&&e(i,o,r);y<v;){for(e(i,y,v),y++,v--;s(i[y],d)<0;)y++;for(;s(i[v],d)>0;)v--}0===s(i[o],d)?e(i,o,v):(v++,e(i,v,r)),v<=n&&(o=v+1),n<=v&&(r=v-1)}}(t,n,o||0,r||t.length-1,s||i)}function e(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function i(t,e){return t<e?-1:t>e?1:0}var n=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function o(t,e,i){if(!i)return e.indexOf(t);for(var n=0;n<e.length;n++)if(i(t,e[n]))return n;return-1}function r(t,e){s(t,0,t.children.length,e,t)}function s(t,e,i,n,o){o||(o=d(null)),o.minX=1/0,o.minY=1/0,o.maxX=-1/0,o.maxY=-1/0;for(var r=e;r<i;r++){var s=t.children[r];a(o,t.leaf?n(s):s)}return o}function a(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function u(t,e){return t.minX-e.minX}function l(t,e){return t.minY-e.minY}function c(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function h(t){return t.maxX-t.minX+(t.maxY-t.minY)}function f(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function p(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function d(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function y(e,i,n,o,r){for(var s=[i,n];s.length;)if(!((n=s.pop())-(i=s.pop())<=o)){var a=i+Math.ceil((n-i)/o/2)*o;t(e,a,i,n,r),s.push(i,a,a,n)}}return n.prototype.all=function(){return this._all(this.data,[])},n.prototype.search=function(t){var e=this.data,i=[];if(!p(t,e))return i;for(var n=this.toBBox,o=[];e;){for(var r=0;r<e.children.length;r++){var s=e.children[r],a=e.leaf?n(s):s;p(t,a)&&(e.leaf?i.push(s):f(t,a)?this._all(s,i):o.push(s))}e=o.pop()}return i},n.prototype.collides=function(t){var e=this.data;if(!p(t,e))return!1;for(var i=[];e;){for(var n=0;n<e.children.length;n++){var o=e.children[n],r=e.leaf?this.toBBox(o):o;if(p(t,r)){if(e.leaf||f(t,r))return!0;i.push(o)}}e=i.pop()}return!1},n.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var n=this.data;this.data=i,i=n}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},n.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},n.prototype.clear=function(){return this.data=d([]),this},n.prototype.remove=function(t,e){if(!t)return this;for(var i,n,r,s=this.data,a=this.toBBox(t),u=[],l=[];s||u.length;){if(s||(s=u.pop(),n=u[u.length-1],i=l.pop(),r=!0),s.leaf){var c=o(t,s.children,e);if(-1!==c)return s.children.splice(c,1),u.push(s),this._condense(u),this}r||s.leaf||!f(s,a)?n?(i++,s=n.children[i],r=!1):s=null:(u.push(s),l.push(i),i=0,n=s,s=s.children[0])}return this},n.prototype.toBBox=function(t){return t},n.prototype.compareMinX=function(t,e){return t.minX-e.minX},n.prototype.compareMinY=function(t,e){return t.minY-e.minY},n.prototype.toJSON=function(){return this.data},n.prototype.fromJSON=function(t){return this.data=t,this},n.prototype._all=function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},n.prototype._build=function(t,e,i,n){var o,s=i-e+1,a=this._maxEntries;if(s<=a)return r(o=d(t.slice(e,i+1)),this.toBBox),o;n||(n=Math.ceil(Math.log(s)/Math.log(a)),a=Math.ceil(s/Math.pow(a,n-1))),(o=d([])).leaf=!1,o.height=n;var u=Math.ceil(s/a),l=u*Math.ceil(Math.sqrt(a));y(t,e,i,l,this.compareMinX);for(var c=e;c<=i;c+=l){var h=Math.min(c+l-1,i);y(t,c,h,u,this.compareMinY);for(var f=c;f<=h;f+=u){var p=Math.min(f+u-1,h);o.children.push(this._build(t,f,p,n-1))}}return r(o,this.toBBox),o},n.prototype._chooseSubtree=function(t,e,i,n){for(;n.push(e),!e.leaf&&n.length-1!==i;){for(var o=1/0,r=1/0,s=void 0,a=0;a<e.children.length;a++){var u=e.children[a],l=c(u),h=(f=t,p=u,(Math.max(p.maxX,f.maxX)-Math.min(p.minX,f.minX))*(Math.max(p.maxY,f.maxY)-Math.min(p.minY,f.minY))-l);h<r?(r=h,o=l<o?l:o,s=u):h===r&&l<o&&(o=l,s=u)}e=s||e.children[0]}var f,p;return e},n.prototype._insert=function(t,e,i){var n=i?t:this.toBBox(t),o=[],r=this._chooseSubtree(n,this.data,e,o);for(r.children.push(t),a(r,n);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(n,o,e)},n.prototype._split=function(t,e){var i=t[e],n=i.children.length,o=this._minEntries;this._chooseSplitAxis(i,o,n);var s=this._chooseSplitIndex(i,o,n),a=d(i.children.splice(s,i.children.length-s));a.height=i.height,a.leaf=i.leaf,r(i,this.toBBox),r(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(i,a)},n.prototype._splitRoot=function(t,e){this.data=d([t,e]),this.data.height=t.height+1,this.data.leaf=!1,r(this.data,this.toBBox)},n.prototype._chooseSplitIndex=function(t,e,i){for(var n,o,r,a,u,l,h,f=1/0,p=1/0,d=e;d<=i-e;d++){var y=s(t,0,d,this.toBBox),v=s(t,d,i,this.toBBox),g=(o=y,r=v,a=void 0,u=void 0,l=void 0,h=void 0,a=Math.max(o.minX,r.minX),u=Math.max(o.minY,r.minY),l=Math.min(o.maxX,r.maxX),h=Math.min(o.maxY,r.maxY),Math.max(0,l-a)*Math.max(0,h-u)),m=c(y)+c(v);g<f?(f=g,n=d,p=m<p?m:p):g===f&&m<p&&(p=m,n=d)}return n||i-e},n.prototype._chooseSplitAxis=function(t,e,i){var n=t.leaf?this.compareMinX:u,o=t.leaf?this.compareMinY:l;this._allDistMargin(t,e,i,n)<this._allDistMargin(t,e,i,o)&&t.children.sort(n)},n.prototype._allDistMargin=function(t,e,i,n){t.children.sort(n);for(var o=this.toBBox,r=s(t,0,e,o),u=s(t,i-e,i,o),l=h(r)+h(u),c=e;c<i-e;c++){var f=t.children[c];a(r,t.leaf?o(f):f),l+=h(r)}for(var p=i-e-1;p>=e;p--){var d=t.children[p];a(u,t.leaf?o(d):d),l+=h(u)}return l},n.prototype._adjustParentBBoxes=function(t,e,i){for(var n=i;n>=0;n--)a(e[n],t)},n.prototype._condense=function(t){for(var e=t.length-1,i=void 0;e>=0;e--)0===t[e].children.length?e>0?(i=t[e-1].children).splice(i.indexOf(t[e]),1):this.clear():r(t[e],this.toBBox)},n},"object"===s(e)&&void 0!==t?t.exports=r():void 0===(o="function"==typeof(n=r)?n.call(e,i,e,t):n)||(t.exports=o)},function(t,e,i){"use strict";i.r(e),function(t){
/**!
 * @fileOverview Kickass library to create and place poppers near their reference elements.
 * @version 1.16.1
 * @license
 * Copyright (c) 2016 Federico Zivolo and contributors
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */
var i="undefined"!=typeof window&&"undefined"!=typeof document&&"undefined"!=typeof navigator,n=function(){for(var t=["Edge","Trident","Firefox"],e=0;e<t.length;e+=1)if(i&&navigator.userAgent.indexOf(t[e])>=0)return 1;return 0}();var o=i&&window.Promise?function(t){var e=!1;return function(){e||(e=!0,window.Promise.resolve().then((function(){e=!1,t()})))}}:function(t){var e=!1;return function(){e||(e=!0,setTimeout((function(){e=!1,t()}),n))}};function r(t){return t&&"[object Function]"==={}.toString.call(t)}function s(t,e){if(1!==t.nodeType)return[];var i=t.ownerDocument.defaultView.getComputedStyle(t,null);return e?i[e]:i}function a(t){return"HTML"===t.nodeName?t:t.parentNode||t.host}function u(t){if(!t)return document.body;switch(t.nodeName){case"HTML":case"BODY":return t.ownerDocument.body;case"#document":return t.body}var e=s(t),i=e.overflow,n=e.overflowX,o=e.overflowY;return/(auto|scroll|overlay)/.test(i+o+n)?t:u(a(t))}function l(t){return t&&t.referenceNode?t.referenceNode:t}var c=i&&!(!window.MSInputMethodContext||!document.documentMode),h=i&&/MSIE 10/.test(navigator.userAgent);function f(t){return 11===t?c:10===t?h:c||h}function p(t){if(!t)return document.documentElement;for(var e=f(10)?document.body:null,i=t.offsetParent||null;i===e&&t.nextElementSibling;)i=(t=t.nextElementSibling).offsetParent;var n=i&&i.nodeName;return n&&"BODY"!==n&&"HTML"!==n?-1!==["TH","TD","TABLE"].indexOf(i.nodeName)&&"static"===s(i,"position")?p(i):i:t?t.ownerDocument.documentElement:document.documentElement}function d(t){return null!==t.parentNode?d(t.parentNode):t}function y(t,e){if(!(t&&t.nodeType&&e&&e.nodeType))return document.documentElement;var i=t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_FOLLOWING,n=i?t:e,o=i?e:t,r=document.createRange();r.setStart(n,0),r.setEnd(o,0);var s,a,u=r.commonAncestorContainer;if(t!==u&&e!==u||n.contains(o))return"BODY"===(a=(s=u).nodeName)||"HTML"!==a&&p(s.firstElementChild)!==s?p(u):u;var l=d(t);return l.host?y(l.host,e):y(t,d(e).host)}function v(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top",i="top"===e?"scrollTop":"scrollLeft",n=t.nodeName;if("BODY"===n||"HTML"===n){var o=t.ownerDocument.documentElement,r=t.ownerDocument.scrollingElement||o;return r[i]}return t[i]}function g(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=v(e,"top"),o=v(e,"left"),r=i?-1:1;return t.top+=n*r,t.bottom+=n*r,t.left+=o*r,t.right+=o*r,t}function m(t,e){var i="x"===e?"Left":"Top",n="Left"===i?"Right":"Bottom";return parseFloat(t["border"+i+"Width"])+parseFloat(t["border"+n+"Width"])}function _(t,e,i,n){return Math.max(e["offset"+t],e["scroll"+t],i["client"+t],i["offset"+t],i["scroll"+t],f(10)?parseInt(i["offset"+t])+parseInt(n["margin"+("Height"===t?"Top":"Left")])+parseInt(n["margin"+("Height"===t?"Bottom":"Right")]):0)}function b(t){var e=t.body,i=t.documentElement,n=f(10)&&getComputedStyle(i);return{height:_("Height",e,i,n),width:_("Width",e,i,n)}}var w=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},x=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),S=function(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t},T=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t};function O(t){return T({},t,{right:t.left+t.width,bottom:t.top+t.height})}function C(t){var e={};try{if(f(10)){e=t.getBoundingClientRect();var i=v(t,"top"),n=v(t,"left");e.top+=i,e.left+=n,e.bottom+=i,e.right+=n}else e=t.getBoundingClientRect()}catch(t){}var o={left:e.left,top:e.top,width:e.right-e.left,height:e.bottom-e.top},r="HTML"===t.nodeName?b(t.ownerDocument):{},a=r.width||t.clientWidth||o.width,u=r.height||t.clientHeight||o.height,l=t.offsetWidth-a,c=t.offsetHeight-u;if(l||c){var h=s(t);l-=m(h,"x"),c-=m(h,"y"),o.width-=l,o.height-=c}return O(o)}function E(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=f(10),o="HTML"===e.nodeName,r=C(t),a=C(e),l=u(t),c=s(e),h=parseFloat(c.borderTopWidth),p=parseFloat(c.borderLeftWidth);i&&o&&(a.top=Math.max(a.top,0),a.left=Math.max(a.left,0));var d=O({top:r.top-a.top-h,left:r.left-a.left-p,width:r.width,height:r.height});if(d.marginTop=0,d.marginLeft=0,!n&&o){var y=parseFloat(c.marginTop),v=parseFloat(c.marginLeft);d.top-=h-y,d.bottom-=h-y,d.left-=p-v,d.right-=p-v,d.marginTop=y,d.marginLeft=v}return(n&&!i?e.contains(l):e===l&&"BODY"!==l.nodeName)&&(d=g(d,e)),d}function P(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=t.ownerDocument.documentElement,n=E(t,i),o=Math.max(i.clientWidth,window.innerWidth||0),r=Math.max(i.clientHeight,window.innerHeight||0),s=e?0:v(i),a=e?0:v(i,"left"),u={top:s-n.top+n.marginTop,left:a-n.left+n.marginLeft,width:o,height:r};return O(u)}function R(t){var e=t.nodeName;if("BODY"===e||"HTML"===e)return!1;if("fixed"===s(t,"position"))return!0;var i=a(t);return!!i&&R(i)}function I(t){if(!t||!t.parentElement||f())return document.documentElement;for(var e=t.parentElement;e&&"none"===s(e,"transform");)e=e.parentElement;return e||document.documentElement}function k(t,e,i,n){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],r={top:0,left:0},s=o?I(t):y(t,l(e));if("viewport"===n)r=P(s,o);else{var c=void 0;"scrollParent"===n?"BODY"===(c=u(a(e))).nodeName&&(c=t.ownerDocument.documentElement):c="window"===n?t.ownerDocument.documentElement:n;var h=E(c,s,o);if("HTML"!==c.nodeName||R(s))r=h;else{var f=b(t.ownerDocument),p=f.height,d=f.width;r.top+=h.top-h.marginTop,r.bottom=p+h.top,r.left+=h.left-h.marginLeft,r.right=d+h.left}}var v="number"==typeof(i=i||0);return r.left+=v?i:i.left||0,r.top+=v?i:i.top||0,r.right-=v?i:i.right||0,r.bottom-=v?i:i.bottom||0,r}function j(t){return t.width*t.height}function L(t,e,i,n,o){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;if(-1===t.indexOf("auto"))return t;var s=k(i,n,r,o),a={top:{width:s.width,height:e.top-s.top},right:{width:s.right-e.right,height:s.height},bottom:{width:s.width,height:s.bottom-e.bottom},left:{width:e.left-s.left,height:s.height}},u=Object.keys(a).map((function(t){return T({key:t},a[t],{area:j(a[t])})})).sort((function(t,e){return e.area-t.area})),l=u.filter((function(t){var e=t.width,n=t.height;return e>=i.clientWidth&&n>=i.clientHeight})),c=l.length>0?l[0].key:u[0].key,h=t.split("-")[1];return c+(h?"-"+h:"")}function M(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=n?I(e):y(e,l(i));return E(i,o,n)}function F(t){var e=t.ownerDocument.defaultView.getComputedStyle(t),i=parseFloat(e.marginTop||0)+parseFloat(e.marginBottom||0),n=parseFloat(e.marginLeft||0)+parseFloat(e.marginRight||0);return{width:t.offsetWidth+n,height:t.offsetHeight+i}}function D(t){var e={left:"right",right:"left",bottom:"top",top:"bottom"};return t.replace(/left|right|bottom|top/g,(function(t){return e[t]}))}function A(t,e,i){i=i.split("-")[0];var n=F(t),o={width:n.width,height:n.height},r=-1!==["right","left"].indexOf(i),s=r?"top":"left",a=r?"left":"top",u=r?"height":"width",l=r?"width":"height";return o[s]=e[s]+e[u]/2-n[u]/2,o[a]=i===a?e[a]-n[l]:e[D(a)],o}function N(t,e){return Array.prototype.find?t.find(e):t.filter(e)[0]}function G(t,e,i){return(void 0===i?t:t.slice(0,function(t,e,i){if(Array.prototype.findIndex)return t.findIndex((function(t){return t[e]===i}));var n=N(t,(function(t){return t[e]===i}));return t.indexOf(n)}(t,"name",i))).forEach((function(t){t.function&&console.warn("`modifier.function` is deprecated, use `modifier.fn`!");var i=t.function||t.fn;t.enabled&&r(i)&&(e.offsets.popper=O(e.offsets.popper),e.offsets.reference=O(e.offsets.reference),e=i(e,t))})),e}function B(){if(!this.state.isDestroyed){var t={instance:this,styles:{},arrowStyles:{},attributes:{},flipped:!1,offsets:{}};t.offsets.reference=M(this.state,this.popper,this.reference,this.options.positionFixed),t.placement=L(this.options.placement,t.offsets.reference,this.popper,this.reference,this.options.modifiers.flip.boundariesElement,this.options.modifiers.flip.padding),t.originalPlacement=t.placement,t.positionFixed=this.options.positionFixed,t.offsets.popper=A(this.popper,t.offsets.reference,t.placement),t.offsets.popper.position=this.options.positionFixed?"fixed":"absolute",t=G(this.modifiers,t),this.state.isCreated?this.options.onUpdate(t):(this.state.isCreated=!0,this.options.onCreate(t))}}function Y(t,e){return t.some((function(t){var i=t.name;return t.enabled&&i===e}))}function X(t){for(var e=[!1,"ms","Webkit","Moz","O"],i=t.charAt(0).toUpperCase()+t.slice(1),n=0;n<e.length;n++){var o=e[n],r=o?""+o+i:t;if(void 0!==document.body.style[r])return r}return null}function z(){return this.state.isDestroyed=!0,Y(this.modifiers,"applyStyle")&&(this.popper.removeAttribute("x-placement"),this.popper.style.position="",this.popper.style.top="",this.popper.style.left="",this.popper.style.right="",this.popper.style.bottom="",this.popper.style.willChange="",this.popper.style[X("transform")]=""),this.disableEventListeners(),this.options.removeOnDestroy&&this.popper.parentNode.removeChild(this.popper),this}function W(t){var e=t.ownerDocument;return e?e.defaultView:window}function V(t,e,i,n){i.updateBound=n,W(t).addEventListener("resize",i.updateBound,{passive:!0});var o=u(t);return function t(e,i,n,o){var r="BODY"===e.nodeName,s=r?e.ownerDocument.defaultView:e;s.addEventListener(i,n,{passive:!0}),r||t(u(s.parentNode),i,n,o),o.push(s)}(o,"scroll",i.updateBound,i.scrollParents),i.scrollElement=o,i.eventsEnabled=!0,i}function K(){this.state.eventsEnabled||(this.state=V(this.reference,this.options,this.state,this.scheduleUpdate))}function q(){var t,e;this.state.eventsEnabled&&(cancelAnimationFrame(this.scheduleUpdate),this.state=(t=this.reference,e=this.state,W(t).removeEventListener("resize",e.updateBound),e.scrollParents.forEach((function(t){t.removeEventListener("scroll",e.updateBound)})),e.updateBound=null,e.scrollParents=[],e.scrollElement=null,e.eventsEnabled=!1,e))}function H(t){return""!==t&&!isNaN(parseFloat(t))&&isFinite(t)}function Z(t,e){Object.keys(e).forEach((function(i){var n="";-1!==["width","height","top","right","bottom","left"].indexOf(i)&&H(e[i])&&(n="px"),t.style[i]=e[i]+n}))}var U=i&&/Firefox/i.test(navigator.userAgent);function J(t,e,i){var n=N(t,(function(t){return t.name===e})),o=!!n&&t.some((function(t){return t.name===i&&t.enabled&&t.order<n.order}));if(!o){var r="`"+e+"`",s="`"+i+"`";console.warn(s+" modifier is required by "+r+" modifier in order to work, be sure to include it before "+r+"!")}return o}var Q=["auto-start","auto","auto-end","top-start","top","top-end","right-start","right","right-end","bottom-end","bottom","bottom-start","left-end","left","left-start"],$=Q.slice(3);function tt(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=$.indexOf(t),n=$.slice(i+1).concat($.slice(0,i));return e?n.reverse():n}var et="flip",it="clockwise",nt="counterclockwise";function ot(t,e,i,n){var o=[0,0],r=-1!==["right","left"].indexOf(n),s=t.split(/(\+|\-)/).map((function(t){return t.trim()})),a=s.indexOf(N(s,(function(t){return-1!==t.search(/,|\s/)})));s[a]&&-1===s[a].indexOf(",")&&console.warn("Offsets separated by white space(s) are deprecated, use a comma (,) instead.");var u=/\s*,\s*|\s+/,l=-1!==a?[s.slice(0,a).concat([s[a].split(u)[0]]),[s[a].split(u)[1]].concat(s.slice(a+1))]:[s];return(l=l.map((function(t,n){var o=(1===n?!r:r)?"height":"width",s=!1;return t.reduce((function(t,e){return""===t[t.length-1]&&-1!==["+","-"].indexOf(e)?(t[t.length-1]=e,s=!0,t):s?(t[t.length-1]+=e,s=!1,t):t.concat(e)}),[]).map((function(t){return function(t,e,i,n){var o=t.match(/((?:\-|\+)?\d*\.?\d*)(.*)/),r=+o[1],s=o[2];if(!r)return t;if(0===s.indexOf("%")){var a=void 0;switch(s){case"%p":a=i;break;case"%":case"%r":default:a=n}return O(a)[e]/100*r}if("vh"===s||"vw"===s){return("vh"===s?Math.max(document.documentElement.clientHeight,window.innerHeight||0):Math.max(document.documentElement.clientWidth,window.innerWidth||0))/100*r}return r}(t,o,e,i)}))}))).forEach((function(t,e){t.forEach((function(i,n){H(i)&&(o[e]+=i*("-"===t[n-1]?-1:1))}))})),o}var rt={placement:"bottom",positionFixed:!1,eventsEnabled:!0,removeOnDestroy:!1,onCreate:function(){},onUpdate:function(){},modifiers:{shift:{order:100,enabled:!0,fn:function(t){var e=t.placement,i=e.split("-")[0],n=e.split("-")[1];if(n){var o=t.offsets,r=o.reference,s=o.popper,a=-1!==["bottom","top"].indexOf(i),u=a?"left":"top",l=a?"width":"height",c={start:S({},u,r[u]),end:S({},u,r[u]+r[l]-s[l])};t.offsets.popper=T({},s,c[n])}return t}},offset:{order:200,enabled:!0,fn:function(t,e){var i=e.offset,n=t.placement,o=t.offsets,r=o.popper,s=o.reference,a=n.split("-")[0],u=void 0;return u=H(+i)?[+i,0]:ot(i,r,s,a),"left"===a?(r.top+=u[0],r.left-=u[1]):"right"===a?(r.top+=u[0],r.left+=u[1]):"top"===a?(r.left+=u[0],r.top-=u[1]):"bottom"===a&&(r.left+=u[0],r.top+=u[1]),t.popper=r,t},offset:0},preventOverflow:{order:300,enabled:!0,fn:function(t,e){var i=e.boundariesElement||p(t.instance.popper);t.instance.reference===i&&(i=p(i));var n=X("transform"),o=t.instance.popper.style,r=o.top,s=o.left,a=o[n];o.top="",o.left="",o[n]="";var u=k(t.instance.popper,t.instance.reference,e.padding,i,t.positionFixed);o.top=r,o.left=s,o[n]=a,e.boundaries=u;var l=e.priority,c=t.offsets.popper,h={primary:function(t){var i=c[t];return c[t]<u[t]&&!e.escapeWithReference&&(i=Math.max(c[t],u[t])),S({},t,i)},secondary:function(t){var i="right"===t?"left":"top",n=c[i];return c[t]>u[t]&&!e.escapeWithReference&&(n=Math.min(c[i],u[t]-("right"===t?c.width:c.height))),S({},i,n)}};return l.forEach((function(t){var e=-1!==["left","top"].indexOf(t)?"primary":"secondary";c=T({},c,h[e](t))})),t.offsets.popper=c,t},priority:["left","right","top","bottom"],padding:5,boundariesElement:"scrollParent"},keepTogether:{order:400,enabled:!0,fn:function(t){var e=t.offsets,i=e.popper,n=e.reference,o=t.placement.split("-")[0],r=Math.floor,s=-1!==["top","bottom"].indexOf(o),a=s?"right":"bottom",u=s?"left":"top",l=s?"width":"height";return i[a]<r(n[u])&&(t.offsets.popper[u]=r(n[u])-i[l]),i[u]>r(n[a])&&(t.offsets.popper[u]=r(n[a])),t}},arrow:{order:500,enabled:!0,fn:function(t,e){var i;if(!J(t.instance.modifiers,"arrow","keepTogether"))return t;var n=e.element;if("string"==typeof n){if(!(n=t.instance.popper.querySelector(n)))return t}else if(!t.instance.popper.contains(n))return console.warn("WARNING: `arrow.element` must be child of its popper element!"),t;var o=t.placement.split("-")[0],r=t.offsets,a=r.popper,u=r.reference,l=-1!==["left","right"].indexOf(o),c=l?"height":"width",h=l?"Top":"Left",f=h.toLowerCase(),p=l?"left":"top",d=l?"bottom":"right",y=F(n)[c];u[d]-y<a[f]&&(t.offsets.popper[f]-=a[f]-(u[d]-y)),u[f]+y>a[d]&&(t.offsets.popper[f]+=u[f]+y-a[d]),t.offsets.popper=O(t.offsets.popper);var v=u[f]+u[c]/2-y/2,g=s(t.instance.popper),m=parseFloat(g["margin"+h]),_=parseFloat(g["border"+h+"Width"]),b=v-t.offsets.popper[f]-m-_;return b=Math.max(Math.min(a[c]-y,b),0),t.arrowElement=n,t.offsets.arrow=(S(i={},f,Math.round(b)),S(i,p,""),i),t},element:"[x-arrow]"},flip:{order:600,enabled:!0,fn:function(t,e){if(Y(t.instance.modifiers,"inner"))return t;if(t.flipped&&t.placement===t.originalPlacement)return t;var i=k(t.instance.popper,t.instance.reference,e.padding,e.boundariesElement,t.positionFixed),n=t.placement.split("-")[0],o=D(n),r=t.placement.split("-")[1]||"",s=[];switch(e.behavior){case et:s=[n,o];break;case it:s=tt(n);break;case nt:s=tt(n,!0);break;default:s=e.behavior}return s.forEach((function(a,u){if(n!==a||s.length===u+1)return t;n=t.placement.split("-")[0],o=D(n);var l=t.offsets.popper,c=t.offsets.reference,h=Math.floor,f="left"===n&&h(l.right)>h(c.left)||"right"===n&&h(l.left)<h(c.right)||"top"===n&&h(l.bottom)>h(c.top)||"bottom"===n&&h(l.top)<h(c.bottom),p=h(l.left)<h(i.left),d=h(l.right)>h(i.right),y=h(l.top)<h(i.top),v=h(l.bottom)>h(i.bottom),g="left"===n&&p||"right"===n&&d||"top"===n&&y||"bottom"===n&&v,m=-1!==["top","bottom"].indexOf(n),_=!!e.flipVariations&&(m&&"start"===r&&p||m&&"end"===r&&d||!m&&"start"===r&&y||!m&&"end"===r&&v),b=!!e.flipVariationsByContent&&(m&&"start"===r&&d||m&&"end"===r&&p||!m&&"start"===r&&v||!m&&"end"===r&&y),w=_||b;(f||g||w)&&(t.flipped=!0,(f||g)&&(n=s[u+1]),w&&(r=function(t){return"end"===t?"start":"start"===t?"end":t}(r)),t.placement=n+(r?"-"+r:""),t.offsets.popper=T({},t.offsets.popper,A(t.instance.popper,t.offsets.reference,t.placement)),t=G(t.instance.modifiers,t,"flip"))})),t},behavior:"flip",padding:5,boundariesElement:"viewport",flipVariations:!1,flipVariationsByContent:!1},inner:{order:700,enabled:!1,fn:function(t){var e=t.placement,i=e.split("-")[0],n=t.offsets,o=n.popper,r=n.reference,s=-1!==["left","right"].indexOf(i),a=-1===["top","left"].indexOf(i);return o[s?"left":"top"]=r[i]-(a?o[s?"width":"height"]:0),t.placement=D(e),t.offsets.popper=O(o),t}},hide:{order:800,enabled:!0,fn:function(t){if(!J(t.instance.modifiers,"hide","preventOverflow"))return t;var e=t.offsets.reference,i=N(t.instance.modifiers,(function(t){return"preventOverflow"===t.name})).boundaries;if(e.bottom<i.top||e.left>i.right||e.top>i.bottom||e.right<i.left){if(!0===t.hide)return t;t.hide=!0,t.attributes["x-out-of-boundaries"]=""}else{if(!1===t.hide)return t;t.hide=!1,t.attributes["x-out-of-boundaries"]=!1}return t}},computeStyle:{order:850,enabled:!0,fn:function(t,e){var i=e.x,n=e.y,o=t.offsets.popper,r=N(t.instance.modifiers,(function(t){return"applyStyle"===t.name})).gpuAcceleration;void 0!==r&&console.warn("WARNING: `gpuAcceleration` option moved to `computeStyle` modifier and will not be supported in future versions of Popper.js!");var s=void 0!==r?r:e.gpuAcceleration,a=p(t.instance.popper),u=C(a),l={position:o.position},c=function(t,e){var i=t.offsets,n=i.popper,o=i.reference,r=Math.round,s=Math.floor,a=function(t){return t},u=r(o.width),l=r(n.width),c=-1!==["left","right"].indexOf(t.placement),h=-1!==t.placement.indexOf("-"),f=e?c||h||u%2==l%2?r:s:a,p=e?r:a;return{left:f(u%2==1&&l%2==1&&!h&&e?n.left-1:n.left),top:p(n.top),bottom:p(n.bottom),right:f(n.right)}}(t,window.devicePixelRatio<2||!U),h="bottom"===i?"top":"bottom",f="right"===n?"left":"right",d=X("transform"),y=void 0,v=void 0;if(v="bottom"===h?"HTML"===a.nodeName?-a.clientHeight+c.bottom:-u.height+c.bottom:c.top,y="right"===f?"HTML"===a.nodeName?-a.clientWidth+c.right:-u.width+c.right:c.left,s&&d)l[d]="translate3d("+y+"px, "+v+"px, 0)",l[h]=0,l[f]=0,l.willChange="transform";else{var g="bottom"===h?-1:1,m="right"===f?-1:1;l[h]=v*g,l[f]=y*m,l.willChange=h+", "+f}var _={"x-placement":t.placement};return t.attributes=T({},_,t.attributes),t.styles=T({},l,t.styles),t.arrowStyles=T({},t.offsets.arrow,t.arrowStyles),t},gpuAcceleration:!0,x:"bottom",y:"right"},applyStyle:{order:900,enabled:!0,fn:function(t){var e,i;return Z(t.instance.popper,t.styles),e=t.instance.popper,i=t.attributes,Object.keys(i).forEach((function(t){!1!==i[t]?e.setAttribute(t,i[t]):e.removeAttribute(t)})),t.arrowElement&&Object.keys(t.arrowStyles).length&&Z(t.arrowElement,t.arrowStyles),t},onLoad:function(t,e,i,n,o){var r=M(o,e,t,i.positionFixed),s=L(i.placement,r,e,t,i.modifiers.flip.boundariesElement,i.modifiers.flip.padding);return e.setAttribute("x-placement",s),Z(e,{position:i.positionFixed?"fixed":"absolute"}),i},gpuAcceleration:void 0}}},st=function(){function t(e,i){var n=this,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};w(this,t),this.scheduleUpdate=function(){return requestAnimationFrame(n.update)},this.update=o(this.update.bind(this)),this.options=T({},t.Defaults,s),this.state={isDestroyed:!1,isCreated:!1,scrollParents:[]},this.reference=e&&e.jquery?e[0]:e,this.popper=i&&i.jquery?i[0]:i,this.options.modifiers={},Object.keys(T({},t.Defaults.modifiers,s.modifiers)).forEach((function(e){n.options.modifiers[e]=T({},t.Defaults.modifiers[e]||{},s.modifiers?s.modifiers[e]:{})})),this.modifiers=Object.keys(this.options.modifiers).map((function(t){return T({name:t},n.options.modifiers[t])})).sort((function(t,e){return t.order-e.order})),this.modifiers.forEach((function(t){t.enabled&&r(t.onLoad)&&t.onLoad(n.reference,n.popper,n.options,t,n.state)})),this.update();var a=this.options.eventsEnabled;a&&this.enableEventListeners(),this.state.eventsEnabled=a}return x(t,[{key:"update",value:function(){return B.call(this)}},{key:"destroy",value:function(){return z.call(this)}},{key:"enableEventListeners",value:function(){return K.call(this)}},{key:"disableEventListeners",value:function(){return q.call(this)}}]),t}();st.Utils=("undefined"!=typeof window?window:t).PopperUtils,st.placements=Q,st.Defaults=rt,e.default=st}.call(this,i(6))},function(t,e,i){var n,o,r,s;function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}
/*!
  * Bootstrap util.js v4.5.0 (https://getbootstrap.com/)
  * Copyright 2011-2020 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
  */s=function(t){"use strict";function e(e){var n=this,o=!1;return t(this).one(i.TRANSITION_END,(function(){o=!0})),setTimeout((function(){o||i.triggerTransitionEnd(n)}),e),this}t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t;var i={TRANSITION_END:"bsTransitionEnd",getUID:function(t){do{t+=~~(1e6*Math.random())}while(document.getElementById(t));return t},getSelectorFromElement:function(t){var e=t.getAttribute("data-target");if(!e||"#"===e){var i=t.getAttribute("href");e=i&&"#"!==i?i.trim():""}try{return document.querySelector(e)?e:null}catch(t){return null}},getTransitionDurationFromElement:function(e){if(!e)return 0;var i=t(e).css("transition-duration"),n=t(e).css("transition-delay"),o=parseFloat(i),r=parseFloat(n);return o||r?(i=i.split(",")[0],n=n.split(",")[0],1e3*(parseFloat(i)+parseFloat(n))):0},reflow:function(t){return t.offsetHeight},triggerTransitionEnd:function(e){t(e).trigger("transitionend")},supportsTransitionEnd:function(){return Boolean("transitionend")},isElement:function(t){return(t[0]||t).nodeType},typeCheckConfig:function(t,e,n){for(var o in n)if(Object.prototype.hasOwnProperty.call(n,o)){var r=n[o],s=e[o],a=s&&i.isElement(s)?"element":null==(u=s)?""+u:{}.toString.call(u).match(/\s([a-z]+)/i)[1].toLowerCase();if(!new RegExp(r).test(a))throw new Error(t.toUpperCase()+': Option "'+o+'" provided type "'+a+'" but expected type "'+r+'".')}var u},findShadowRoot:function(t){if(!document.documentElement.attachShadow)return null;if("function"==typeof t.getRootNode){var e=t.getRootNode();return e instanceof ShadowRoot?e:null}return t instanceof ShadowRoot?t:t.parentNode?i.findShadowRoot(t.parentNode):null},jQueryDetection:function(){if(void 0===t)throw new TypeError("Bootstrap's JavaScript requires jQuery. jQuery must be included before Bootstrap's JavaScript.");var e=t.fn.jquery.split(" ")[0].split(".");if(e[0]<2&&e[1]<9||1===e[0]&&9===e[1]&&e[2]<1||e[0]>=4)throw new Error("Bootstrap's JavaScript requires at least jQuery v1.9.1 but less than v4.0.0")}};return i.jQueryDetection(),t.fn.emulateTransitionEnd=e,t.event.special[i.TRANSITION_END]={bindType:"transitionend",delegateType:"transitionend",handle:function(e){if(t(e.target).is(this))return e.handleObj.handler.apply(this,arguments)}},i},"object"===a(e)&&void 0!==t?t.exports=s(i(0)):(o=[i(0)],void 0===(r="function"==typeof(n=s)?n.apply(e,o):n)||(t.exports=r))},function(t,e,i){var n,o,r,s;function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}
/*!
  * Bootstrap tooltip.js v4.5.0 (https://getbootstrap.com/)
  * Copyright 2011-2020 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
  */s=function(t,e,i){"use strict";function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function o(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function r(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function s(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?r(Object(i),!0).forEach((function(e){o(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t,e=e&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e,i=i&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i;var u=["background","cite","href","itemtype","longdesc","poster","src","xlink:href"],l={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},c=/^(?:(?:https?|mailto|ftp|tel|file):|[^#&/:?]*(?:[#/?]|$))/gi,h=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[\d+/a-z]+=*$/i;function f(t,e,i){if(0===t.length)return t;if(i&&"function"==typeof i)return i(t);for(var n=(new window.DOMParser).parseFromString(t,"text/html"),o=Object.keys(e),r=[].slice.call(n.body.querySelectorAll("*")),s=function(t,i){var n=r[t],s=n.nodeName.toLowerCase();if(-1===o.indexOf(n.nodeName.toLowerCase()))return n.parentNode.removeChild(n),"continue";var a=[].slice.call(n.attributes),l=[].concat(e["*"]||[],e[s]||[]);a.forEach((function(t){(function(t,e){var i=t.nodeName.toLowerCase();if(-1!==e.indexOf(i))return-1===u.indexOf(i)||Boolean(t.nodeValue.match(c)||t.nodeValue.match(h));for(var n=e.filter((function(t){return t instanceof RegExp})),o=0,r=n.length;o<r;o++)if(i.match(n[o]))return!0;return!1})(t,l)||n.removeAttribute(t.nodeName)}))},a=0,l=r.length;a<l;a++)s(a);return n.body.innerHTML}var p="tooltip",d=".bs.tooltip",y=t.fn[p],v=new RegExp("(^|\\s)bs-tooltip\\S+","g"),g=["sanitize","whiteList","sanitizeFn"],m={animation:"boolean",template:"string",title:"(string|element|function)",trigger:"string",delay:"(number|object)",html:"boolean",selector:"(string|boolean)",placement:"(string|function)",offset:"(number|string|function)",container:"(string|element|boolean)",fallbackPlacement:"(string|array)",boundary:"(string|element)",sanitize:"boolean",sanitizeFn:"(null|function)",whiteList:"object",popperConfig:"(null|object)"},_={AUTO:"auto",TOP:"top",RIGHT:"right",BOTTOM:"bottom",LEFT:"left"},b={animation:!0,template:'<div class="tooltip" role="tooltip"><div class="arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,selector:!1,placement:"top",offset:0,container:!1,fallbackPlacement:"flip",boundary:"scrollParent",sanitize:!0,sanitizeFn:null,whiteList:l,popperConfig:null},w={HIDE:"hide"+d,HIDDEN:"hidden"+d,SHOW:"show"+d,SHOWN:"shown"+d,INSERTED:"inserted"+d,CLICK:"click"+d,FOCUSIN:"focusin"+d,FOCUSOUT:"focusout"+d,MOUSEENTER:"mouseenter"+d,MOUSELEAVE:"mouseleave"+d},x=function(){function o(t,i){if(void 0===e)throw new TypeError("Bootstrap's tooltips require Popper.js (https://popper.js.org/)");this._isEnabled=!0,this._timeout=0,this._hoverState="",this._activeTrigger={},this._popper=null,this.element=t,this.config=this._getConfig(i),this.tip=null,this._setListeners()}var r,u,l,c=o.prototype;return c.enable=function(){this._isEnabled=!0},c.disable=function(){this._isEnabled=!1},c.toggleEnabled=function(){this._isEnabled=!this._isEnabled},c.toggle=function(e){if(this._isEnabled)if(e){var i=this.constructor.DATA_KEY,n=t(e.currentTarget).data(i);n||(n=new this.constructor(e.currentTarget,this._getDelegateConfig()),t(e.currentTarget).data(i,n)),n._activeTrigger.click=!n._activeTrigger.click,n._isWithActiveTrigger()?n._enter(null,n):n._leave(null,n)}else{if(t(this.getTipElement()).hasClass("show"))return void this._leave(null,this);this._enter(null,this)}},c.dispose=function(){clearTimeout(this._timeout),t.removeData(this.element,this.constructor.DATA_KEY),t(this.element).off(this.constructor.EVENT_KEY),t(this.element).closest(".modal").off("hide.bs.modal",this._hideModalHandler),this.tip&&t(this.tip).remove(),this._isEnabled=null,this._timeout=null,this._hoverState=null,this._activeTrigger=null,this._popper&&this._popper.destroy(),this._popper=null,this.element=null,this.config=null,this.tip=null},c.show=function(){var n=this;if("none"===t(this.element).css("display"))throw new Error("Please use show on visible elements");var o=t.Event(this.constructor.Event.SHOW);if(this.isWithContent()&&this._isEnabled){t(this.element).trigger(o);var r=i.findShadowRoot(this.element),s=t.contains(null!==r?r:this.element.ownerDocument.documentElement,this.element);if(o.isDefaultPrevented()||!s)return;var a=this.getTipElement(),u=i.getUID(this.constructor.NAME);a.setAttribute("id",u),this.element.setAttribute("aria-describedby",u),this.setContent(),this.config.animation&&t(a).addClass("fade");var l="function"==typeof this.config.placement?this.config.placement.call(this,a,this.element):this.config.placement,c=this._getAttachment(l);this.addAttachmentClass(c);var h=this._getContainer();t(a).data(this.constructor.DATA_KEY,this),t.contains(this.element.ownerDocument.documentElement,this.tip)||t(a).appendTo(h),t(this.element).trigger(this.constructor.Event.INSERTED),this._popper=new e(this.element,a,this._getPopperConfig(c)),t(a).addClass("show"),"ontouchstart"in document.documentElement&&t(document.body).children().on("mouseover",null,t.noop);var f=function(){n.config.animation&&n._fixTransition();var e=n._hoverState;n._hoverState=null,t(n.element).trigger(n.constructor.Event.SHOWN),"out"===e&&n._leave(null,n)};if(t(this.tip).hasClass("fade")){var p=i.getTransitionDurationFromElement(this.tip);t(this.tip).one(i.TRANSITION_END,f).emulateTransitionEnd(p)}else f()}},c.hide=function(e){var n=this,o=this.getTipElement(),r=t.Event(this.constructor.Event.HIDE),s=function(){"show"!==n._hoverState&&o.parentNode&&o.parentNode.removeChild(o),n._cleanTipClass(),n.element.removeAttribute("aria-describedby"),t(n.element).trigger(n.constructor.Event.HIDDEN),null!==n._popper&&n._popper.destroy(),e&&e()};if(t(this.element).trigger(r),!r.isDefaultPrevented()){if(t(o).removeClass("show"),"ontouchstart"in document.documentElement&&t(document.body).children().off("mouseover",null,t.noop),this._activeTrigger.click=!1,this._activeTrigger.focus=!1,this._activeTrigger.hover=!1,t(this.tip).hasClass("fade")){var a=i.getTransitionDurationFromElement(o);t(o).one(i.TRANSITION_END,s).emulateTransitionEnd(a)}else s();this._hoverState=""}},c.update=function(){null!==this._popper&&this._popper.scheduleUpdate()},c.isWithContent=function(){return Boolean(this.getTitle())},c.addAttachmentClass=function(e){t(this.getTipElement()).addClass("bs-tooltip-"+e)},c.getTipElement=function(){return this.tip=this.tip||t(this.config.template)[0],this.tip},c.setContent=function(){var e=this.getTipElement();this.setElementContent(t(e.querySelectorAll(".tooltip-inner")),this.getTitle()),t(e).removeClass("fade show")},c.setElementContent=function(e,i){"object"!==a(i)||!i.nodeType&&!i.jquery?this.config.html?(this.config.sanitize&&(i=f(i,this.config.whiteList,this.config.sanitizeFn)),e.html(i)):e.text(i):this.config.html?t(i).parent().is(e)||e.empty().append(i):e.text(t(i).text())},c.getTitle=function(){var t=this.element.getAttribute("data-original-title");return t||(t="function"==typeof this.config.title?this.config.title.call(this.element):this.config.title),t},c._getPopperConfig=function(t){var e=this;return s(s({},{placement:t,modifiers:{offset:this._getOffset(),flip:{behavior:this.config.fallbackPlacement},arrow:{element:".arrow"},preventOverflow:{boundariesElement:this.config.boundary}},onCreate:function(t){t.originalPlacement!==t.placement&&e._handlePopperPlacementChange(t)},onUpdate:function(t){return e._handlePopperPlacementChange(t)}}),this.config.popperConfig)},c._getOffset=function(){var t=this,e={};return"function"==typeof this.config.offset?e.fn=function(e){return e.offsets=s(s({},e.offsets),t.config.offset(e.offsets,t.element)||{}),e}:e.offset=this.config.offset,e},c._getContainer=function(){return!1===this.config.container?document.body:i.isElement(this.config.container)?t(this.config.container):t(document).find(this.config.container)},c._getAttachment=function(t){return _[t.toUpperCase()]},c._setListeners=function(){var e=this;this.config.trigger.split(" ").forEach((function(i){if("click"===i)t(e.element).on(e.constructor.Event.CLICK,e.config.selector,(function(t){return e.toggle(t)}));else if("manual"!==i){var n="hover"===i?e.constructor.Event.MOUSEENTER:e.constructor.Event.FOCUSIN,o="hover"===i?e.constructor.Event.MOUSELEAVE:e.constructor.Event.FOCUSOUT;t(e.element).on(n,e.config.selector,(function(t){return e._enter(t)})).on(o,e.config.selector,(function(t){return e._leave(t)}))}})),this._hideModalHandler=function(){e.element&&e.hide()},t(this.element).closest(".modal").on("hide.bs.modal",this._hideModalHandler),this.config.selector?this.config=s(s({},this.config),{},{trigger:"manual",selector:""}):this._fixTitle()},c._fixTitle=function(){var t=a(this.element.getAttribute("data-original-title"));(this.element.getAttribute("title")||"string"!==t)&&(this.element.setAttribute("data-original-title",this.element.getAttribute("title")||""),this.element.setAttribute("title",""))},c._enter=function(e,i){var n=this.constructor.DATA_KEY;(i=i||t(e.currentTarget).data(n))||(i=new this.constructor(e.currentTarget,this._getDelegateConfig()),t(e.currentTarget).data(n,i)),e&&(i._activeTrigger["focusin"===e.type?"focus":"hover"]=!0),t(i.getTipElement()).hasClass("show")||"show"===i._hoverState?i._hoverState="show":(clearTimeout(i._timeout),i._hoverState="show",i.config.delay&&i.config.delay.show?i._timeout=setTimeout((function(){"show"===i._hoverState&&i.show()}),i.config.delay.show):i.show())},c._leave=function(e,i){var n=this.constructor.DATA_KEY;(i=i||t(e.currentTarget).data(n))||(i=new this.constructor(e.currentTarget,this._getDelegateConfig()),t(e.currentTarget).data(n,i)),e&&(i._activeTrigger["focusout"===e.type?"focus":"hover"]=!1),i._isWithActiveTrigger()||(clearTimeout(i._timeout),i._hoverState="out",i.config.delay&&i.config.delay.hide?i._timeout=setTimeout((function(){"out"===i._hoverState&&i.hide()}),i.config.delay.hide):i.hide())},c._isWithActiveTrigger=function(){for(var t in this._activeTrigger)if(this._activeTrigger[t])return!0;return!1},c._getConfig=function(e){var n=t(this.element).data();return Object.keys(n).forEach((function(t){-1!==g.indexOf(t)&&delete n[t]})),"number"==typeof(e=s(s(s({},this.constructor.Default),n),"object"===a(e)&&e?e:{})).delay&&(e.delay={show:e.delay,hide:e.delay}),"number"==typeof e.title&&(e.title=e.title.toString()),"number"==typeof e.content&&(e.content=e.content.toString()),i.typeCheckConfig(p,e,this.constructor.DefaultType),e.sanitize&&(e.template=f(e.template,e.whiteList,e.sanitizeFn)),e},c._getDelegateConfig=function(){var t={};if(this.config)for(var e in this.config)this.constructor.Default[e]!==this.config[e]&&(t[e]=this.config[e]);return t},c._cleanTipClass=function(){var e=t(this.getTipElement()),i=e.attr("class").match(v);null!==i&&i.length&&e.removeClass(i.join(""))},c._handlePopperPlacementChange=function(t){this.tip=t.instance.popper,this._cleanTipClass(),this.addAttachmentClass(this._getAttachment(t.placement))},c._fixTransition=function(){var e=this.getTipElement(),i=this.config.animation;null===e.getAttribute("x-placement")&&(t(e).removeClass("fade"),this.config.animation=!1,this.hide(),this.show(),this.config.animation=i)},o._jQueryInterface=function(e){return this.each((function(){var i=t(this).data("bs.tooltip"),n="object"===a(e)&&e;if((i||!/dispose|hide/.test(e))&&(i||(i=new o(this,n),t(this).data("bs.tooltip",i)),"string"==typeof e)){if(void 0===i[e])throw new TypeError('No method named "'+e+'"');i[e]()}}))},r=o,l=[{key:"VERSION",get:function(){return"4.5.0"}},{key:"Default",get:function(){return b}},{key:"NAME",get:function(){return p}},{key:"DATA_KEY",get:function(){return"bs.tooltip"}},{key:"Event",get:function(){return w}},{key:"EVENT_KEY",get:function(){return d}},{key:"DefaultType",get:function(){return m}}],(u=null)&&n(r.prototype,u),l&&n(r,l),o}();return t.fn[p]=x._jQueryInterface,t.fn[p].Constructor=x,t.fn[p].noConflict=function(){return t.fn[p]=y,x._jQueryInterface},x},"object"===a(e)&&void 0!==t?t.exports=s(i(0),i(3),i(4)):(o=[i(0),i(3),i(4)],void 0===(r="function"==typeof(n=s)?n.apply(e,o):n)||(t.exports=r))},function(t,e){function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"===("undefined"==typeof window?"undefined":i(window))&&(n=window)}t.exports=n},function(t,e,i){"use strict";i.r(e),i.d(e,"calc",(function(){return n})),i.d(e,"events",(function(){return iy})),i.d(e,"RepetitiveRequests",(function(){return B})),i.d(e,"Timeline",(function(){return V})),i.d(e,"timeline",(function(){return ny})),i.d(e,"Synview",(function(){return Ta})),i.d(e,"synview",(function(){return oy})),i.d(e,"Tooltip",(function(){return Gh})),i.d(e,"tooltip",(function(){return ry})),i.d(e,"Sounding",(function(){return vf})),i.d(e,"sounding",(function(){return sy})),i.d(e,"ThermodynamicDiagramPluggable",(function(){return Uf})),i.d(e,"ThermodynamicDiagram",(function(){return ty})),i.d(e,"thermodynamicDiagram",(function(){return ay}));var n={};function o(t){if(void 0!==t&&!isNaN(t))return 44330.769*(1-Math.pow(t/1013.25,.19029496))}function r(t){if(void 0!==t&&!isNaN(t))return 1013.25*Math.pow(1-t/44330.769,5.255)}function s(t,e){if(void 0!==t&&!isNaN(t)&&void 0!==e&&!isNaN(e))return t*Math.pow(1e3/e,.286)}function a(t,e){if(void 0!==t&&!isNaN(t)&&void 0!==e&&!isNaN(e))return t*Math.pow(e/1e3,.286)}function u(t,e){if(void 0!==e&&!isNaN(e)){for(var i=void 0,n=Math.pow(1e3/e,.286),o=273,r=20,s=0;Math.abs(r)>.1&&s<100;)s++,i=p(o,e),(o*n*Math.exp(2.5*i/o)-t)*r>0&&(r*=-.5),o+=r;return o}}function l(t,e){if(void 0!==t&&!isNaN(t)&&void 0!==e&&!isNaN(e)){var i=.4343*Math.log(t*e/(622+t));return Math.pow(10,.0498646455*i+2.4082965)-7.07475+38.9114*Math.pow(Math.pow(10,.0915*i)-1.2035,2)}}function c(t,e,i){if(!(void 0===t||isNaN(t)||void 0===e||isNaN(e)||void 0===i||isNaN(i))){for(var n=e-273.15,o=1,r=10,s=1,a=6.112*Math.exp(17.67*n/(n+243.5));Math.abs(o)>.05;){if(0==(o=a-(6.112*Math.exp(17.67*n/(n+243.5))-i*(t-273.15-n)*66e-5*(1+.00115*n))))break;if(o<0?-1!=s&&(s=-1,r/=10):1!=s&&(s=1,r/=10),Math.abs(o)<=.05)break;n+=r*s}return n+273.15}}function h(t,e,i){var n=s(t,i);if(!(void 0===n||void 0===e||isNaN(e)||void 0===t||isNaN(t)||void 0===i||isNaN(i)))return n*Math.exp(2.4819*p(e,i)/v(t,e))}function f(t){if(void 0!==t&&!isNaN(t)){var e=new Array(6.1104546,.4442351,.014302099,.00026454708,30357098e-13,2.0972268e-8,60487594e-18,-1469687e-19),i=new Array(.06485546857696639,.03783195122560735,.02224449342887902,.013182892842468312,.007874020771412448,.004739730494884733,.0028751203550435793,.001757430376758103,.0010824173951885098,.0006717089391856059,.0004199647026320394,.0002645243638634699,.00016784796373681322,.00010728539763162038,6907426344961356e-20,4479404897680843e-20,2925704195639373e-20,19245291263499416e-21,12749137241074795e-21,8505070102755051e-21,5713400253349711e-21,3864650296738762e-21,2632109719650053e-21,18049107293057043e-22,12460785055581605e-22,8.660705713468708e-7,6.059822176688955e-7,4.2682119794324277e-7,3.026165085143795e-7,2.15963854234914e-7,1.5512895457833687e-7),n=0;if((t-=273.15)>-50)n=e[0]+t*(e[1]+t*(e[2]+t*(e[3]+t*(e[4]+t*(e[5]+t*(e[6]+t*e[7]))))));else{var o=(-t-50)/5;n=0<i.length-1?i[0]+o%1*(i[1]-i[0]):1e-7}return n}}function p(t,e){var i=f(t);if(void 0!==i&&void 0!==e&&!isNaN(e))return 621.97*i/(e-i)}function d(t,e){if(void 0!==e&&!isNaN(e)){for(var i=1013,n=100;i-n>10;){var o=n+(i-n)/2,r=p(a(t,o),o);if(void 0===r)return;r<e?n=o:i=o}return n+(i-n)/2}}function y(t,e){if(void 0!==t&&!isNaN(t)){for(var i=323,n=223;i-n>.1;){var o=n+(i-n)/2,r=d(o,e);if(void 0===r)return;r>t?n=o:i=o}return n+(i-n)/2}}function v(t,e){if(void 0!==t&&!isNaN(t)&&void 0!==e&&!isNaN(e))return e-(.001296*e-.15772)*(t-e)}function g(t){return void 0===t||isNaN(t)?void 0:t+273.15}function m(t){return void 0===t||isNaN(t)?void 0:t-273.15}function _(t){return void 0===t||isNaN(t)?void 0:3.6*t}function b(t){return void 0===t||isNaN(t)?void 0:t/3.6}function w(t){return void 0===t||isNaN(t)?void 0:900*t/463}function x(t){return void 0===t||isNaN(t)?void 0:463*t/900}function S(t){return void 0===t||isNaN(t)?void 0:Math.min(12,Math.pow(t/.836,2/3))}function T(t){return void 0===t||isNaN(t)?void 0:.836*Math.pow(t,1.5)}function O(t,e){if(void 0!==t&&!isNaN(t)&&void 0!==e&&!isNaN(e))return 153*m(t)+.9985*e-304.26}function C(t,e,i,n){if(!(void 0===t||isNaN(t)||void 0===e||isNaN(e)||void 0===i||isNaN(i))){if(0==e)return t;var o=.02896;if(void 0===n&&(n=i),i==n)return t*Math.exp(9.807*-o/8.314/i*e);var r=(i-n)/e;return t*Math.exp(9.807*o/8.314/r*Math.log(1-r*e/i))}}function E(t,e,i){if(!(void 0===t||isNaN(t)||void 0===e||isNaN(e)||void 0===i||isNaN(i))){var n=f(e)*i;return 100*(t-n)/287.058/e+100*n/461.495/e}}function P(t){return(P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function R(t,e,i){"listeners"in this&&void 0!==this.listeners||(this.listeners={}),t in this.listeners||(this.listeners[t]={});var n=Math.random().toString(36).substr(2,9);return this.listeners[t][n]={callback:e,thisArg:i},n}function I(t,e){"listeners"in this&&void 0!==this.listeners&&t in this.listeners&&e in this.listeners[t]&&delete this.listeners[t][e]}function k(t,e,i){"once_listeners"in this&&void 0!==this.once_listeners||(this.once_listeners={}),t in this.once_listeners&&"push"in this.once_listeners[t]||(this.once_listeners[t]=[]),this.once_listeners[t].push({callback:e,thisArg:i})}function j(t){return"listeners"in this&&void 0!==this.listeners&&t in this.listeners&&Object.keys(this.listeners[t]).length||"once_listeners"in this&&t in this.once_listeners&&Object.keys(this.once_listeners[t]).length}function M(t){var e=this,i=Array.prototype.slice.call(arguments);if(i.shift(),"listeners"in this&&void 0!==this.listeners&&t in this.listeners&&"object"==P(this.listeners[t])&&Object.keys(this.listeners[t]).forEach((function(n){e.listeners[t][n].callback.apply(void 0===e.listeners[t][n].thisArg?e:e.listeners[t][n].thisArg,i)})),"once_listeners"in this&&void 0!==this.once_listeners&&t in this.once_listeners&&"forEach"in this.once_listeners[t]){var n=this.once_listeners[t];this.once_listeners[t]=[],n.forEach((function(t){t.callback.apply(void 0===t.thisArg?e:t.thisArg,i)}))}}i.r(n),i.d(n,"altitudeISAByPres",(function(){return o})),i.d(n,"pressureISAByAltitude",(function(){return r})),i.d(n,"potentialTempByTempAndPres",(function(){return s})),i.d(n,"tempByPotentialTempAndPres",(function(){return a})),i.d(n,"tempByEquiPotTempAndPres",(function(){return u})),i.d(n,"dewpointByHMRAndPres",(function(){return l})),i.d(n,"wetbulbTempByTempAndDewpointAndPres",(function(){return c})),i.d(n,"equiPotentialTempByTempAndDewpointAndPres",(function(){return h})),i.d(n,"saturationPressureByTemp",(function(){return f})),i.d(n,"saturationHMRByTempAndPres",(function(){return p})),i.d(n,"lclByPotentialTempAndHMR",(function(){return d})),i.d(n,"potentialTempByLCLAndHMR",(function(){return y})),i.d(n,"lclTemperatureByTempAndDewpoint",(function(){return v})),i.d(n,"tempCelsiusToKelvin",(function(){return g})),i.d(n,"tempKelvinToCelsius",(function(){return m})),i.d(n,"windspeedMSToKMH",(function(){return _})),i.d(n,"windspeedKMHToMS",(function(){return b})),i.d(n,"windspeedMSToKN",(function(){return w})),i.d(n,"windspeedKNToMS",(function(){return x})),i.d(n,"windspeedMSToBF",(function(){return S})),i.d(n,"windspeedBFToMS",(function(){return T})),i.d(n,"snowlineByTemp850hPaAndAltidude",(function(){return O})),i.d(n,"pressureByBarometricFormula",(function(){return C})),i.d(n,"densityHumidAirByPressureAndTempAndRelHumidity",(function(){return E}));var F=function(t){t.on=R,t.un=I,t.once=k,t.hasListener=j,t.trigger=M};function D(t,e,i,n,o,r,s){try{var a=t[r](s),u=a.value}catch(t){return void i(t)}a.done?e(u):Promise.resolve(u).then(n,o)}function A(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function N(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var G=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.url,n=void 0===i?void 0:i,o=e.user,r=void 0===o?"":o,s=e.password,a=void 0===s?"":s,u=e.start,l=void 0===u||u,c=e.defaultTimeout,h=void 0===c?void 0:c,f=e.timeoutOnError,p=void 0===f?void 0:f,d=e.pauseOnHiddenDocument,y=void 0!==d&&d,v=e.responseType,g=void 0===v?"":v;A(this,t),this._url=n,this._user=r,this._password=a,this._isStarted=l,this._defaultTimeout=h,this._timeoutOnError=p,this._pauseOnHiddenDocument=y,this._initPauseOnHiddenDocument(),this._responseType=g,this._timeoutID=void 0,this._loading=!1,this._isStarted&&this.start()}var e,i,n,o,r;return e=t,(i=[{key:"start",value:function(){this.isStarted=!0,this._startRequest()}},{key:"stop",value:function(){this.isStarted=!1,void 0!==this.timeoutID&&clearTimeout(this.timeoutID)}},{key:"_planRequest",value:function(t){var e=this,i=t.delay;void 0===this._timeoutID&&(this._timeoutID=setTimeout((function(){e._startRequest()}),i))}},{key:"_startRequest",value:function(){var t=this;void 0!==this._timeoutID&&clearTimeout(this._timeoutID),this._makeRequest().then((function(e){var i=e.request;if(t.isStarted){var n=t._defaultTimeout,o=i.getResponseHeader("Cache-Control");if(null!==o){var r=/(^|,)max-age=([0-9]+)($|,)/.exec(o);null!==r&&r[2]>0&&(n=Math.round(1e3*r[2]))}t.trigger("success:request",{request:i}),void 0!==n&&t._planRequest({delay:n})}}),(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.request;t.isStarted&&void 0!==i&&(t.trigger("error:request",{request:i}),void 0!==t._timeoutOnError&&t._planRequest({delay:t._timeoutOnError}))}))}},{key:"_makeRequest",value:(o=regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,i){if(void 0!==e._url)if(e._loading)i();else{e._loading=!0;var n=new XMLHttpRequest;void 0!==e.responseType&&(n.responseType=e.responseType),n.addEventListener("load",(function(){e._loading=!1,200==n.status?t({request:n}):i({request:n})})),n.addEventListener("error",(function(){e._loading=!1,i({request:n})})),n.open("GET",e._url,!0,e._user,e._password),n.send()}else i()})));case 1:case"end":return t.stop()}}),t)})),r=function(){var t=this,e=arguments;return new Promise((function(i,n){var r=o.apply(t,e);function s(t){D(r,i,n,s,a,"next",t)}function a(t){D(r,i,n,s,a,"throw",t)}s(void 0)}))},function(){return r.apply(this,arguments)})},{key:"_initPauseOnHiddenDocument",value:function(){var t=this;this._pauseOnHiddenDocument&&document.addEventListener("visibilitychange",(function(){"hidden"in document&&(document.hidden?t.stop():t.start())}))}},{key:"url",get:function(){return this._url},set:function(t){this._url=t}},{key:"user",get:function(){return this._user},set:function(t){this._user=t}},{key:"password",get:function(){return this._password},set:function(t){this._password=t}},{key:"responseType",get:function(){return this._password},set:function(t){this._responseType=t}}])&&N(e.prototype,i),n&&N(e,n),t}();F(G.prototype);var B=G;function Y(t){return(Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function X(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function z(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var W=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.maxTimeGap,n=void 0===i?void 0:i,o=e.keyboardNavigation,r=void 0===o?{}:o;X(this,t),this.maxTimeGap=n,this.selectedTime=new Date("invalid"),this.times=[],this.enabledTimes=[],this.allEnabledTimes=[],this.timesByKey={},this._keyboardNavigation={},this._initKeyboardNavigation(r)}var e,i,n;return e=t,(i=[{key:"getSelectedTime",value:function(){return this.selectedTime}},{key:"setSelectedTime",value:function(t){return this._setSelectedTime(K(t,this.times)>-1?t:new Date("invalid")),this}},{key:"getTimes",value:function(){return this.times}},{key:"getEnabledTimes",value:function(){return this.enabledTimes}},{key:"getAllEnabledTimes",value:function(){return this.allEnabledTimes}},{key:"setTimesBySetID",value:function(t,e){return this.timesByKey[t]={times:e,enabled:e},this._updateTimes(),this._updateEnabledTimes(),this}},{key:"setEnabledTimesBySetID",value:function(t,e){return t in this.timesByKey&&(this.timesByKey[t].enabled=e,this._updateEnabledTimes()),this}},{key:"getSetIDs",value:function(){return Object.keys(this.timesByKey)}},{key:"deleteSetID",value:function(t){return t in this.timesByKey&&(delete this.timesByKey[t],this._updateTimes(),this._updateEnabledTimes()),this}},{key:"first",value:function(){return this._setSelectedTime(this.getFirstEnabledTime()),this}},{key:"last",value:function(){return this._setSelectedTime(this.getLastEnabledTime()),this}},{key:"next",value:function(){return this._setSelectedTime(this.getNextEnabledTime()),this}},{key:"prev",value:function(){return this._setSelectedTime(this.getPrevEnabledTime()),this}},{key:"nextAllEnabledTime",value:function(){return this._setSelectedTime(this.getNextAllEnabledTime()),this}},{key:"prevAllEnabledTime",value:function(){return this._setSelectedTime(this.getPrevAllEnabledTime()),this}},{key:"add",value:function(t,e){var i=this.getSelectedTime(),n=0;switch(e){case"hours":case"h":n=3600*t*1e3;break;case"minutes":case"m":n=60*t*1e3;break;case"seconds":case"s":n=1e3*t;break;case"milliseconds":case"ms":n=t}switch(0!=n&&(i=new Date(i.valueOf()+n)),e){case"years":case"y":i.setUTCFullYear(i.getUTCFullYear()+t);break;case"months":case"M":i.setUTCMonth(i.getUTCMonth()+t);break;case"days":case"d":i.setUTCDate(i.getUTCDate()+t)}return K(i,this.times)>-1&&this._setSelectedTime(i),this}},{key:"sub",value:function(t,e){var i=this.getSelectedTime(),n=0;switch(e){case"hours":case"h":n=3600*t*1e3;break;case"minutes":case"m":n=60*t*1e3;break;case"seconds":case"s":n=1e3*t;break;case"milliseconds":case"ms":n=t}switch(0!=n&&(i=new Date(i.valueOf()-n)),e){case"years":case"y":i.setUTCFullYear(i.getUTCFullYear()-t);break;case"months":case"M":i.setUTCMonth(i.getUTCMonth()-t);break;case"days":case"d":i.setUTCDate(i.getUTCDate()-t)}return K(i,this.times)>-1&&this._setSelectedTime(i),this}},{key:"getFirstEnabledTime",value:function(){return this.enabledTimes.length>0?this.enabledTimes[0]:new Date("invalid")}},{key:"getLastEnabledTime",value:function(){return this.enabledTimes.length>0?this.enabledTimes[this.enabledTimes.length-1]:new Date("invalid")}},{key:"getNextEnabledTime",value:function(){if(this.enabledTimes.length<1)return new Date("invalid");var t=K(this.getSelectedTime(),this.enabledTimes);if(t>-1)return++t<this.enabledTimes.length?this.enabledTimes[t]:this.enabledTimes[this.enabledTimes.length-1];if(isNaN(this.getSelectedTime()))return this.enabledTimes[0];for(var e=new Date("invalid"),i=0;i<this.enabledTimes.length;i++)if(this.getSelectedTime().valueOf()<this.enabledTimes[i].valueOf()){e=this.enabledTimes[i];break}return e}},{key:"getPrevEnabledTime",value:function(){if(this.enabledTimes.length<1)return new Date("invalid");var t=K(this.getSelectedTime(),this.enabledTimes);if(t>-1)return-1<--t?this.enabledTimes[t]:this.enabledTimes[0];if(isNaN(this.getSelectedTime()))return this.enabledTimes[0];for(var e=new Date("invalid"),i=this.enabledTimes.length-1;i>=0;i--)if(this.getSelectedTime().valueOf()>this.enabledTimes[i].valueOf()){e=this.enabledTimes[i];break}return e}},{key:"getFirstAllEnabledTime",value:function(){return this.allEnabledTimes.length>0?this.allEnabledTimes[0]:new Date("invalid")}},{key:"getLastAllEnabledTime",value:function(){return this.allEnabledTimes.length>0?this.allEnabledTimes[this.allEnabledTimes.length-1]:new Date("invalid")}},{key:"getNextAllEnabledTime",value:function(){if(this.allEnabledTimes.length<1)return new Date("invalid");var t=K(this.getSelectedTime(),this.allEnabledTimes);if(t>-1)return++t<this.allEnabledTimes.length?this.allEnabledTimes[t]:this.allEnabledTimes[this.allEnabledTimes.length-1];if(isNaN(this.getSelectedTime()))return this.allEnabledTimes[0];for(var e=new Date("invalid"),i=0;i<this.allEnabledTimes.length;i++)if(this.getSelectedTime().valueOf()<this.allEnabledTimes[i].valueOf()){e=this.allEnabledTimes[i];break}return e}},{key:"getPrevAllEnabledTime",value:function(){if(this.allEnabledTimes.length<1)return new Date("invalid");var t=K(this.getSelectedTime(),this.allEnabledTimes);if(t>-1)return-1<--t?this.allEnabledTimes[t]:this.allEnabledTimes[0];if(isNaN(this.getSelectedTime()))return this.allEnabledTimes[0];for(var e=new Date("invalid"),i=this.allEnabledTimes.length-1;i>=0;i--)if(this.getSelectedTime().valueOf()>this.allEnabledTimes[i].valueOf()){e=this.allEnabledTimes[i];break}return e}},{key:"isTimeEnabled",value:function(t){return this.enabledTimes.reduce((function(e,i){return i.valueOf()==t.valueOf()||e}),!1)}},{key:"isTimeAllEnabled",value:function(t){return this.allEnabledTimes.reduce((function(e,i){return i.valueOf()==t.valueOf()||e}),!1)}},{key:"isFirstEnabledTime",value:function(){return this.getFirstEnabledTime().valueOf()==this.getSelectedTime().valueOf()}},{key:"isLastEnabledTime",value:function(){return this.getLastEnabledTime().valueOf()==this.getSelectedTime().valueOf()}},{key:"_setSelectedTime",value:function(t){var e=this.selectedTime;return this.selectedTime=t,this.trigger("change:time",e),this.selectedTime}},{key:"_updateTimes",value:function(){this.times=[];var t=[],e={};for(var i in this.timesByKey)this.timesByKey[i].times.forEach((function(i){i.valueOf()in e||(t.push(i),e[i.valueOf()]=i)}));q(t),t.forEach((function(t){if(this.times.length<1)this.times.push(t);else{var e=this.times[this.times.length-1];if(void 0!==this.maxTimeGap&&t.valueOf()-e.valueOf()>1e3*this.maxTimeGap){var i=e;do{i=new Date(i.getTime()+1e3*this.maxTimeGap),this.times.push(i)}while(t.valueOf()-i.valueOf()>1e3*this.maxTimeGap)}this.times.push(t)}}),this),q(this.times),this.trigger("change:times")}},{key:"_updateEnabledTimes",value:function(){this.enabledTimes=[],this.allEnabledTimes=[];var t={},e={};for(var i in this.timesByKey)this.timesByKey[i].enabled.forEach((function(i){i.valueOf()in t||(this.enabledTimes.push(i),t[i.valueOf()]=i),i.valueOf()in e?e[i.valueOf()]++:e[i.valueOf()]=1}),this);for(var n in q(this.enabledTimes),e)e[n]==Object.keys(this.timesByKey).length&&this.allEnabledTimes.push(t[n]);q(this.allEnabledTimes),this.trigger("change:enabledTimes")}},{key:"_initKeyboardNavigation",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.enabled,n=void 0!==i&&i,o=e.first,r=void 0===o?36:o,s=e.last,a=void 0===s?35:s,u=e.prev,l=void 0===u?37:u,c=e.next,h=void 0===c?39:c,f=e.prevAllEnabledTime,p=void 0===f?[37,"ctrl"]:f,d=e.nextAllEnabledTime,y=void 0===d?[38,"ctrl"]:d;this._keyboardNavigation={enabled:n,first:r,last:a,prev:l,next:h,prevAllEnabledTime:p,nextAllEnabledTime:y},document&&this._keyboardNavigation.enabled&&document.addEventListener("keydown",(function(e){Object.keys(t._keyboardNavigation).forEach((function(i){"enabled"!=i&&i in t&&H(e,t._keyboardNavigation[i])&&t[i]()}))}))}}])&&z(e.prototype,i),n&&z(e,n),t}();F(W.prototype);var V=W,K=function(t,e){return e.findIndex((function(e){return e.valueOf()==t.valueOf()}))};function q(t){t.sort((function(t,e){return t.valueOf()-e.valueOf()}))}function H(t,e){if("object"==Y(e)&&"forEach"in e||(e=[e]),0==e.length)return!1;var i=[["ctrl","ctrlKey"],["alt","altKey"],["shift","shiftKey"],["meta","metaKey"]].reduce((function(i,n){return i&&(e.indexOf(n[0])>-1?t[n[1]]:!t[n[1]])}),!0);return e.forEach((function(e){switch(e){case"ctrl":case"alt":case"shift":case"meta":break;default:e!=t.keyCode&&(i=!1)}})),i}var Z=i(0),U=i.n(Z);function J(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Q(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var $=function(){function t(){var e=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=i.timeline,o=i.restartPause,r=void 0===o?1.8:o,s=i.imagePeriod,a=void 0===s?.2:s,u=i.imageFrequency,l=i.enabledStepsOnly,c=void 0===l||l,h=i.allEnabledStepsOnly,f=void 0!==h&&h;J(this,t),this.options={timeline:n,restartPause:r,imagePeriod:a,imageFrequency:u,enabledStepsOnly:c,allEnabledStepsOnly:f},void 0===this.options.timeline&&(this.options.timeline=new V),void 0!==this.options.imageFrequency&&0!=this.options.imageFrequency&&(this.options.imagePeriod=1/this.options.imageFrequency),this.animationIntervalID=void 0,this.animationTimeoutID=void 0,this.animationStep=0,this.timesHash={},this.times=[];var p=function(){e.times=e.options.timeline[e._getTimelineTimesMethod()](),e.timesHash={},e.times.forEach((function(t,i){return e.timesHash[t.valueOf()]=i}))};this.options.timeline.on(this._getTimelineChangeTimesEvent(),p),p()}var e,i,n;return e=t,(i=[{key:"getImagePeriod",value:function(){return this.options.imagePeriod}},{key:"setImagePeriod",value:function(t){return this.options.imagePeriod=t,this.isStarted()&&this._updateAnimation(),this.trigger("change:imageFrequency"),this}},{key:"getImageFrequency",value:function(){return 1/this.options.imagePeriod}},{key:"setImageFrequency",value:function(t){return 0!=t&&this.setImagePeriod(1/t),this}},{key:"getRestartPause",value:function(){return this.options.restartPause}},{key:"setRestartPause",value:function(t){return this.options.restartPause=Number(t),this.trigger("change:restartPause"),this}},{key:"isStarted",value:function(){return void 0!==this.animationIntervalID||void 0!==this.animationTimeoutID}},{key:"start",value:function(){this.options.timeline.getSelectedTime().valueOf()in this.timesHash&&this._setStep(this.timesHash[this.options.timeline.getSelectedTime().valueOf()]),this.isStarted()||this._updateAnimation(),this.trigger("start:animation")}},{key:"stop",value:function(){this._clearAnimation(),this.trigger("stop:animation")}},{key:"toggle",value:function(){this.isStarted()?this.stop():this.start()}},{key:"_setStep",value:function(t){0<=t&&t<this._getCount()&&(this.animationStep=t)}},{key:"_getTimelineChangeTimesEvent",value:function(){return this.options.enabledStepsOnly||this.options.allEnabledStepsOnly?"change:enabledTimes":"change:times"}},{key:"_getTimelineTimesMethod",value:function(){return this.options.allEnabledStepsOnly?"getAllEnabledTimes":this.options.enabledStepsOnly?"getEnabledTimes":"getTimes"}},{key:"_getCount",value:function(){return this.options.timeline[this._getTimelineTimesMethod()]().length}},{key:"_updateAnimation",value:function(){this._clearAnimation(),this.animationStep<this._getCount()-1?this._initAnimation():this._initRestartPause()}},{key:"_initAnimation",value:function(){var t=this;void 0===this.animationIntervalID&&(this.animationIntervalID=window.setInterval((function(){t.animationStep++,t.animationStep<t.times.length&&t.options.timeline.setSelectedTime(t.times[t.animationStep]),t.animationStep>=t._getCount()-1&&(t.trigger("end:animation"),t._clearAnimation(),t._initRestartPause())}),1e3*this.options.imagePeriod))}},{key:"_initRestartPause",value:function(){var t=this;void 0===this.animationTimeoutID&&(this.animationTimeoutID=window.setTimeout((function(){t.animationStep=0,t.trigger("restart:animation"),t.animationStep<t.times.length&&t.options.timeline.setSelectedTime(t.times[t.animationStep]),t._clearAnimation(),t._initAnimation()}),1e3*(this.options.imagePeriod+this.options.restartPause)))}},{key:"_clearAnimation",value:function(){void 0!==this.animationIntervalID&&(window.clearInterval(this.animationIntervalID),this.animationIntervalID=void 0),void 0!==this.animationTimeoutID&&(window.clearTimeout(this.animationTimeoutID),this.animationTimeoutID=void 0)}}])&&Q(e.prototype,i),n&&Q(e,n),t}();F($.prototype);var tt=$;function et(t,e){var i=e.animation,n=e.suffix,o=void 0===n?"fps":n,r=U()("<input>").addClass("form-control").attr("type","number").attr("min",1).attr("step",1),s=U()("<div>").addClass("input-group").append(r).append(U()("<div>").addClass("input-group-append").append(U()("<span>").addClass("input-group-text").text(o)));r.on("change",(function(){return i.setImageFrequency(r.val())}));var a=function(){return r.val(i.getImageFrequency())};return i.on("change:imageFrequency",a),a(),t.append(s),s}function it(t,e){var i=e.animation,n=e.frequencies;n=n||[1];var o=U()("<input>").addClass("custom-range").attr("type","range").attr("min",0).attr("max",n.length-1);o.on("change input",(function(){var t=o.val();t<n.length&&i.setImageFrequency(n[t])}));var r=function(){var t=n.indexOf(i.getImageFrequency());t>-1&&o.val(t)};return i.on("change:imageFrequency",r),r(),t.append(o),o}function nt(t,e){var i=e.animation,n=e.suffix,o=void 0===n?"s":n,r=U()("<input>").addClass("form-control").attr("type","number").attr("min",0).attr("step",.1),s=U()("<div>").addClass("input-group").append(r).append(U()("<div>").addClass("input-group-append").append(U()("<span>").addClass("input-group-text").text(o)));r.on("change",(function(){return i.setRestartPause(r.val())}));var a=function(){return r.val(i.getRestartPause())};return i.on("change:restartPause",a),a(),t.append(s),s}function ot(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var rt=function t(){var e=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ot(this,t);var n=i.animation,o=void 0===n?void 0:n,r=i.node,s=void 0===r?void 0:r,a=i.startedContent,u=void 0===a?void 0:a,l=i.startedClass,c=void 0===l?void 0:l,h=i.stoppedContent,f=void 0===h?void 0:h,p=i.stoppedClass,d=void 0===p?void 0:p,y=i.classButton,v=void 0===y?void 0:y,g=i.classDropdownToggle,m=void 0===g?void 0:g,_=i.menu,b=void 0===_||_,w=i.menuImageFrequency,x=void 0===w||w,S=i.imageFrequencyCaption,T=void 0===S?"Frequency":S,O=i.menuFrequencies,C=void 0===O?void 0:O,E=i.menuRestartPause,P=void 0===E||E,R=i.restartPauseCaption,I=void 0===R?"Restart pause":R;"startedContent"in i||(u=""),"stoppedContent"in i||(f=""),this.options={animation:o,node:s,startedContent:u,startedClass:c,stoppedContent:f,stoppedClass:d,classButton:v,classDropdownToggle:m,menu:b,menuImageFrequency:x,imageFrequencyCaption:T,menuFrequencies:C,menuRestartPause:P,restartPauseCaption:I},this.options.node=U()(this.options.node);var k=this.options.node;this.options.node.is("button")||(k=U()("<button>").addClass("btn"),this.options.node.append(k)),k.addClass(this.options.classButton);var j=function(){k.removeClass(e.options.stoppedClass),k.addClass(e.options.startedClass),k.empty(),"string"==typeof e.options.startedContent||e.options.startedContent instanceof String?k.text(e.options.startedContent):k.append(e.options.startedContent)},L=function(){k.removeClass(e.options.startedClass),k.addClass(e.options.stoppedClass),k.empty(),"string"==typeof e.options.stoppedContent||e.options.stoppedContent instanceof String?k.text(e.options.stoppedContent):k.append(e.options.stoppedContent)};if(this.options.animation.on("start:animation",j),this.options.animation.on("stop:animation",L),k.click((function(){return e.options.animation.toggle()})),this.options.animation.isStarted()?j():L(),!this.options.node.is("button")&&this.options.menu){this.options.node.addClass("btn-group");var M=U()("<button>").attr("type","button").addClass("btn dropdown-toggle dropdown-toggle-split").addClass(this.options.classDropdownToggle).attr("data-toggle","dropdown").attr("aria-haspopup",!0).attr("aria-expanded",!1);M.append(U()("<span>").addClass("sr-only").text("Toggle Dropdown")),this.options.node.append(M);var F=U()("<div>").addClass("dropdown-menu pl-4 pr-4 pt-2 pb-2 text-muted");if(this.options.node.append(F),this.options.menuImageFrequency){var D=U()("<label>").text(this.options.imageFrequencyCaption),A=U()("<div>").addClass("form-group").append(D);F.append(A),et(D,{animation:this.options.animation}),void 0!==this.options.menuFrequencies&&it(A,{animation:this.options.animation,frequencies:this.options.menuFrequencies})}if(this.options.menuRestartPause){var N=U()("<label>").text(this.options.restartPauseCaption),G=U()("<div>").addClass("form-group").append(N);nt(N,{animation:this.options.animation}),F.append(G)}}};function st(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function at(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var ut=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.timeline,n=void 0===i?void 0:i,o=e.node,r=void 0===o?void 0:o,s=e.animation,a=void 0===s?void 0:s,u=e.enabledStepsOnly,l=void 0===u||u,c=e.allEnabledStepsOnly,h=void 0!==c&&c,f=e.textInvalid,p=void 0===f?"-":f,d=e.getTimeText,y=void 0===d?void 0:d,v=e.outputTimezone,g=void 0===v?void 0:v;st(this,t),this.options={timeline:n,node:r,animation:a,enabledStepsOnly:l,allEnabledStepsOnly:h,textInvalid:p,getTimeText:y,outputTimezone:g},void 0===this.options.timeline&&(this.options.timeline=new V),this.listeners=[],this.inputListener=void 0}var e,i,n;return e=t,(i=[{key:"setNode",value:function(t){if(void 0!==this.options.node&&this.emptyNode(),void 0===t)this.detachEventListeners(),this.options.node=t;else{this.options.node=t;var e=this.listeners.length>0;e||(this.attachEventListener(this.options.timeline,"change:time",(function(){this.onChangeTime()}),this),this.attachEventListener(this.options.timeline,"change:times",(function(){this.onChangeTimes()}),this),this.attachEventListener(this.options.timeline,"change:enabledTimes",(function(){this.onChangeTimes()}),this)),this.onInitNode(e),this.onChangeTimes(),this.onChangeTime()}return void 0===this.inputListener&&(this.inputListener=this.on("input",(function(){void 0!==this.options.animation&&this.options.animation.stop()}),this)),this}},{key:"getOutputTimezone",value:function(){return this.options.outputTimezone}},{key:"setOutputTimezone",value:function(t){var e=this.options.outputTimezone!=t;return this.options.outputTimezone=t,e&&void 0!==this.options.node&&(this.onChangeTimes(),this.onChangeTime()),this}},{key:"onChangeTime",value:function(){}},{key:"onChangeTimes",value:function(){}},{key:"emptyNode",value:function(){}},{key:"onInitNode",value:function(){}},{key:"getTimelineTimes",value:function(){var t=this.options.allEnabledStepsOnly?"getAllEnabledTimes":this.options.enabledStepsOnly?"getEnabledTimes":"getTimes";return this.options.timeline[t]()}},{key:"timeToText",value:function(t,e){return isNaN(t)?this.options.textInvalid:void 0!==this.options.getTimeText?this.options.getTimeText.call(this,t,e):t.toISOString()}},{key:"attachEventListener",value:function(t,e,i,n){this.listeners.push([t,e]),t.on(e,i,n)}},{key:"detachEventListeners",value:function(){this.listeners.forEach((function(t){"un"in t[0]?t[0].un(t[1]):"off"in t[0]&&t[0].off(t[1])})),this.listeners=[]}}])&&at(e.prototype,i),n&&at(e,n),t}();F(ut.prototype);var lt=ut;function ct(t){return(ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ht(t,e){if(null==t)return{};var i,n,o=function(t,e){if(null==t)return{};var i,n,o={},r=Object.keys(t);for(n=0;n<r.length;n++)i=r[n],e.indexOf(i)>=0||(o[i]=t[i]);return o}(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(n=0;n<r.length;n++)i=r[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(o[i]=t[i])}return o}function ft(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function pt(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function dt(t,e){return(dt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function yt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=gt(t);if(e){var o=gt(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return vt(this,i)}}function vt(t,e){return!e||"object"!==ct(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function gt(t){return(gt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var mt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&dt(t,e)}(r,t);var e,i,n,o=yt(r);function r(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.format,n=void 0===i?void 0:i,s=ht(e,["format"]);return ft(this,r),(t=o.call(this,s)).options.format=n,t.setNode(t.options.node),t}return e=r,(i=[{key:"onChangeTime",value:function(){this.options.node.text(this.timeToText(this.options.timeline.getSelectedTime(),this.options.format))}},{key:"emptyNode",value:function(){this.options.node.text("")}}])&&pt(e.prototype,i),n&&pt(e,n),r}(lt);function _t(t){return(_t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bt(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function wt(t,e){return(wt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function xt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Tt(t);if(e){var o=Tt(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return St(this,i)}}function St(t,e){return!e||"object"!==_t(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Tt(t){return(Tt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ot=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&wt(t,e)}(r,t);var e,i,n,o=xt(r);function r(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),(e=o.call(this,t)).times=[],e.timesIndexes={},e.setNode(e.options.node),e}return e=r,(i=[{key:"onChangeTime",value:function(){var t=this.options.timeline.getSelectedTime();t.valueOf()in this.timesIndexes?this.options.node.val(this.timesIndexes[t.valueOf()]+1):this.options.node.val(1)}},{key:"onChangeTimes",value:function(){this.times=this.getTimelineTimes(),this.timesIndexes={},this.times.forEach((function(t,e){this.timesIndexes[t.valueOf()]=e}),this),this.options.node.prop("max",this.times.length)}},{key:"onInitNode",value:function(t){if(this.options.node.prop("min",1),this.options.node.prop("step",1),!t){var e=this;this.attachEventListener(this.options.node,"change input",(function(){var t=+U()(this).val();0<t&&t<=e.times.length&&e.options.timeline.setSelectedTime(e.times[t-1]),e.trigger("input")}))}}}])&&bt(e.prototype,i),n&&bt(e,n),r}(lt);function Ct(t){return(Ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Et(t,e){if(null==t)return{};var i,n,o=function(t,e){if(null==t)return{};var i,n,o={},r=Object.keys(t);for(n=0;n<r.length;n++)i=r[n],e.indexOf(i)>=0||(o[i]=t[i]);return o}(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(n=0;n<r.length;n++)i=r[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(o[i]=t[i])}return o}function Pt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Rt(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function It(t,e){return(It=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function kt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Lt(t);if(e){var o=Lt(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return jt(this,i)}}function jt(t,e){return!e||"object"!==Ct(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Lt(t){return(Lt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Mt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&It(t,e)}(r,t);var e,i,n,o=kt(r);function r(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.format,n=void 0===i?"HH":i,s=e.grouping,a=void 0===s?"daily":s,u=e.groupingFormat,l=void 0===u?"ddd, DD. MMM":u,c=e.classMain,h=void 0===c?"btn-toolbar":c,f=e.classButtonGroup,p=void 0===f?"btn-group":f,d=e.classButtonGroupMargin,y=void 0===d?"mr-2":d,v=e.classLabel,g=void 0===v?void 0:v,m=e.classLabelSpan,_=void 0===m?"d-block w-100":m,b=e.classButton,w=void 0===b?"btn":b,x=e.classButtonActive,S=void 0===x?"active":x,T=e.classButtonNotEnabled,O=void 0===T?"btn-light":T,C=e.classButtonEnabled,E=void 0===C?"btn-secondary":C,P=e.classButtonAllEnabled,R=void 0===P?"btn-primary":P,I=Et(e,["format","grouping","groupingFormat","classMain","classButtonGroup","classButtonGroupMargin","classLabel","classLabelSpan","classButton","classButtonActive","classButtonNotEnabled","classButtonEnabled","classButtonAllEnabled"]);return Pt(this,r),(t=o.call(this,I)).options.format=n,t.options.grouping=a,t.options.groupingFormat=l,t.options.classMain=h,t.options.classButtonGroup=p,t.options.classButtonGroupMargin=y,t.options.classLabel=g,t.options.classLabelSpan=_,t.options.classButton=w,t.options.classButtonActive=S,t.options.classButtonNotEnabled=O,t.options.classButtonEnabled=E,t.options.classButtonAllEnabled=R,t.toolbarNode=void 0,t.setNode(t.options.node),t}return e=r,(i=[{key:"onChangeTime",value:function(){if(void 0!==this.toolbarNode){var t=this.options.timeline.getSelectedTime(),e=this;this.toolbarNode.find("button").each((function(){var i=new Date(+U()(this).data("time"));U()(this).removeClass(e.options.classButtonActive),t.valueOf()==i.valueOf()&&U()(this).addClass(e.options.classButtonActive)}))}}},{key:"onChangeTimes",value:function(){void 0===this.toolbarNode&&(this.toolbarNode=U()("<div>")),this.toolbarNode.empty();var t="daily"==this.options.grouping?"YYYY-MM-DD":"hourly"==this.options.grouping?"YYYY-MM-DD HH":this.options.grouping,e=void 0;this.getTimelineTimes().forEach((function(i){if(void 0===e||e.data("date")!=this.timeToText(i,t)){var n=U()("<div>").addClass(this.options.classButtonGroup).addClass(this.options.classButtonGroupMargin).attr("role","group").attr("aria-label",this.timeToText(i,t));if(void 0===this.options.groupingFormat)e=n;else{var o=U()("<span>").addClass(this.options.classLabelSpan).text(this.timeToText(i,this.options.groupingFormat));e=U()("<label>").addClass(this.options.classLabel).append(o),n.attr("aria-label",o.text()),e.append(n)}e.data("date",this.timeToText(i,t)),this.toolbarNode.append(e)}var r=U()("<button>").addClass(this.options.classButton).attr("type","button").text(this.timeToText(i,this.options.format)).data("time",i.valueOf());this.options.timeline.isTimeAllEnabled(i)?r.addClass(this.options.classButtonAllEnabled):this.options.timeline.isTimeEnabled(i)?r.addClass(this.options.classButtonEnabled):r.addClass(this.options.classButtonNotEnabled);var s=this;r.click((function(){s.options.timeline.setSelectedTime(new Date(+U()(this).data("time"))),s.trigger("input")})),e.hasClass(this.options.classButtonGroup)?e.append(r):e.children("div").append(r)}),this),this.toolbarNode.find("div."+this.options.classButtonGroup).last().removeClass(this.options.classButtonGroupMargin)}},{key:"emptyNode",value:function(){this.toolbarNode=void 0,this.options.node.empty()}},{key:"onInitNode",value:function(){this.toolbarNode=U()("<div>").addClass(this.options.classMain).attr("role","toolbar").attr("aria-label","Timeline toolbar"),this.options.node.append(this.toolbarNode)}}])&&Rt(e.prototype,i),n&&Rt(e,n),r}(lt);function Ft(t){return(Ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Dt(t,e){if(null==t)return{};var i,n,o=function(t,e){if(null==t)return{};var i,n,o={},r=Object.keys(t);for(n=0;n<r.length;n++)i=r[n],e.indexOf(i)>=0||(o[i]=t[i]);return o}(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(n=0;n<r.length;n++)i=r[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(o[i]=t[i])}return o}function At(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Nt(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Gt(t,e,i){return(Gt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=zt(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(i):o.value}})(t,e,i||t)}function Bt(t,e){return(Bt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Yt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=zt(t);if(e){var o=zt(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Xt(this,i)}}function Xt(t,e){return!e||"object"!==Ft(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function zt(t){return(zt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Wt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Bt(t,e)}(r,t);var e,i,n,o=Yt(r);function r(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.format,n=void 0===i?"HH:mm":i,s=e.buttonFormat,a=void 0===s?"DD. MMMM YYYY HH:mm":s,u=e.grouping,l=void 0===u?"daily":u,c=e.groupingDivider,h=void 0===c||c,f=e.groupingFormat,p=void 0===f?"ddd, DD. MMMM YYYY":f,d=e.classMain,y=void 0===d?"dropdown":d,v=e.classDropdownMenu,g=void 0===v?"dropdown-menu":v,m=e.classDropdownItem,_=void 0===m?"dropdown-item":m,b=e.classItemActive,w=void 0===b?"active":b,x=e.classItemNotEnabled,S=void 0===x?"disabled":x,T=e.classItemEnabled,O=void 0===T?void 0:T,C=e.classItemAllEnabled,E=void 0===C?void 0:C,P=e.classDropdownHeader,R=void 0===P?"dropdown-header":P,I=e.classDropdownDivider,k=void 0===I?"dropdown-divider":I,j=e.classDropdownButton,L=void 0===j?"btn dropdown-toggle":j,M=e.classButtonNotEnabled,F=void 0===M?void 0:M,D=e.classButtonEnabled,A=void 0===D?void 0:D,N=e.classButtonAllEnabled,G=void 0===N?void 0:N,B=Dt(e,["format","buttonFormat","grouping","groupingDivider","groupingFormat","classMain","classDropdownMenu","classDropdownItem","classItemActive","classItemNotEnabled","classItemEnabled","classItemAllEnabled","classDropdownHeader","classDropdownDivider","classDropdownButton","classButtonNotEnabled","classButtonEnabled","classButtonAllEnabled"]);return At(this,r),(t=o.call(this,B)).options.format=n,t.options.buttonFormat=a,t.options.grouping=l,t.options.groupingDivider=h,t.options.groupingFormat=p,t.options.classMain=y,t.options.classDropdownMenu=g,t.options.classDropdownItem=_,t.options.classItemActive=w,t.options.classItemNotEnabled=S,t.options.classItemEnabled=O,t.options.classItemAllEnabled=E,t.options.classDropdownHeader=R,t.options.classDropdownDivider=k,t.options.classDropdownButton=L,t.options.classButtonNotEnabled=F,t.options.classButtonEnabled=A,t.options.classButtonAllEnabled=G,t.visualisationButtonText=new mt({timeline:t.options.timeline,format:t.options.buttonFormat,textInvalid:t.options.textInvalid,outputTimezone:t.options.outputTimezone,getTimeText:t.options.getTimeText}),t.dropdownNode=void 0,t.setNode(t.options.node),t}return e=r,(i=[{key:"setOutputTimezone",value:function(t){return Gt(zt(r.prototype),"setOutputTimezone",this).call(this,t),this.visualisationButtonText.setOutputTimezone(t),this}},{key:"onChangeTime",value:function(){if(void 0!==this.dropdownNode){var t=this.options.timeline.getSelectedTime();this.options.node.children("button").removeClass(this.options.classButtonActive).removeClass(this.options.classButtonNotEnabled).removeClass(this.options.classButtonEnabled).removeClass(this.options.classButtonAllEnabled),this.options.timeline.isTimeAllEnabled(t)?this.options.node.children("button").addClass(this.options.classButtonAllEnabled):this.options.timeline.isTimeEnabled(t)?this.options.node.children("button").addClass(this.options.classButtonEnabled):this.options.node.children("button").addClass(this.options.classButtonNotEnabled);var e=this;this.dropdownNode.children("button."+this.options.classDropdownItem).each((function(){var i=new Date(+U()(this).data("time"));U()(this).removeClass(e.options.classItemActive).removeClass(e.options.classItemNotEnabled).removeClass(e.options.classItemEnabled).removeClass(e.options.classItemAllEnabled),t.valueOf()==i.valueOf()?U()(this).addClass(e.options.classItemActive):e.options.timeline.isTimeAllEnabled(i)?U()(this).addClass(e.options.classItemAllEnabled):e.options.timeline.isTimeEnabled(i)?U()(this).addClass(e.options.classItemEnabled):U()(this).addClass(e.options.classItemNotEnabled)}))}}},{key:"onChangeTimes",value:function(){void 0===this.dropdownNode&&(this.dropdownNode=U()("<div>")),this.dropdownNode.empty();var t="daily"==this.options.grouping?"YYYY-MM-DD":"hourly"==this.options.grouping?"YYYY-MM-DD HH":this.options.grouping,e=void 0;this.getTimelineTimes().forEach((function(i){void 0!==e&&e==this.timeToText(i,t)||(void 0!==e&&this.options.groupingDivider&&this.dropdownNode.append(U()("<div>").addClass(this.options.classDropdownDivider)),void 0!==this.options.groupingFormat&&this.dropdownNode.append(U()("<h6>").addClass(this.options.classDropdownHeader).text(this.timeToText(i,this.options.groupingFormat))),e=this.timeToText(i,t));var n=U()("<button>").addClass(this.options.classDropdownItem).attr("type","button").text(this.timeToText(i,this.options.format)).data("time",i.valueOf()),o=this;n.click((function(){o.options.timeline.setSelectedTime(new Date(+U()(this).data("time"))),o.trigger("input")})),this.dropdownNode.append(n)}),this)}},{key:"emptyNode",value:function(){void 0!==this.visualisationButtonText&&this.visualisationButtonText.setNode(void 0),this.dropdownNode=void 0,this.options.node.empty()}},{key:"onInitNode",value:function(){for(var t="dropdownMenuButton",e=0;null!=document.getElementById(t);)t="dropdownMenuButton"+ ++e;var i=U()("<button>").addClass(this.options.classDropdownButton).attr("type","button").attr("id",t).attr("data-toggle","dropdown").attr("aria-haspopup",!0).attr("aria-expanded",!1);this.visualisationButtonText.setNode(i),this.dropdownNode=U()("<div>").addClass(this.options.classDropdownMenu).attr("aria-labelledby",t),this.options.node.addClass(this.options.classMain).append(i).append(this.dropdownNode)}}])&&Nt(e.prototype,i),n&&Nt(e,n),r}(lt);function Vt(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Kt=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.options=U.a.extend(!0,{map:void 0,layerGroup:void 0},e)}var e,i,n;return e=t,(i=[{key:"getMap",value:function(){return this.options.map}},{key:"getViewCenter",value:function(){}},{key:"setViewCenter",value:function(){return this}},{key:"getViewZoom",value:function(){}},{key:"setViewZoom",value:function(){return this}},{key:"makeLayerGroup",value:function(){}},{key:"getExtendedEventByTypeCollection",value:function(t){return t.synviewType=void 0,t.layer=void 0,t.feature=void 0,t.color=void 0,t}},{key:"findLayerInType",value:function(){return-1}}])&&Vt(e.prototype,i),n&&Vt(e,n),t}();F(Kt.prototype);var qt=Kt;function Ht(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Zt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.itemIds=[],this.items={}}var e,i,n;return e=t,(i=[{key:"getCount",value:function(){return this.itemIds.length}},{key:"getItems",value:function(){return this.itemIds.map((function(t){return this.items[t]}),this)}},{key:"getItemIds",value:function(){return this.itemIds}},{key:"getItemById",value:function(t){return t in this.items?this.items[t]:void 0}},{key:"containsId",value:function(t){return-1!==this.getIndexById(t)}},{key:"getIndexById",value:function(t){var e=-1;return this.itemIds.forEach((function(i,n){i==t&&(e=n)})),e}},{key:"append",value:function(t){var e=t.getId();return this.containsId(e)?(this.trigger("replace:item",t,this.getItemById(e)),this.items[e]=t):(this.itemIds.push(e),this.items[e]=t,this.trigger("add:item",t)),this}},{key:"remove",value:function(t){var e=this.getItemById(t);if(void 0!==e){var i=this.getIndexById(t);delete this.items[t],this.itemIds.splice(i,1),this.trigger("remove:item",e)}return this}}])&&Ht(e.prototype,i),n&&Ht(e,n),t}();F(Zt.prototype);var Ut=Zt;function Jt(){return function(){throw new Error("Unimplemented abstract method.")}()}var Qt=0;function $t(t){return t.ol_uid||(t.ol_uid=String(++Qt))}var te,ee=(te=function(t,e){return(te=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}te(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),ie=function(t){function e(e){var i=this,n="Assertion failed. See https://openlayers.org/en/"+("v"+"6.3.1".split("-")[0])+"/doc/errors/#"+e+" for details.";return(i=t.call(this,n)||this).code=e,i.name="AssertionError",i.message=n,i}return ee(e,t),e}(Error),ne="add",oe="remove",re="propertychange",se="function"==typeof Object.assign?Object.assign:function(t,e){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(t),n=1,o=arguments.length;n<o;++n){var r=arguments[n];if(null!=r)for(var s in r)r.hasOwnProperty(s)&&(i[s]=r[s])}return i};function ae(t){for(var e in t)delete t[e]}var ue="function"==typeof Object.values?Object.values:function(t){var e=[];for(var i in t)e.push(t[i]);return e};function le(t){var e;for(e in t)return!1;return!e}function ce(t,e,i,n,o){if(n&&n!==t&&(i=i.bind(n)),o){var r=i;i=function(){t.removeEventListener(e,i),r.apply(this,arguments)}}var s={target:t,type:e,listener:i};return t.addEventListener(e,i),s}function he(t,e,i,n){return ce(t,e,i,n,!0)}function fe(t){t&&t.target&&(t.target.removeEventListener(t.type,t.listener),ae(t))}var pe=function(){function t(){this.disposed_=!1}return t.prototype.dispose=function(){this.disposed_||(this.disposed_=!0,this.disposeInternal())},t.prototype.disposeInternal=function(){},t}();function de(t,e){return t>e?1:t<e?-1:0}function ye(t,e,i){var n=t.length;if(t[0]<=e)return 0;if(e<=t[n-1])return n-1;var o=void 0;if(i>0){for(o=1;o<n;++o)if(t[o]<e)return o-1}else if(i<0){for(o=1;o<n;++o)if(t[o]<=e)return o}else for(o=1;o<n;++o){if(t[o]==e)return o;if(t[o]<e)return t[o-1]-e<e-t[o]?o-1:o}return n-1}function ve(t,e,i){for(;e<i;){var n=t[e];t[e]=t[i],t[i]=n,++e,--i}}function ge(t,e){for(var i=Array.isArray(e)?e:[e],n=i.length,o=0;o<n;o++)t[t.length]=i[o]}function me(t,e){var i=t.length;if(i!==e.length)return!1;for(var n=0;n<i;n++)if(t[n]!==e[n])return!1;return!0}function _e(){return!0}function be(){}var we=function(){function t(t){this.propagationStopped,this.type=t,this.target=null}return t.prototype.preventDefault=function(){this.propagationStopped=!0},t.prototype.stopPropagation=function(){this.propagationStopped=!0},t}(),xe=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Se=function(t){function e(e){var i=t.call(this)||this;return i.eventTarget_=e,i.pendingRemovals_={},i.dispatching_={},i.listeners_={},i}return xe(e,t),e.prototype.addEventListener=function(t,e){if(t&&e){var i=this.listeners_[t];i||(i=[],this.listeners_[t]=i),-1===i.indexOf(e)&&i.push(e)}},e.prototype.dispatchEvent=function(t){var e="string"==typeof t?new we(t):t,i=e.type;e.target||(e.target=this.eventTarget_||this);var n,o=this.listeners_[i];if(o){i in this.dispatching_||(this.dispatching_[i]=0,this.pendingRemovals_[i]=0),++this.dispatching_[i];for(var r=0,s=o.length;r<s;++r)if(!1===(n="handleEvent"in o[r]?o[r].handleEvent(e):o[r].call(this,e))||e.propagationStopped){n=!1;break}if(--this.dispatching_[i],0===this.dispatching_[i]){var a=this.pendingRemovals_[i];for(delete this.pendingRemovals_[i];a--;)this.removeEventListener(i,be);delete this.dispatching_[i]}return n}},e.prototype.disposeInternal=function(){ae(this.listeners_)},e.prototype.getListeners=function(t){return this.listeners_[t]},e.prototype.hasListener=function(t){return t?t in this.listeners_:Object.keys(this.listeners_).length>0},e.prototype.removeEventListener=function(t,e){var i=this.listeners_[t];if(i){var n=i.indexOf(e);-1!==n&&(t in this.pendingRemovals_?(i[n]=be,++this.pendingRemovals_[t]):(i.splice(n,1),0===i.length&&delete this.listeners_[t]))}},e}(pe),Te="change",Oe="error",Ce="load",Ee=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();var Pe=function(t){function e(){var e=t.call(this)||this;return e.revision_=0,e}return Ee(e,t),e.prototype.changed=function(){++this.revision_,this.dispatchEvent(Te)},e.prototype.getRevision=function(){return this.revision_},e.prototype.on=function(t,e){if(Array.isArray(t)){for(var i=t.length,n=new Array(i),o=0;o<i;++o)n[o]=ce(this,t[o],e);return n}return ce(this,t,e)},e.prototype.once=function(t,e){if(Array.isArray(t)){for(var i=t.length,n=new Array(i),o=0;o<i;++o)n[o]=he(this,t[o],e);return n}return he(this,t,e)},e.prototype.un=function(t,e){if(Array.isArray(t))for(var i=0,n=t.length;i<n;++i)this.removeEventListener(t[i],e);else this.removeEventListener(t,e)},e}(Se),Re=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ie=function(t){function e(e,i,n){var o=t.call(this,e)||this;return o.key=i,o.oldValue=n,o}return Re(e,t),e}(we),ke=function(t){function e(e){var i=t.call(this)||this;return $t(i),i.values_={},void 0!==e&&i.setProperties(e),i}return Re(e,t),e.prototype.get=function(t){var e;return this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e},e.prototype.getKeys=function(){return Object.keys(this.values_)},e.prototype.getProperties=function(){return se({},this.values_)},e.prototype.notify=function(t,e){var i;i=Le(t),this.dispatchEvent(new Ie(i,t,e)),i=re,this.dispatchEvent(new Ie(i,t,e))},e.prototype.set=function(t,e,i){if(i)this.values_[t]=e;else{var n=this.values_[t];this.values_[t]=e,n!==e&&this.notify(t,n)}},e.prototype.setProperties=function(t,e){for(var i in t)this.set(i,t[i],e)},e.prototype.unset=function(t,e){if(t in this.values_){var i=this.values_[t];delete this.values_[t],e||this.notify(t,i)}},e}(Pe),je={};function Le(t){return je.hasOwnProperty(t)?je[t]:je[t]="change:"+t}var Me=ke,Fe=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),De="length",Ae=function(t){function e(e,i,n){var o=t.call(this,e)||this;return o.element=i,o.index=n,o}return Fe(e,t),e}(we),Ne=function(t){function e(e,i){var n=t.call(this)||this,o=i||{};if(n.unique_=!!o.unique,n.array_=e||[],n.unique_)for(var r=0,s=n.array_.length;r<s;++r)n.assertUnique_(n.array_[r],r);return n.updateLength_(),n}return Fe(e,t),e.prototype.clear=function(){for(;this.getLength()>0;)this.pop()},e.prototype.extend=function(t){for(var e=0,i=t.length;e<i;++e)this.push(t[e]);return this},e.prototype.forEach=function(t){for(var e=this.array_,i=0,n=e.length;i<n;++i)t(e[i],i,e)},e.prototype.getArray=function(){return this.array_},e.prototype.item=function(t){return this.array_[t]},e.prototype.getLength=function(){return this.get(De)},e.prototype.insertAt=function(t,e){this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new Ae(ne,e,t))},e.prototype.pop=function(){return this.removeAt(this.getLength()-1)},e.prototype.push=function(t){this.unique_&&this.assertUnique_(t);var e=this.getLength();return this.insertAt(e,t),this.getLength()},e.prototype.remove=function(t){for(var e=this.array_,i=0,n=e.length;i<n;++i)if(e[i]===t)return this.removeAt(i)},e.prototype.removeAt=function(t){var e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new Ae(oe,e,t)),e},e.prototype.setAt=function(t,e){var i=this.getLength();if(t<i){this.unique_&&this.assertUnique_(e,t);var n=this.array_[t];this.array_[t]=e,this.dispatchEvent(new Ae(oe,n,t)),this.dispatchEvent(new Ae(ne,e,t))}else{for(var o=i;o<t;++o)this.insertAt(o,void 0);this.insertAt(t,e)}},e.prototype.updateLength_=function(){this.set(De,this.array_.length)},e.prototype.assertUnique_=function(t,e){for(var i=0,n=this.array_.length;i<n;++i)if(this.array_[i]===t&&i!==e)throw new ie(58)},e}(Me);function Ge(t,e){if(!t)throw new ie(e)}var Be="bottom-left",Ye="bottom-right",Xe="top-left",ze="top-right",We=0,Ve=1,Ke=2,qe=4,He=8,Ze=16;function Ue(t){for(var e=ni(),i=0,n=t.length;i<n;++i)li(e,t[i]);return e}function Je(t,e,i){return i?(i[0]=t[0]-e,i[1]=t[1]-e,i[2]=t[2]+e,i[3]=t[3]+e,i):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]}function Qe(t,e,i){var n,o;return(n=e<t[0]?t[0]-e:t[2]<e?e-t[2]:0)*n+(o=i<t[1]?t[1]-i:t[3]<i?i-t[3]:0)*o}function $e(t,e){return ei(t,e[0],e[1])}function ti(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function ei(t,e,i){return t[0]<=e&&e<=t[2]&&t[1]<=i&&i<=t[3]}function ii(t,e){var i=t[0],n=t[1],o=t[2],r=t[3],s=e[0],a=e[1],u=We;return s<i?u|=Ze:s>o&&(u|=qe),a<n?u|=He:a>r&&(u|=Ke),u===We&&(u=Ve),u}function ni(){return[1/0,1/0,-1/0,-1/0]}function oi(t,e,i,n,o){return o?(o[0]=t,o[1]=e,o[2]=i,o[3]=n,o):[t,e,i,n]}function ri(t){return oi(1/0,1/0,-1/0,-1/0,t)}function si(t,e,i,n,o){return ci(ri(o),t,e,i,n)}function ai(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function ui(t,e){return e[0]<t[0]&&(t[0]=e[0]),e[2]>t[2]&&(t[2]=e[2]),e[1]<t[1]&&(t[1]=e[1]),e[3]>t[3]&&(t[3]=e[3]),t}function li(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function ci(t,e,i,n,o){for(;i<n;i+=o)hi(t,e[i],e[i+1]);return t}function hi(t,e,i){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],i),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],i)}function fi(t){var e=0;return Si(t)||(e=wi(t)*gi(t)),e}function pi(t){return[t[0],t[1]]}function di(t){return[t[2],t[1]]}function yi(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function vi(t,e){var i;return e===Be?i=pi(t):e===Ye?i=di(t):e===Xe?i=_i(t):e===ze?i=bi(t):Ge(!1,13),i}function gi(t){return t[3]-t[1]}function mi(t,e,i){var n=i||[1/0,1/0,-1/0,-1/0];return xi(t,e)?(t[0]>e[0]?n[0]=t[0]:n[0]=e[0],t[1]>e[1]?n[1]=t[1]:n[1]=e[1],t[2]<e[2]?n[2]=t[2]:n[2]=e[2],t[3]<e[3]?n[3]=t[3]:n[3]=e[3]):ri(n),n}function _i(t){return[t[0],t[3]]}function bi(t){return[t[2],t[3]]}function wi(t){return t[2]-t[0]}function xi(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function Si(t){return t[2]<t[0]||t[3]<t[1]}function Ti(t,e,i,n){var o=[];if(n>1)for(var r=t[2]-t[0],s=t[3]-t[1],a=0;a<n;++a)o.push(t[0]+r*a/n,t[1],t[2],t[1]+s*a/n,t[2]-r*a/n,t[3],t[0],t[3]-s*a/n);else o=[t[0],t[1],t[2],t[1],t[2],t[3],t[0],t[3]];e(o,o,2);for(var u=[],l=[],c=(a=0,o.length);a<c;a+=2)u.push(o[a]),l.push(o[a+1]);return function(t,e,i){return oi(Math.min.apply(null,t),Math.min.apply(null,e),Math.max.apply(null,t),Math.max.apply(null,e),i)}(u,l,i)}var Oi="opacity",Ci="visible",Ei="extent",Pi="zIndex",Ri="maxResolution",Ii="minResolution",ki="maxZoom",ji="minZoom",Li="source";function Mi(t,e,i){return Math.min(Math.max(t,e),i)}var Fi="cosh"in Math?Math.cosh:function(t){var e=Math.exp(t);return(e+1/e)/2};function Di(t,e,i,n,o,r){var s=o-i,a=r-n;if(0!==s||0!==a){var u=((t-i)*s+(e-n)*a)/(s*s+a*a);u>1?(i=o,n=r):u>0&&(i+=s*u,n+=a*u)}return Ai(t,e,i,n)}function Ai(t,e,i,n){var o=i-t,r=n-e;return o*o+r*r}function Ni(t){return t*Math.PI/180}function Gi(t,e){var i=t%e;return i*e<0?i+e:i}function Bi(t,e,i){return t+i*(e-t)}var Yi=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Xi=function(t){function e(e){var i=t.call(this)||this,n=se({},e);return n[Oi]=void 0!==e.opacity?e.opacity:1,Ge("number"==typeof n[Oi],64),n[Ci]=void 0===e.visible||e.visible,n[Pi]=e.zIndex,n[Ri]=void 0!==e.maxResolution?e.maxResolution:1/0,n[Ii]=void 0!==e.minResolution?e.minResolution:0,n[ji]=void 0!==e.minZoom?e.minZoom:-1/0,n[ki]=void 0!==e.maxZoom?e.maxZoom:1/0,i.className_=void 0!==n.className?e.className:"ol-layer",delete n.className,i.setProperties(n),i.state_=null,i}return Yi(e,t),e.prototype.getClassName=function(){return this.className_},e.prototype.getLayerState=function(t){var e=this.state_||{layer:this,managed:void 0===t||t},i=this.getZIndex();return e.opacity=Mi(Math.round(100*this.getOpacity())/100,0,1),e.sourceState=this.getSourceState(),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=void 0!==i?i:!1===e.managed?1/0:0,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e},e.prototype.getLayersArray=function(t){return Jt()},e.prototype.getLayerStatesArray=function(t){return Jt()},e.prototype.getExtent=function(){return this.get(Ei)},e.prototype.getMaxResolution=function(){return this.get(Ri)},e.prototype.getMinResolution=function(){return this.get(Ii)},e.prototype.getMinZoom=function(){return this.get(ji)},e.prototype.getMaxZoom=function(){return this.get(ki)},e.prototype.getOpacity=function(){return this.get(Oi)},e.prototype.getSourceState=function(){return Jt()},e.prototype.getVisible=function(){return this.get(Ci)},e.prototype.getZIndex=function(){return this.get(Pi)},e.prototype.setExtent=function(t){this.set(Ei,t)},e.prototype.setMaxResolution=function(t){this.set(Ri,t)},e.prototype.setMinResolution=function(t){this.set(Ii,t)},e.prototype.setMaxZoom=function(t){this.set(ki,t)},e.prototype.setMinZoom=function(t){this.set(ji,t)},e.prototype.setOpacity=function(t){Ge("number"==typeof t,64),this.set(Oi,t)},e.prototype.setVisible=function(t){this.set(Ci,t)},e.prototype.setZIndex=function(t){this.set(Pi,t)},e.prototype.disposeInternal=function(){this.state_&&(this.state_.layer=null,this.state_=null),t.prototype.disposeInternal.call(this)},e}(Me),zi="undefined",Wi="ready",Vi=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ki="layers",qi=function(t){function e(e){var i=this,n=e||{},o=se({},n);delete o.layers;var r=n.layers;return(i=t.call(this,o)||this).layersListenerKeys_=[],i.listenerKeys_={},i.addEventListener(Le(Ki),i.handleLayersChanged_),r?Array.isArray(r)?r=new Ne(r.slice(),{unique:!0}):Ge("function"==typeof r.getArray,43):r=new Ne(void 0,{unique:!0}),i.setLayers(r),i}return Vi(e,t),e.prototype.handleLayerChange_=function(){this.changed()},e.prototype.handleLayersChanged_=function(){this.layersListenerKeys_.forEach(fe),this.layersListenerKeys_.length=0;var t=this.getLayers();for(var e in this.layersListenerKeys_.push(ce(t,ne,this.handleLayersAdd_,this),ce(t,oe,this.handleLayersRemove_,this)),this.listenerKeys_)this.listenerKeys_[e].forEach(fe);ae(this.listenerKeys_);for(var i=t.getArray(),n=0,o=i.length;n<o;n++){var r=i[n];this.listenerKeys_[$t(r)]=[ce(r,re,this.handleLayerChange_,this),ce(r,Te,this.handleLayerChange_,this)]}this.changed()},e.prototype.handleLayersAdd_=function(t){var e=t.element;this.listenerKeys_[$t(e)]=[ce(e,re,this.handleLayerChange_,this),ce(e,Te,this.handleLayerChange_,this)],this.changed()},e.prototype.handleLayersRemove_=function(t){var e=$t(t.element);this.listenerKeys_[e].forEach(fe),delete this.listenerKeys_[e],this.changed()},e.prototype.getLayers=function(){return this.get(Ki)},e.prototype.setLayers=function(t){this.set(Ki,t)},e.prototype.getLayersArray=function(t){var e=void 0!==t?t:[];return this.getLayers().forEach((function(t){t.getLayersArray(e)})),e},e.prototype.getLayerStatesArray=function(t){var e=void 0!==t?t:[],i=e.length;this.getLayers().forEach((function(t){t.getLayerStatesArray(e)}));for(var n=this.getLayerState(),o=i,r=e.length;o<r;o++){var s=e[o];s.opacity*=n.opacity,s.visible=s.visible&&n.visible,s.maxResolution=Math.min(s.maxResolution,n.maxResolution),s.minResolution=Math.max(s.minResolution,n.minResolution),s.minZoom=Math.max(s.minZoom,n.minZoom),s.maxZoom=Math.min(s.maxZoom,n.maxZoom),void 0!==n.extent&&(void 0!==s.extent?s.extent=mi(s.extent,n.extent):s.extent=n.extent)}return e},e.prototype.getSourceState=function(){return Wi},e}(Xi),Hi="prerender",Zi="postrender",Ui="precompose",Ji=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();var Qi=function(t){function e(e){var i=this,n=se({},e);delete n.source,(i=t.call(this,n)||this).mapPrecomposeKey_=null,i.mapRenderKey_=null,i.sourceChangeKey_=null,i.renderer_=null,e.render&&(i.render=e.render),e.map&&i.setMap(e.map),i.addEventListener(Le(Li),i.handleSourcePropertyChange_);var o=e.source?e.source:null;return i.setSource(o),i}return Ji(e,t),e.prototype.getLayersArray=function(t){var e=t||[];return e.push(this),e},e.prototype.getLayerStatesArray=function(t){var e=t||[];return e.push(this.getLayerState()),e},e.prototype.getSource=function(){return this.get(Li)||null},e.prototype.getSourceState=function(){var t=this.getSource();return t?t.getState():zi},e.prototype.handleSourceChange_=function(){this.changed()},e.prototype.handleSourcePropertyChange_=function(){this.sourceChangeKey_&&(fe(this.sourceChangeKey_),this.sourceChangeKey_=null);var t=this.getSource();t&&(this.sourceChangeKey_=ce(t,Te,this.handleSourceChange_,this)),this.changed()},e.prototype.getFeatures=function(t){return this.renderer_.getFeatures(t)},e.prototype.render=function(t,e){var i=this.getRenderer();if(i.prepareFrame(t))return i.renderFrame(t,e)},e.prototype.setMap=function(t){this.mapPrecomposeKey_&&(fe(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(fe(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=ce(t,Ui,(function(t){var e=t.frameState.layerStatesArray,i=this.getLayerState(!1);Ge(!e.some((function(t){return t.layer===i.layer})),67),e.push(i)}),this),this.mapRenderKey_=ce(this,Te,t.render,t),this.changed())},e.prototype.setSource=function(t){this.set(Li,t)},e.prototype.getRenderer=function(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_},e.prototype.hasRenderer=function(){return!!this.renderer_},e.prototype.createRenderer=function(){return null},e.prototype.disposeInternal=function(){this.setSource(null),t.prototype.disposeInternal.call(this)},e}(Xi),$i="Point",tn="LineString",en="LinearRing",nn="Polygon",on="MultiPoint",rn="MultiLineString",sn="MultiPolygon",an="GeometryCollection",un="Circle",ln=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,cn=/^([a-z]*)$|^hsla?\(.*\)$/i;function hn(t){var e=document.createElement("div");if(e.style.color=t,""!==e.style.color){document.body.appendChild(e);var i=getComputedStyle(e).color;return document.body.removeChild(e),i}return""}var fn,pn,dn=(fn={},pn=0,function(t){var e;if(fn.hasOwnProperty(t))e=fn[t];else{if(pn>=1024){var i=0;for(var n in fn)0==(3&i++)&&(delete fn[n],--pn)}e=function(t){var e,i,n,o,r;if(cn.exec(t)&&(t=hn(t)),ln.exec(t)){var s=t.length-1,a=void 0;a=s<=4?1:2;var u=4===s||8===s;e=parseInt(t.substr(1+0*a,a),16),i=parseInt(t.substr(1+1*a,a),16),n=parseInt(t.substr(1+2*a,a),16),o=u?parseInt(t.substr(1+3*a,a),16):255,1==a&&(e=(e<<4)+e,i=(i<<4)+i,n=(n<<4)+n,u&&(o=(o<<4)+o)),r=[e,i,n,o/255]}else 0==t.indexOf("rgba(")?vn(r=t.slice(5,-1).split(",").map(Number)):0==t.indexOf("rgb(")?((r=t.slice(4,-1).split(",").map(Number)).push(1),vn(r)):Ge(!1,14);return r}(t),fn[t]=e,++pn}return e});function yn(t){return Array.isArray(t)?t:dn(t)}function vn(t){return t[0]=Mi(t[0]+.5|0,0,255),t[1]=Mi(t[1]+.5|0,0,255),t[2]=Mi(t[2]+.5|0,0,255),t[3]=Mi(t[3],0,1),t}function gn(t){var e=t[0];e!=(0|e)&&(e=e+.5|0);var i=t[1];i!=(0|i)&&(i=i+.5|0);var n=t[2];return n!=(0|n)&&(n=n+.5|0),"rgba("+e+","+i+","+n+","+(void 0===t[3]?1:t[3])+")"}function mn(t){return Array.isArray(t)?gn(t):t}var _n="undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"",bn=(_n.indexOf("firefox"),-1!==_n.indexOf("safari")&&_n.indexOf("chrom"),-1!==_n.indexOf("webkit")&&_n.indexOf("edge"),_n.indexOf("macintosh"),"undefined"!=typeof devicePixelRatio&&devicePixelRatio,"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas&&self instanceof WorkerGlobalScope),wn="undefined"!=typeof Image&&Image.prototype.decode;!function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch(t){}}();function xn(t,e,i){var n=i&&i.length?i.shift():bn?new OffscreenCanvas(t||300,e||300):document.createElement("canvas");return t&&(n.width=t),e&&(n.height=e),n.getContext("2d")}var Sn=0,Tn=1,On=2,Cn=3,En=4,Pn=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))","?\\s*([-,\\\"\\'\\sa-z]+?)\\s*$"].join(""),"i"),Rn=["style","variant","weight","size","lineHeight","family"],In=function(t){var e=t.match(Pn);if(!e)return null;for(var i={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"},n=0,o=Rn.length;n<o;++n){var r=e[n+1];void 0!==r&&(i[Rn[n]]=r)}return i.families=i.family.split(/,\s?/),i},kn=new Array(6);function jn(t){return Mn(t,1,0,0,1,0,0)}function Ln(t,e){var i=t[0],n=t[1],o=t[2],r=t[3],s=t[4],a=t[5],u=e[0],l=e[1],c=e[2],h=e[3],f=e[4],p=e[5];return t[0]=i*u+o*l,t[1]=n*u+r*l,t[2]=i*c+o*h,t[3]=n*c+r*h,t[4]=i*f+o*p+s,t[5]=n*f+r*p+a,t}function Mn(t,e,i,n,o,r,s){return t[0]=e,t[1]=i,t[2]=n,t[3]=o,t[4]=r,t[5]=s,t}function Fn(t,e){var i=e[0],n=e[1];return e[0]=t[0]*i+t[2]*n+t[4],e[1]=t[1]*i+t[3]*n+t[5],e}function Dn(t,e,i){return Ln(t,Mn(kn,e,0,0,i,0,0))}function An(t,e,i,n,o,r,s,a){var u=Math.sin(r),l=Math.cos(r);return t[0]=n*l,t[1]=o*u,t[2]=-n*u,t[3]=o*l,t[4]=s*n*l-a*n*u+e,t[5]=s*o*u+a*o*l+i,t}function Nn(t,e){var i,n=(i=e)[0]*i[3]-i[1]*i[2];Ge(0!==n,32);var o=e[0],r=e[1],s=e[2],a=e[3],u=e[4],l=e[5];return t[0]=a/n,t[1]=-r/n,t[2]=-s/n,t[3]=o/n,t[4]=(s*l-a*u)/n,t[5]=-(o*l-r*u)/n,t}function Gn(t){return"matrix("+t.join(", ")+")"}var Bn=[],Yn=[0,0,0,0],Xn=new Me;(new Se).setSize=function(){console.warn("labelCache is deprecated.")};var zn,Wn,Vn,Kn=null,qn={},Hn=function(){var t,e,i=["monospace","serif"],n=i.length,o="wmytzilWMYTZIL@#/&?$%10";function r(t,r,s){for(var a=!0,u=0;u<n;++u){var l=i[u];if(e=Jn(t+" "+r+" 32px "+l,o),s!=l){var c=Jn(t+" "+r+" 32px "+s+","+l,o);a=a&&c!=e}}return!!a}function s(){for(var e=!0,i=Xn.getKeys(),n=0,o=i.length;n<o;++n){var s=i[n];Xn.get(s)<100&&(r.apply(this,s.split("\n"))?(ae(qn),Kn=null,zn=void 0,Xn.set(s,100)):(Xn.set(s,Xn.get(s)+1,!0),e=!1))}e&&(clearInterval(t),t=void 0)}return function(e){var i=In(e);if(i)for(var n=i.families,o=0,a=n.length;o<a;++o){var u=n[o],l=i.style+"\n"+i.weight+"\n"+u;void 0===Xn.get(l)&&(Xn.set(l,100,!0),r(i.style,i.weight,u)||(Xn.set(l,0,!0),void 0===t&&(t=setInterval(s,32))))}}}(),Zn=(Vn=qn,function(t){var e=Vn[t];if(null==e)if(bn){var i=In(t),n=Un(t,"g"),o=isNaN(Number(i.lineHeight))?1.2:Number(i.lineHeight);qn[t]=o*(n.actualBoundingBoxAscent+n.actualBoundingBoxDescent)}else Wn||((Wn=document.createElement("div")).innerHTML="M",Wn.style.margin="0 !important",Wn.style.padding="0 !important",Wn.style.position="absolute !important",Wn.style.left="-99999px !important"),Wn.style.font=t,document.body.appendChild(Wn),e=Wn.offsetHeight,Vn[t]=e,document.body.removeChild(Wn);return e});function Un(t,e){return Kn||(Kn=xn(1,1)),t!=zn&&(Kn.font=t,zn=Kn.font),Kn.measureText(e)}function Jn(t,e){return Un(t,e).width}function Qn(t,e,i){if(e in i)return i[e];var n=Jn(t,e);return i[e]=n,n}function $n(t,e,i,n){0!==e&&(t.translate(i,n),t.rotate(e),t.translate(-i,-n))}function to(t,e,i,n,o,r,s,a,u,l,c){t.save(),1!==i&&(t.globalAlpha*=i),e&&t.setTransform.apply(t,e),n.contextInstructions?(t.translate(u,l),t.scale(c,c),function(t,e){for(var i=t.contextInstructions,n=0,o=i.length;n<o;n+=2)Array.isArray(i[n+1])?e[i[n]].apply(e,i[n+1]):e[i[n]]=i[n+1]}(n,t)):t.drawImage(n,o,r,s,a,u,l,s*c,a*c),t.restore()}var eo=null;function io(t){return bn?Gn(t):(eo||(eo=xn(1,1).canvas),eo.style.transform=Gn(t),eo.style.transform)}var no=function(){function t(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.displacement_=t.displacement}return t.prototype.clone=function(){return new t({opacity:this.getOpacity(),scale:this.getScale(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice()})},t.prototype.getOpacity=function(){return this.opacity_},t.prototype.getRotateWithView=function(){return this.rotateWithView_},t.prototype.getRotation=function(){return this.rotation_},t.prototype.getScale=function(){return this.scale_},t.prototype.getDisplacement=function(){return this.displacement_},t.prototype.getAnchor=function(){return Jt()},t.prototype.getImage=function(t){return Jt()},t.prototype.getHitDetectionImage=function(t){return Jt()},t.prototype.getImageState=function(){return Jt()},t.prototype.getImageSize=function(){return Jt()},t.prototype.getHitDetectionImageSize=function(){return Jt()},t.prototype.getOrigin=function(){return Jt()},t.prototype.getSize=function(){return Jt()},t.prototype.setOpacity=function(t){this.opacity_=t},t.prototype.setRotateWithView=function(t){this.rotateWithView_=t},t.prototype.setRotation=function(t){this.rotation_=t},t.prototype.setScale=function(t){this.scale_=t},t.prototype.listenImageChange=function(t){Jt()},t.prototype.load=function(){Jt()},t.prototype.unlistenImageChange=function(t){Jt()},t}(),oo=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ro=function(t){function e(e){var i=this,n=void 0!==e.rotateWithView&&e.rotateWithView;return(i=t.call(this,{opacity:1,rotateWithView:n,rotation:void 0!==e.rotation?e.rotation:0,scale:1,displacement:void 0!==e.displacement?e.displacement:[0,0]})||this).canvas_=null,i.hitDetectionCanvas_=null,i.fill_=void 0!==e.fill?e.fill:null,i.origin_=[0,0],i.points_=e.points,i.radius_=void 0!==e.radius?e.radius:e.radius1,i.radius2_=e.radius2,i.angle_=void 0!==e.angle?e.angle:0,i.stroke_=void 0!==e.stroke?e.stroke:null,i.anchor_=null,i.size_=null,i.imageSize_=null,i.hitDetectionImageSize_=null,i.render(),i}return oo(e,t),e.prototype.clone=function(){var t=new e({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice()});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t},e.prototype.getAnchor=function(){return this.anchor_},e.prototype.getAngle=function(){return this.angle_},e.prototype.getFill=function(){return this.fill_},e.prototype.getHitDetectionImage=function(t){return this.hitDetectionCanvas_},e.prototype.getImage=function(t){return this.canvas_},e.prototype.getImageSize=function(){return this.imageSize_},e.prototype.getHitDetectionImageSize=function(){return this.hitDetectionImageSize_},e.prototype.getImageState=function(){return On},e.prototype.getOrigin=function(){return this.origin_},e.prototype.getPoints=function(){return this.points_},e.prototype.getRadius=function(){return this.radius_},e.prototype.getRadius2=function(){return this.radius2_},e.prototype.getSize=function(){return this.size_},e.prototype.getStroke=function(){return this.stroke_},e.prototype.listenImageChange=function(t){},e.prototype.load=function(){},e.prototype.unlistenImageChange=function(t){},e.prototype.render=function(){var t,e="round",i="round",n=0,o=null,r=0,s=0;this.stroke_&&(null===(t=this.stroke_.getColor())&&(t="#000"),t=mn(t),void 0===(s=this.stroke_.getWidth())&&(s=1),o=this.stroke_.getLineDash(),r=this.stroke_.getLineDashOffset(),void 0===(i=this.stroke_.getLineJoin())&&(i="round"),void 0===(e=this.stroke_.getLineCap())&&(e="round"),void 0===(n=this.stroke_.getMiterLimit())&&(n=10));var a=2*(this.radius_+s)+1,u={strokeStyle:t,strokeWidth:s,size:a,lineCap:e,lineDash:o,lineDashOffset:r,lineJoin:i,miterLimit:n},l=xn(a,a);this.canvas_=l.canvas;var c=a=this.canvas_.width,h=this.getDisplacement();this.draw_(u,l,0,0),this.createHitDetectionCanvas_(u),this.anchor_=[a/2-h[0],a/2+h[1]],this.size_=[a,a],this.imageSize_=[c,c]},e.prototype.draw_=function(t,e,i,n){var o,r,s;e.setTransform(1,0,0,1,0,0),e.translate(i,n),e.beginPath();var a=this.points_;if(a===1/0)e.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{var u=void 0!==this.radius2_?this.radius2_:this.radius_;for(u!==this.radius_&&(a*=2),o=0;o<=a;o++)r=2*o*Math.PI/a-Math.PI/2+this.angle_,s=o%2==0?this.radius_:u,e.lineTo(t.size/2+s*Math.cos(r),t.size/2+s*Math.sin(r))}if(this.fill_){var l=this.fill_.getColor();null===l&&(l="#000"),e.fillStyle=mn(l),e.fill()}this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,e.setLineDash&&t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke()),e.closePath()},e.prototype.createHitDetectionCanvas_=function(t){if(this.hitDetectionImageSize_=[t.size,t.size],this.hitDetectionCanvas_=this.canvas_,this.fill_){var e=this.fill_.getColor(),i=0;if("string"==typeof e&&(e=yn(e)),null===e?i=1:Array.isArray(e)&&(i=4===e.length?e[3]:1),0===i){var n=xn(t.size,t.size);this.hitDetectionCanvas_=n.canvas,this.drawHitDetectionCanvas_(t,n,0,0)}}},e.prototype.drawHitDetectionCanvas_=function(t,e,i,n){e.setTransform(1,0,0,1,0,0),e.translate(i,n),e.beginPath();var o=this.points_;if(o===1/0)e.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{var r=void 0!==this.radius2_?this.radius2_:this.radius_;r!==this.radius_&&(o*=2);var s=void 0,a=void 0,u=void 0;for(s=0;s<=o;s++)u=2*s*Math.PI/o-Math.PI/2+this.angle_,a=s%2==0?this.radius_:r,e.lineTo(t.size/2+a*Math.cos(u),t.size/2+a*Math.sin(u))}e.fillStyle="#000",e.fill(),this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.stroke()),e.closePath()},e}(no),so=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ao=function(t){function e(e){var i=e||{};return t.call(this,{points:1/0,fill:i.fill,radius:i.radius,stroke:i.stroke,displacement:void 0!==i.displacement?i.displacement:[0,0]})||this}return so(e,t),e.prototype.clone=function(){var t=new e({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),displacement:this.getDisplacement().slice()});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t},e.prototype.setRadius=function(t){this.radius_=t,this.render()},e}(ro),uo=function(){function t(t){var e=t||{};this.color_=void 0!==e.color?e.color:null}return t.prototype.clone=function(){var e=this.getColor();return new t({color:Array.isArray(e)?e.slice():e||void 0})},t.prototype.getColor=function(){return this.color_},t.prototype.setColor=function(t){this.color_=t},t}(),lo=function(){function t(t){var e=t||{};this.color_=void 0!==e.color?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=void 0!==e.lineDash?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}return t.prototype.clone=function(){var e=this.getColor();return new t({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})},t.prototype.getColor=function(){return this.color_},t.prototype.getLineCap=function(){return this.lineCap_},t.prototype.getLineDash=function(){return this.lineDash_},t.prototype.getLineDashOffset=function(){return this.lineDashOffset_},t.prototype.getLineJoin=function(){return this.lineJoin_},t.prototype.getMiterLimit=function(){return this.miterLimit_},t.prototype.getWidth=function(){return this.width_},t.prototype.setColor=function(t){this.color_=t},t.prototype.setLineCap=function(t){this.lineCap_=t},t.prototype.setLineDash=function(t){this.lineDash_=t},t.prototype.setLineDashOffset=function(t){this.lineDashOffset_=t},t.prototype.setLineJoin=function(t){this.lineJoin_=t},t.prototype.setMiterLimit=function(t){this.miterLimit_=t},t.prototype.setWidth=function(t){this.width_=t},t}();function co(t){return(co="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var ho=function(){function t(t){var e=t||{};this.geometry_=null,this.geometryFunction_=yo,void 0!==e.geometry&&this.setGeometry(e.geometry),this.fill_=void 0!==e.fill?e.fill:null,this.image_=void 0!==e.image?e.image:null,this.renderer_=void 0!==e.renderer?e.renderer:null,this.stroke_=void 0!==e.stroke?e.stroke:null,this.text_=void 0!==e.text?e.text:null,this.zIndex_=e.zIndex}return t.prototype.clone=function(){var e=this.getGeometry();return e&&"object"===co(e)&&(e=e.clone()),new t({geometry:e,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})},t.prototype.getRenderer=function(){return this.renderer_},t.prototype.setRenderer=function(t){this.renderer_=t},t.prototype.getGeometry=function(){return this.geometry_},t.prototype.getGeometryFunction=function(){return this.geometryFunction_},t.prototype.getFill=function(){return this.fill_},t.prototype.setFill=function(t){this.fill_=t},t.prototype.getImage=function(){return this.image_},t.prototype.setImage=function(t){this.image_=t},t.prototype.getStroke=function(){return this.stroke_},t.prototype.setStroke=function(t){this.stroke_=t},t.prototype.getText=function(){return this.text_},t.prototype.setText=function(t){this.text_=t},t.prototype.getZIndex=function(){return this.zIndex_},t.prototype.setGeometry=function(t){"function"==typeof t?this.geometryFunction_=t:"string"==typeof t?this.geometryFunction_=function(e){return e.get(t)}:t?void 0!==t&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=yo,this.geometry_=t},t.prototype.setZIndex=function(t){this.zIndex_=t},t}();var fo=null;function po(t,e){if(!fo){var i=new uo({color:"rgba(255,255,255,0.4)"}),n=new lo({color:"#3399CC",width:1.25});fo=[new ho({image:new ao({fill:i,stroke:n,radius:5}),fill:i,stroke:n})]}return fo}function yo(t){return t.getGeometry()}var vo=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),go="renderOrder",mo=function(t){function e(e){var i=this,n=e||{},o=se({},n);return delete o.style,delete o.renderBuffer,delete o.updateWhileAnimating,delete o.updateWhileInteracting,(i=t.call(this,o)||this).declutter_=void 0!==n.declutter&&n.declutter,i.renderBuffer_=void 0!==n.renderBuffer?n.renderBuffer:100,i.style_=null,i.styleFunction_=void 0,i.setStyle(n.style),i.updateWhileAnimating_=void 0!==n.updateWhileAnimating&&n.updateWhileAnimating,i.updateWhileInteracting_=void 0!==n.updateWhileInteracting&&n.updateWhileInteracting,i}return vo(e,t),e.prototype.getDeclutter=function(){return this.declutter_},e.prototype.getFeatures=function(e){return t.prototype.getFeatures.call(this,e)},e.prototype.getRenderBuffer=function(){return this.renderBuffer_},e.prototype.getRenderOrder=function(){return this.get(go)},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.getUpdateWhileAnimating=function(){return this.updateWhileAnimating_},e.prototype.getUpdateWhileInteracting=function(){return this.updateWhileInteracting_},e.prototype.setRenderOrder=function(t){this.set(go,t)},e.prototype.setStyle=function(t){this.style_=void 0!==t?t:po,this.styleFunction_=null===t?void 0:function(t){var e;if("function"==typeof t)e=t;else{var i;if(Array.isArray(t))i=t;else Ge("function"==typeof t.getZIndex,41),i=[t];e=function(){return i}}return e}(this.style_),this.changed()},e}(Qi),_o=0,bo=1;function wo(t,e){var i=e.getExtent();if(e.canWrapX()&&(t[0]<i[0]||t[0]>=i[2])){var n=wi(i),o=Math.floor((t[0]-i[0])/n);t[0]-=o*n}return t}function xo(t,e,i){var n=i||6371008.8,o=Ni(t[1]),r=Ni(e[1]),s=(r-o)/2,a=Ni(e[0]-t[0])/2,u=Math.sin(s)*Math.sin(s)+Math.sin(a)*Math.sin(a)*Math.cos(o)*Math.cos(r);return 2*n*Math.atan2(Math.sqrt(u),Math.sqrt(1-u))}var So={DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"},To={};To[So.DEGREES]=2*Math.PI*6370997/360,To[So.FEET]=.3048,To[So.METERS]=1,To[So.USFEET]=1200/3937;var Oo=So,Co=function(){function t(t){this.code_=t.code,this.units_=t.units,this.extent_=void 0!==t.extent?t.extent:null,this.worldExtent_=void 0!==t.worldExtent?t.worldExtent:null,this.axisOrientation_=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.global_=void 0!==t.global&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}return t.prototype.canWrapX=function(){return this.canWrapX_},t.prototype.getCode=function(){return this.code_},t.prototype.getExtent=function(){return this.extent_},t.prototype.getUnits=function(){return this.units_},t.prototype.getMetersPerUnit=function(){return this.metersPerUnit_||To[this.units_]},t.prototype.getWorldExtent=function(){return this.worldExtent_},t.prototype.getAxisOrientation=function(){return this.axisOrientation_},t.prototype.isGlobal=function(){return this.global_},t.prototype.setGlobal=function(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)},t.prototype.getDefaultTileGrid=function(){return this.defaultTileGrid_},t.prototype.setDefaultTileGrid=function(t){this.defaultTileGrid_=t},t.prototype.setExtent=function(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)},t.prototype.setWorldExtent=function(t){this.worldExtent_=t},t.prototype.setGetPointResolution=function(t){this.getPointResolutionFunc_=t},t.prototype.getPointResolutionFunc=function(){return this.getPointResolutionFunc_},t}(),Eo=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Po=6378137*Math.PI,Ro=[-Po,-Po,Po,Po],Io=[-180,-85,180,85],ko=function(t){function e(e){return t.call(this,{code:e,units:Oo.METERS,extent:Ro,global:!0,worldExtent:Io,getPointResolution:function(t,e){return t/Fi(e[1]/6378137)}})||this}return Eo(e,t),e}(Co),jo=[new ko("EPSG:3857"),new ko("EPSG:102100"),new ko("EPSG:102113"),new ko("EPSG:900913"),new ko("urn:ogc:def:crs:EPSG:6.18:3:3857"),new ko("urn:ogc:def:crs:EPSG::3857"),new ko("http://www.opengis.net/gml/srs/epsg.xml#3857")];function Lo(t,e,i){var n=t.length,o=i>1?i:2,r=e;void 0===r&&(r=o>2?t.slice():new Array(n));for(var s=Po,a=0;a<n;a+=o){r[a]=s*t[a]/180;var u=6378137*Math.log(Math.tan(Math.PI*(+t[a+1]+90)/360));u>s?u=s:u<-s&&(u=-s),r[a+1]=u}return r}function Mo(t,e,i){var n=t.length,o=i>1?i:2,r=e;void 0===r&&(r=o>2?t.slice():new Array(n));for(var s=0;s<n;s+=o)r[s]=180*t[s]/Po,r[s+1]=360*Math.atan(Math.exp(t[s+1]/6378137))/Math.PI-90;return r}var Fo=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Do=[-180,-90,180,90],Ao=6378137*Math.PI/180,No=function(t){function e(e,i){return t.call(this,{code:e,units:Oo.DEGREES,extent:Do,axisOrientation:i,global:!0,metersPerUnit:Ao,worldExtent:Do})||this}return Fo(e,t),e}(Co),Go=[new No("CRS:84"),new No("EPSG:4326","neu"),new No("urn:ogc:def:crs:EPSG::4326","neu"),new No("urn:ogc:def:crs:EPSG:6.6:4326","neu"),new No("urn:ogc:def:crs:OGC:1.3:CRS84"),new No("urn:ogc:def:crs:OGC:2:84"),new No("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new No("urn:x-ogc:def:crs:EPSG:4326","neu")],Bo={};function Yo(t,e,i){var n=t.getCode(),o=e.getCode();n in Bo||(Bo[n]={}),Bo[n][o]=i}var Xo={};function zo(t,e,i){var n;if(void 0!==e){for(var o=0,r=t.length;o<r;++o)e[o]=t[o];n=e}else n=t.slice();return n}function Wo(t,e,i){if(void 0!==e&&t!==e){for(var n=0,o=t.length;n<o;++n)e[n]=t[n];t=e}return t}function Vo(t){!function(t,e){Xo[t]=e}(t.getCode(),t),Yo(t,t,zo)}function Ko(t){return"string"==typeof t?Xo[t]||null:t||null}function qo(t,e,i,n){var o,r=(t=Ko(t)).getPointResolutionFunc();if(r)o=r(e,i),n&&n!==t.getUnits()&&(s=t.getMetersPerUnit())&&(o=o*s/To[n]);else if(t.getUnits()==Oo.DEGREES&&!n||n==Oo.DEGREES)o=e;else{var s,a=Uo(t,Ko("EPSG:4326")),u=[i[0]-e/2,i[1],i[0]+e/2,i[1],i[0],i[1]-e/2,i[0],i[1]+e/2];o=(xo((u=a(u,u,2)).slice(0,2),u.slice(2,4))+xo(u.slice(4,6),u.slice(6,8)))/2,void 0!==(s=n?To[n]:t.getMetersPerUnit())&&(o/=s)}return o}function Ho(t){!function(t){t.forEach(Vo)}(t),t.forEach((function(e){t.forEach((function(t){e!==t&&Yo(e,t,zo)}))}))}function Zo(t,e){if(t===e)return!0;var i=t.getUnits()===e.getUnits();return(t.getCode()===e.getCode()||Uo(t,e)===zo)&&i}function Uo(t,e){var i=function(t,e){var i;return t in Bo&&e in Bo[t]&&(i=Bo[t][e]),i}(t.getCode(),e.getCode());return i||(i=Wo),i}function Jo(t,e){return Uo(Ko(t),Ko(e))}function Qo(t,e,i){return Jo(e,i)(t,void 0,t.length)}function $o(t,e,i,n){return Ti(t,Jo(e,i),void 0,n)}var tr,er,ir,nr=null;function or(t,e){return nr?$o(t,e,nr):t}function rr(t,e){return nr?$o(t,nr,e):t}function sr(t,e,i,n,o){for(var r=void 0!==o?o:[],s=0,a=e;a<i;a+=n)r[s++]=t.slice(a,a+n);return r.length=s,r}function ar(t,e,i,n,o){for(var r=void 0!==o?o:[],s=0,a=0,u=i.length;a<u;++a){var l=i[a];r[s++]=sr(t,e,l,n,r[s]),e=l}return r.length=s,r}function ur(t,e,i,n,o){for(var r=void 0!==o?o:[],s=0,a=0,u=i.length;a<u;++a){var l=i[a];r[s++]=ar(t,e,l,n,r[s]),e=l[l.length-1]}return r.length=s,r}Ho(jo),Ho(Go),tr=jo,er=Lo,ir=Mo,Go.forEach((function(t){tr.forEach((function(e){Yo(t,e,er),Yo(e,t,ir)}))}));var lr=function(){function t(){}return t.prototype.drawCustom=function(t,e,i){},t.prototype.drawGeometry=function(t){},t.prototype.setStyle=function(t){},t.prototype.drawCircle=function(t,e){},t.prototype.drawFeature=function(t,e){},t.prototype.drawGeometryCollection=function(t,e){},t.prototype.drawLineString=function(t,e){},t.prototype.drawMultiLineString=function(t,e){},t.prototype.drawMultiPoint=function(t,e){},t.prototype.drawMultiPolygon=function(t,e){},t.prototype.drawPoint=function(t,e){},t.prototype.drawPolygon=function(t,e){},t.prototype.drawText=function(t,e){},t.prototype.setFillStrokeStyle=function(t,e){},t.prototype.setImageStyle=function(t,e){},t.prototype.setTextStyle=function(t,e){},t}(),cr={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},hr=[cr.FILL],fr=[cr.STROKE],pr=[cr.BEGIN_PATH],dr=[cr.CLOSE_PATH],yr=cr,vr=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),gr=function(t){function e(e,i,n,o){var r=t.call(this)||this;return r.tolerance=e,r.maxExtent=i,r.pixelRatio=o,r.maxLineWidth=0,r.resolution=n,r.beginGeometryInstruction1_=null,r.beginGeometryInstruction2_=null,r.bufferedMaxExtent_=null,r.instructions=[],r.coordinates=[],r.tmpCoordinate_=[],r.hitDetectionInstructions=[],r.state={},r}return vr(e,t),e.prototype.applyPixelRatio=function(t){var e=this.pixelRatio;return 1==e?t:t.map((function(t){return t*e}))},e.prototype.appendFlatCoordinates=function(t,e,i,n,o,r){var s=this.coordinates.length,a=this.getBufferedMaxExtent();r&&(e+=n);var u,l,c,h=t[e],f=t[e+1],p=this.tmpCoordinate_,d=!0;for(u=e+n;u<i;u+=n)p[0]=t[u],p[1]=t[u+1],(c=ii(a,p))!==l?(d&&(this.coordinates[s++]=h,this.coordinates[s++]=f),this.coordinates[s++]=p[0],this.coordinates[s++]=p[1],d=!1):c===Ve?(this.coordinates[s++]=p[0],this.coordinates[s++]=p[1],d=!1):d=!0,h=p[0],f=p[1],l=c;return(o&&d||u===e+n)&&(this.coordinates[s++]=h,this.coordinates[s++]=f),s},e.prototype.drawCustomCoordinates_=function(t,e,i,n,o){for(var r=0,s=i.length;r<s;++r){var a=i[r],u=this.appendFlatCoordinates(t,e,a,n,!1,!1);o.push(u),e=a}return e},e.prototype.drawCustom=function(t,e,i){this.beginGeometry(t,e);var n,o,r,s,a,u=t.getType(),l=t.getStride(),c=this.coordinates.length;if(u==sn){n=(t=t).getOrientedFlatCoordinates(),s=[];var h=t.getEndss();a=0;for(var f=0,p=h.length;f<p;++f){var d=[];a=this.drawCustomCoordinates_(n,a,h[f],l,d),s.push(d)}this.instructions.push([yr.CUSTOM,c,s,t,i,ur])}else u==nn||u==rn?(r=[],n=u==nn?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),a=this.drawCustomCoordinates_(n,0,t.getEnds(),l,r),this.instructions.push([yr.CUSTOM,c,r,t,i,ar])):u==tn||u==on?(n=t.getFlatCoordinates(),o=this.appendFlatCoordinates(n,0,n.length,l,!1,!1),this.instructions.push([yr.CUSTOM,c,o,t,i,sr])):u==$i&&(n=t.getFlatCoordinates(),this.coordinates.push(n[0],n[1]),o=this.coordinates.length,this.instructions.push([yr.CUSTOM,c,o,t,i]));this.endGeometry(e)},e.prototype.beginGeometry=function(t,e){var i=t.getExtent();this.beginGeometryInstruction1_=[yr.BEGIN_GEOMETRY,e,0,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[yr.BEGIN_GEOMETRY,e,0,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)},e.prototype.finish=function(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}},e.prototype.reverseHitDetectionInstructions=function(){var t,e=this.hitDetectionInstructions;e.reverse();var i,n,o=e.length,r=-1;for(t=0;t<o;++t)(n=(i=e[t])[0])==yr.END_GEOMETRY?r=t:n==yr.BEGIN_GEOMETRY&&(i[2]=t,ve(this.hitDetectionInstructions,r,t),r=-1)},e.prototype.setFillStrokeStyle=function(t,e){var i=this.state;if(t){var n=t.getColor();i.fillStyle=mn(n||"#000")}else i.fillStyle=void 0;if(e){var o=e.getColor();i.strokeStyle=mn(o||"#000");var r=e.getLineCap();i.lineCap=void 0!==r?r:"round";var s=e.getLineDash();i.lineDash=s?s.slice():Bn;var a=e.getLineDashOffset();i.lineDashOffset=a||0;var u=e.getLineJoin();i.lineJoin=void 0!==u?u:"round";var l=e.getWidth();i.lineWidth=void 0!==l?l:1;var c=e.getMiterLimit();i.miterLimit=void 0!==c?c:10,i.lineWidth>this.maxLineWidth&&(this.maxLineWidth=i.lineWidth,this.bufferedMaxExtent_=null)}else i.strokeStyle=void 0,i.lineCap=void 0,i.lineDash=null,i.lineDashOffset=void 0,i.lineJoin=void 0,i.lineWidth=void 0,i.miterLimit=void 0},e.prototype.createFill=function(t){var e=t.fillStyle,i=[yr.SET_FILL_STYLE,e];return"string"!=typeof e&&i.push(!0),i},e.prototype.applyStroke=function(t){this.instructions.push(this.createStroke(t))},e.prototype.createStroke=function(t){return[yr.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]},e.prototype.updateFillStyle=function(t,e){var i=t.fillStyle;"string"==typeof i&&t.currentFillStyle==i||(void 0!==i&&this.instructions.push(e.call(this,t)),t.currentFillStyle=i)},e.prototype.updateStrokeStyle=function(t,e){var i=t.strokeStyle,n=t.lineCap,o=t.lineDash,r=t.lineDashOffset,s=t.lineJoin,a=t.lineWidth,u=t.miterLimit;(t.currentStrokeStyle!=i||t.currentLineCap!=n||o!=t.currentLineDash&&!me(t.currentLineDash,o)||t.currentLineDashOffset!=r||t.currentLineJoin!=s||t.currentLineWidth!=a||t.currentMiterLimit!=u)&&(void 0!==i&&e.call(this,t),t.currentStrokeStyle=i,t.currentLineCap=n,t.currentLineDash=o,t.currentLineDashOffset=r,t.currentLineJoin=s,t.currentLineWidth=a,t.currentMiterLimit=u)},e.prototype.endGeometry=function(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;var e=[yr.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)},e.prototype.getBufferedMaxExtent=function(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=(e=this.maxExtent,i?(i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i):e.slice()),this.maxLineWidth>0)){var t=this.resolution*(this.maxLineWidth+1)/2;Je(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}var e,i;return this.bufferedMaxExtent_},e}(lr),mr=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),_r=function(t){function e(e,i,n,o){var r=t.call(this,e,i,n,o)||this;return r.declutterGroups_=null,r.hitDetectionImage_=null,r.image_=null,r.anchorX_=void 0,r.anchorY_=void 0,r.height_=void 0,r.opacity_=void 0,r.originX_=void 0,r.originY_=void 0,r.rotateWithView_=void 0,r.rotation_=void 0,r.scale_=void 0,r.width_=void 0,r}return mr(e,t),e.prototype.drawCoordinates_=function(t,e,i,n){return this.appendFlatCoordinates(t,e,i,n,!1,!1)},e.prototype.drawPoint=function(t,e){if(this.image_){this.beginGeometry(t,e);var i=t.getFlatCoordinates(),n=t.getStride(),o=this.coordinates.length,r=this.drawCoordinates_(i,0,i.length,n);this.instructions.push([yr.DRAW_IMAGE,o,r,this.image_,this.anchorX_,this.anchorY_,this.declutterGroups_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_*this.pixelRatio,this.width_]),this.hitDetectionInstructions.push([yr.DRAW_IMAGE,o,r,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroups_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_]),this.endGeometry(e)}},e.prototype.drawMultiPoint=function(t,e){if(this.image_){this.beginGeometry(t,e);var i=t.getFlatCoordinates(),n=t.getStride(),o=this.coordinates.length,r=this.drawCoordinates_(i,0,i.length,n);this.instructions.push([yr.DRAW_IMAGE,o,r,this.image_,this.anchorX_,this.anchorY_,this.declutterGroups_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_*this.pixelRatio,this.width_]),this.hitDetectionInstructions.push([yr.DRAW_IMAGE,o,r,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroups_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_]),this.endGeometry(e)}},e.prototype.finish=function(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,t.prototype.finish.call(this)},e.prototype.setImageStyle=function(t,e){var i=t.getAnchor(),n=t.getSize(),o=t.getHitDetectionImage(1),r=t.getImage(1),s=t.getOrigin();this.anchorX_=i[0],this.anchorY_=i[1],this.declutterGroups_=e,this.hitDetectionImage_=o,this.image_=r,this.height_=n[1],this.opacity_=t.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScale(),this.width_=n[0]},e}(gr),br=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),wr=function(t){function e(e,i,n,o){return t.call(this,e,i,n,o)||this}return br(e,t),e.prototype.drawFlatCoordinates_=function(t,e,i,n){var o=this.coordinates.length,r=this.appendFlatCoordinates(t,e,i,n,!1,!1),s=[yr.MOVE_TO_LINE_TO,o,r];return this.instructions.push(s),this.hitDetectionInstructions.push(s),i},e.prototype.drawLineString=function(t,e){var i=this.state,n=i.strokeStyle,o=i.lineWidth;if(void 0!==n&&void 0!==o){this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([yr.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset],pr);var r=t.getFlatCoordinates(),s=t.getStride();this.drawFlatCoordinates_(r,0,r.length,s),this.hitDetectionInstructions.push(fr),this.endGeometry(e)}},e.prototype.drawMultiLineString=function(t,e){var i=this.state,n=i.strokeStyle,o=i.lineWidth;if(void 0!==n&&void 0!==o){this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([yr.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset],pr);for(var r=t.getEnds(),s=t.getFlatCoordinates(),a=t.getStride(),u=0,l=0,c=r.length;l<c;++l)u=this.drawFlatCoordinates_(s,u,r[l],a);this.hitDetectionInstructions.push(fr),this.endGeometry(e)}},e.prototype.finish=function(){var e=this.state;return null!=e.lastStroke&&e.lastStroke!=this.coordinates.length&&this.instructions.push(fr),this.reverseHitDetectionInstructions(),this.state=null,t.prototype.finish.call(this)},e.prototype.applyStroke=function(e){null!=e.lastStroke&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(fr),e.lastStroke=this.coordinates.length),e.lastStroke=0,t.prototype.applyStroke.call(this,e),this.instructions.push(pr)},e}(gr);function xr(t,e,i,n,o,r,s){var a=(i-e)/n;if(a<3){for(;e<i;e+=n)r[s++]=t[e],r[s++]=t[e+1];return s}var u=new Array(a);u[0]=1,u[a-1]=1;for(var l=[e,i-n],c=0;l.length>0;){for(var h=l.pop(),f=l.pop(),p=0,d=t[f],y=t[f+1],v=t[h],g=t[h+1],m=f+n;m<h;m+=n){var _=Di(t[m],t[m+1],d,y,v,g);_>p&&(c=m,p=_)}p>o&&(u[(c-e)/n]=1,f+n<c&&l.push(f,c),c+n<h&&l.push(c,h))}for(m=0;m<a;++m)u[m]&&(r[s++]=t[e+m*n],r[s++]=t[e+m*n+1]);return s}function Sr(t,e,i,n,o,r,s,a){for(var u=0,l=i.length;u<l;++u){var c=i[u];s=xr(t,e,c,n,o,r,s),a.push(s),e=c}return s}function Tr(t,e){return e*Math.round(t/e)}function Or(t,e,i,n,o,r,s){if(e==i)return s;var a,u,l=Tr(t[e],o),c=Tr(t[e+1],o);e+=n,r[s++]=l,r[s++]=c;do{if(a=Tr(t[e],o),u=Tr(t[e+1],o),(e+=n)==i)return r[s++]=a,r[s++]=u,s}while(a==l&&u==c);for(;e<i;){var h=Tr(t[e],o),f=Tr(t[e+1],o);if(e+=n,h!=a||f!=u){var p=a-l,d=u-c,y=h-l,v=f-c;p*v==d*y&&(p<0&&y<p||p==y||p>0&&y>p)&&(d<0&&v<d||d==v||d>0&&v>d)?(a=h,u=f):(r[s++]=a,r[s++]=u,l=a,c=u,a=h,u=f)}}return r[s++]=a,r[s++]=u,s}function Cr(t,e,i,n,o,r,s,a){for(var u=0,l=i.length;u<l;++u){var c=i[u];s=Or(t,e,c,n,o,r,s),a.push(s),e=c}return s}var Er=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Pr=function(t){function e(e,i,n,o){return t.call(this,e,i,n,o)||this}return Er(e,t),e.prototype.drawFlatCoordinatess_=function(t,e,i,n){var o=this.state,r=void 0!==o.fillStyle,s=void 0!==o.strokeStyle,a=i.length;this.instructions.push(pr),this.hitDetectionInstructions.push(pr);for(var u=0;u<a;++u){var l=i[u],c=this.coordinates.length,h=this.appendFlatCoordinates(t,e,l,n,!0,!s),f=[yr.MOVE_TO_LINE_TO,c,h];this.instructions.push(f),this.hitDetectionInstructions.push(f),s&&(this.instructions.push(dr),this.hitDetectionInstructions.push(dr)),e=l}return r&&(this.instructions.push(hr),this.hitDetectionInstructions.push(hr)),s&&(this.instructions.push(fr),this.hitDetectionInstructions.push(fr)),e},e.prototype.drawCircle=function(t,e){var i=this.state,n=i.fillStyle,o=i.strokeStyle;if(void 0!==n||void 0!==o){this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([yr.SET_FILL_STYLE,"#000"]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([yr.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);var r=t.getFlatCoordinates(),s=t.getStride(),a=this.coordinates.length;this.appendFlatCoordinates(r,0,r.length,s,!1,!1);var u=[yr.CIRCLE,a];this.instructions.push(pr,u),this.hitDetectionInstructions.push(pr,u),void 0!==i.fillStyle&&(this.instructions.push(hr),this.hitDetectionInstructions.push(hr)),void 0!==i.strokeStyle&&(this.instructions.push(fr),this.hitDetectionInstructions.push(fr)),this.endGeometry(e)}},e.prototype.drawPolygon=function(t,e){var i=this.state,n=i.fillStyle,o=i.strokeStyle;if(void 0!==n||void 0!==o){this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([yr.SET_FILL_STYLE,"#000"]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([yr.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);var r=t.getEnds(),s=t.getOrientedFlatCoordinates(),a=t.getStride();this.drawFlatCoordinatess_(s,0,r,a),this.endGeometry(e)}},e.prototype.drawMultiPolygon=function(t,e){var i=this.state,n=i.fillStyle,o=i.strokeStyle;if(void 0!==n||void 0!==o){this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([yr.SET_FILL_STYLE,"#000"]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([yr.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);for(var r=t.getEndss(),s=t.getOrientedFlatCoordinates(),a=t.getStride(),u=0,l=0,c=r.length;l<c;++l)u=this.drawFlatCoordinatess_(s,u,r[l],a);this.endGeometry(e)}},e.prototype.finish=function(){this.reverseHitDetectionInstructions(),this.state=null;var e=this.tolerance;if(0!==e)for(var i=this.coordinates,n=0,o=i.length;n<o;++n)i[n]=Tr(i[n],e);return t.prototype.finish.call(this)},e.prototype.setFillStrokeStyles_=function(){var t=this.state;void 0!==t.fillStyle&&this.updateFillStyle(t,this.createFill),void 0!==t.strokeStyle&&this.updateStrokeStyle(t,this.applyStroke)},e}(gr);function Rr(t,e,i,n,o){var r,s,a,u,l,c,h,f,p,d=i,y=i,v=0,g=0,m=i;for(r=i;r<n;r+=o){var _=e[r],b=e[r+1];void 0!==u&&(f=_-u,p=b-l,a=Math.sqrt(f*f+p*p),void 0!==c&&(g+=s,Math.acos((c*f+h*p)/(s*a))>t&&(g>v&&(v=g,d=m,y=r),g=0,m=r-o)),s=a,c=f,h=p),u=_,l=b}return(g+=a)>v?[m,r]:[d,y]}var Ir="line",kr=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),jr={left:0,end:0,center:.5,right:1,start:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1},Lr={Circle:Pr,Default:gr,Image:_r,LineString:wr,Polygon:Pr,Text:function(t){function e(e,i,n,o){var r=t.call(this,e,i,n,o)||this;return r.declutterGroups_,r.labels_=null,r.text_="",r.textOffsetX_=0,r.textOffsetY_=0,r.textRotateWithView_=void 0,r.textRotation_=0,r.textFillState_=null,r.fillStates={},r.textStrokeState_=null,r.strokeStates={},r.textState_={},r.textStates={},r.textKey_="",r.fillKey_="",r.strokeKey_="",r}return kr(e,t),e.prototype.finish=function(){var e=t.prototype.finish.call(this);return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e},e.prototype.drawText=function(t,e){var i=this.textFillState_,n=this.textStrokeState_,o=this.textState_;if(""!==this.text_&&o&&(i||n)){var r,s,a=this.coordinates.length,u=t.getType(),l=null,c=2,h=2;if(o.placement===Ir){if(!xi(this.getBufferedMaxExtent(),t.getExtent()))return;var f=void 0;if(l=t.getFlatCoordinates(),h=t.getStride(),u==tn)f=[l.length];else if(u==rn)f=t.getEnds();else if(u==nn)f=t.getEnds().slice(0,1);else if(u==sn){var p=t.getEndss();for(f=[],r=0,s=p.length;r<s;++r)f.push(p[r][0])}this.beginGeometry(t,e);for(var d=o.textAlign,y=0,v=void 0,g=0,m=f.length;g<m;++g){if(null==d){var _=Rr(o.maxAngle,l,y,f[g],h);y=_[0],v=_[1]}else v=f[g];for(r=y;r<v;r+=h)this.coordinates.push(l[r],l[r+1]);c=this.coordinates.length,y=f[g];var b=this.declutterGroups_?0===g?this.declutterGroups_[0]:[].concat(this.declutterGroups_[0]):null;this.drawChars_(a,c,b),a=c}this.endGeometry(e)}else{var w=null;switch(o.overflow||(w=[]),u){case $i:case on:c=(l=t.getFlatCoordinates()).length;break;case tn:l=t.getFlatMidpoint();break;case un:l=t.getCenter();break;case rn:c=(l=t.getFlatMidpoints()).length;break;case nn:l=t.getFlatInteriorPoint(),o.overflow||w.push(l[2]/this.resolution),h=3;break;case sn:var x=t.getFlatInteriorPoints();for(l=[],r=0,s=x.length;r<s;r+=3)o.overflow||w.push(x[r+2]/this.resolution),l.push(x[r],x[r+1]);if(0==(c=l.length))return}c=this.appendFlatCoordinates(l,0,c,h,!1,!1),this.saveTextStates_(),(o.backgroundFill||o.backgroundStroke)&&(this.setFillStrokeStyle(o.backgroundFill,o.backgroundStroke),o.backgroundFill&&(this.updateFillStyle(this.state,this.createFill),this.hitDetectionInstructions.push(this.createFill(this.state))),o.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e);var S=this.pixelRatio;this.instructions.push([yr.DRAW_IMAGE,a,c,null,NaN,NaN,this.declutterGroups_,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,1,NaN,o.padding==Yn?Yn:o.padding.map((function(t){return t*S})),!!o.backgroundFill,!!o.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,w]),this.hitDetectionInstructions.push([yr.DRAW_IMAGE,a,c,null,NaN,NaN,this.declutterGroups_,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,1/this.pixelRatio,NaN,o.padding,!!o.backgroundFill,!!o.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,w]),this.endGeometry(e)}}},e.prototype.saveTextStates_=function(){var t=this.textStrokeState_,e=this.textState_,i=this.textFillState_,n=this.strokeKey_;t&&(n in this.strokeStates||(this.strokeStates[n]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));var o=this.textKey_;o in this.textStates||(this.textStates[o]={font:e.font,textAlign:e.textAlign||"center",textBaseline:e.textBaseline||"middle",scale:e.scale});var r=this.fillKey_;i&&(r in this.fillStates||(this.fillStates[r]={fillStyle:i.fillStyle}))},e.prototype.drawChars_=function(t,e,i){var n=this.textStrokeState_,o=this.textState_,r=this.strokeKey_,s=this.textKey_,a=this.fillKey_;this.saveTextStates_();var u=this.pixelRatio,l=jr[o.textBaseline],c=this.textOffsetY_*u,h=this.text_,f=o.scale,p=n?n.lineWidth*f/2:0;this.instructions.push([yr.DRAW_CHARS,t,e,l,i,o.overflow,a,o.maxAngle,u,c,r,p*u,h,s,1]),this.hitDetectionInstructions.push([yr.DRAW_CHARS,t,e,l,i,o.overflow,a,o.maxAngle,1,c,r,p,h,s,1/u])},e.prototype.setTextStyle=function(t,e){var i,n,o;if(t){this.declutterGroups_=e;var r=t.getFill();r?((n=this.textFillState_)||(n={},this.textFillState_=n),n.fillStyle=mn(r.getColor()||"#000")):(n=null,this.textFillState_=n);var s=t.getStroke();if(s){(o=this.textStrokeState_)||(o={},this.textStrokeState_=o);var a=s.getLineDash(),u=s.getLineDashOffset(),l=s.getWidth(),c=s.getMiterLimit();o.lineCap=s.getLineCap()||"round",o.lineDash=a?a.slice():Bn,o.lineDashOffset=void 0===u?0:u,o.lineJoin=s.getLineJoin()||"round",o.lineWidth=void 0===l?1:l,o.miterLimit=void 0===c?10:c,o.strokeStyle=mn(s.getColor()||"#000")}else o=null,this.textStrokeState_=o;i=this.textState_;var h=t.getFont()||"10px sans-serif";Hn(h);var f=t.getScale();i.overflow=t.getOverflow(),i.font=h,i.maxAngle=t.getMaxAngle(),i.placement=t.getPlacement(),i.textAlign=t.getTextAlign(),i.textBaseline=t.getTextBaseline()||"middle",i.backgroundFill=t.getBackgroundFill(),i.backgroundStroke=t.getBackgroundStroke(),i.padding=t.getPadding()||Yn,i.scale=void 0===f?1:f;var p=t.getOffsetX(),d=t.getOffsetY(),y=t.getRotateWithView(),v=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=void 0===p?0:p,this.textOffsetY_=void 0===d?0:d,this.textRotateWithView_=void 0!==y&&y,this.textRotation_=void 0===v?0:v,this.strokeKey_=o?("string"==typeof o.strokeStyle?o.strokeStyle:$t(o.strokeStyle))+o.lineCap+o.lineDashOffset+"|"+o.lineWidth+o.lineJoin+o.miterLimit+"["+o.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.textBaseline||"?"),this.fillKey_=n?"string"==typeof n.fillStyle?n.fillStyle:"|"+$t(n.fillStyle):""}else this.text_=""},e}(gr)},Mr=function(){function t(t,e,i,n,o){this.declutter_=o,this.declutterGroups_=null,this.tolerance_=t,this.maxExtent_=e,this.pixelRatio_=n,this.resolution_=i,this.buildersByZIndex_={}}return t.prototype.addDeclutter=function(t){var e=null;return this.declutter_&&(t?(e=this.declutterGroups_)[0][4]++:(e=[[1/0,1/0,-1/0,-1/0]],this.declutterGroups_=e,e[0].push(1))),e},t.prototype.finish=function(){var t={};for(var e in this.buildersByZIndex_){t[e]=t[e]||{};var i=this.buildersByZIndex_[e];for(var n in i){var o=i[n].finish();t[e][n]=o}}return t},t.prototype.getBuilder=function(t,e){var i=void 0!==t?t.toString():"0",n=this.buildersByZIndex_[i];void 0===n&&(n={},this.buildersByZIndex_[i]=n);var o=n[e];void 0===o&&(o=new(0,Lr[e])(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),n[e]=o);return o},t}();function Fr(t,e,i,n,o,r){for(var s=r||[],a=0,u=e;u<i;u+=n){var l=t[u],c=t[u+1];s[a++]=o[0]*l+o[2]*c+o[4],s[a++]=o[1]*l+o[3]*c+o[5]}return r&&s.length!=a&&(s.length=a),s}var Dr="Circle",Ar="Default",Nr="Image",Gr="LineString",Br="Polygon",Yr="Text";function Xr(t,e,i,n){for(var o=t[e],r=t[e+1],s=0,a=e+n;a<i;a+=n){var u=t[a],l=t[a+1];s+=Math.sqrt((u-o)*(u-o)+(l-r)*(l-r)),o=u,r=l}return s}function zr(t,e,i,n,o,r,s,a,u,l,c){for(var h,f,p=[],d=t[e]>t[i-n],y=o.length,v=t[e],g=t[e+1],m=t[e+=n],_=t[e+1],b=0,w=Math.sqrt(Math.pow(m-v,2)+Math.pow(_-g,2)),x=!1,S=0;S<y;++S){for(var T=o[h=d?y-S-1:S],O=a*u(l,T,c),C=r+O/2;e<i-n&&b+w<C;)v=m,g=_,m=t[e+=n],_=t[e+1],b+=w,w=Math.sqrt(Math.pow(m-v,2)+Math.pow(_-g,2));var E=C-b,P=Math.atan2(_-g,m-v);if(d&&(P+=P>0?-Math.PI:Math.PI),void 0!==f){var R=P-f;if(x=x||0!==R,R+=R>Math.PI?-2*Math.PI:R<-Math.PI?2*Math.PI:0,Math.abs(R)>s)return null}f=P;var I=E/w,k=Bi(v,m,I),j=Bi(g,_,I);p[h]=[k,j,O/2,P,T],r+=O}return x?p:[[p[0][0],p[0][1],p[0][2],p[0][3],o]]}var Wr=i(2),Vr=i.n(Wr),Kr=[1/0,1/0,-1/0,-1/0],qr=[1,0,0,1,0,0],Hr=[],Zr=[],Ur=[],Jr=[],Qr=function(){function t(t,e,i,n){this.overlaps=i,this.pixelRatio=e,this.resolution=t,this.alignFill_,this.declutterItems=[],this.instructions=n.instructions,this.coordinates=n.coordinates,this.coordinateCache_={},this.renderedTransform_=[1,0,0,1,0,0],this.hitDetectionInstructions=n.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=n.fillStates||{},this.strokeStates=n.strokeStates||{},this.textStates=n.textStates||{},this.widths_={},this.labels_={}}return t.prototype.createLabel=function(t,e,i,n){var o=t+e+i+n;if(this.labels_[o])return this.labels_[o];var r=n?this.strokeStates[n]:null,s=i?this.fillStates[i]:null,a=this.textStates[e],u=this.pixelRatio,l=a.scale*u,c=jr[a.textAlign||"center"],h=n&&r.lineWidth?r.lineWidth:0,f=t.split("\n"),p=f.length,d=[],y=function(t,e,i){for(var n=e.length,o=0,r=0;r<n;++r){var s=Jn(t,e[r]);o=Math.max(o,s),i.push(s)}return o}(a.font,f,d),v=Zn(a.font),g=v*p,m=y+h,_=[],b={width:Math.ceil((m+2)*l),height:Math.ceil((g+h)*l),contextInstructions:_};(1!=l&&_.push("scale",[l,l]),_.push("font",a.font),n)&&(_.push("strokeStyle",r.strokeStyle),_.push("lineWidth",h),_.push("lineCap",r.lineCap),_.push("lineJoin",r.lineJoin),_.push("miterLimit",r.miterLimit),(bn?OffscreenCanvasRenderingContext2D:CanvasRenderingContext2D).prototype.setLineDash&&(_.push("setLineDash",[r.lineDash]),_.push("lineDashOffset",r.lineDashOffset)));i&&_.push("fillStyle",s.fillStyle),_.push("textBaseline","middle"),_.push("textAlign","center");var w,x=.5-c,S=c*m+x*h;if(n)for(w=0;w<p;++w)_.push("strokeText",[f[w],S+x*d[w],.5*(h+v)+w*v]);if(i)for(w=0;w<p;++w)_.push("fillText",[f[w],S+x*d[w],.5*(h+v)+w*v]);return this.labels_[o]=b,b},t.prototype.replayTextBackground_=function(t,e,i,n,o,r,s){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,i),t.lineTo.apply(t,n),t.lineTo.apply(t,o),t.lineTo.apply(t,e),r&&(this.alignFill_=r[2],this.fill_(t)),s&&(this.setStrokeStyle_(t,s),t.stroke())},t.prototype.replayImageOrLabel_=function(t,e,i,n,o,r,s,a,u,l,c,h,f,p,d,y,v,g){var m=v||g;e-=o*=f,i-=r*=f;var _=d+l>n.width?n.width-l:d,b=a+c>n.height?n.height-c:a,w=y[3]+_*f+y[1],x=y[0]+b*f+y[2],S=e-y[3],T=i-y[0];(m||0!==h)&&(Hr[0]=S,Jr[0]=S,Hr[1]=T,Zr[1]=T,Zr[0]=S+w,Ur[0]=Zr[0],Ur[1]=T+x,Jr[1]=Ur[1]);var O=null;if(0!==h){var C=e+o,E=i+r;O=An(qr,C,E,1,1,h,-C,-E),Fn(qr,Hr),Fn(qr,Zr),Fn(qr,Ur),Fn(qr,Jr),oi(Math.min(Hr[0],Zr[0],Ur[0],Jr[0]),Math.min(Hr[1],Zr[1],Ur[1],Jr[1]),Math.max(Hr[0],Zr[0],Ur[0],Jr[0]),Math.max(Hr[1],Zr[1],Ur[1],Jr[1]),Kr)}else oi(S,T,S+w,T+x,Kr);var P=t.canvas,R=g?g[2]*f/2:0,I=Kr[0]-R<=P.width&&Kr[2]+R>=0&&Kr[1]-R<=P.height&&Kr[3]+R>=0;if(p&&(e=Math.round(e),i=Math.round(i)),s){if(!I&&1==s[4])return;ui(s,Kr);var k=I?[t,O?O.slice(0):null,u,n,l,c,_,b,e,i,f]:null;k&&(m&&k.push(v,g,Hr.slice(0),Zr.slice(0),Ur.slice(0),Jr.slice(0)),s.push(k))}else I&&(m&&this.replayTextBackground_(t,Hr,Zr,Ur,Jr,v,g),to(t,O,u,n,l,c,_,b,e,i,f))},t.prototype.fill_=function(t){if(this.alignFill_){var e=Fn(this.renderedTransform_,[0,0]),i=512*this.pixelRatio;t.save(),t.translate(e[0]%i,e[1]%i),t.rotate(this.viewRotation_)}t.fill(),this.alignFill_&&t.restore()},t.prototype.setStrokeStyle_=function(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.setLineDash&&(t.lineDashOffset=e[7],t.setLineDash(e[6]))},t.prototype.renderDeclutter=function(t,e,i,n){if(t&&t.length>5){var o=t[4];if(1==o||o==t.length-5){var r={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};if(n||(n=new Vr.a(9)),!n.collides(r)){n.insert(r);for(var s=5,a=t.length;s<a;++s){var u=t[s],l=u[0],c=l.globalAlpha;c!==i&&(l.globalAlpha=i),u.length>11&&this.replayTextBackground_(u[0],u[13],u[14],u[15],u[16],u[11],u[12]),to.apply(void 0,u),c!==i&&(l.globalAlpha=c)}}t.length=5,ri(t)}}return n},t.prototype.drawLabelWithPointPlacement_=function(t,e,i,n){var o=this.textStates[e],r=this.createLabel(t,e,n,i),s=this.strokeStates[i],a=this.pixelRatio,u=jr[o.textAlign||"center"],l=jr[o.textBaseline||"middle"],c=s&&s.lineWidth?s.lineWidth:0;return{label:r,anchorX:u*(r.width/a-2*o.scale)+2*(.5-u)*c,anchorY:l*r.height/a+2*(.5-l)*c}},t.prototype.execute_=function(t,e,i,n,o,r){var s,a,u;this.declutterItems.length=0,this.pixelCoordinates_&&me(e,this.renderedTransform_)?s=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),s=Fr(this.coordinates,0,this.coordinates.length,2,e,this.pixelCoordinates_),a=this.renderedTransform_,u=e,a[0]=u[0],a[1]=u[1],a[2]=u[2],a[3]=u[3],a[4]=u[4],a[5]=u[5]);for(var l,c,h,f,p,d,y,v,g,m,_,b,w,x,S,T,O,C=0,E=i.length,P=0,R=0,I=0,k=null,j=null,L=this.coordinateCache_,M=this.viewRotation_,F=Math.round(1e12*Math.atan2(-e[1],e[0]))/1e12,D={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:M},A=this.instructions!=i||this.overlaps?0:200;C<E;){var N=i[C];switch(N[0]){case yr.BEGIN_GEOMETRY:(S=N[1]).getGeometry()?void 0===r||xi(r,N[3])?++C:C=N[2]+1:C=N[2];break;case yr.BEGIN_PATH:R>A&&(this.fill_(t),R=0),I>A&&(t.stroke(),I=0),R||I||(t.beginPath(),f=NaN,p=NaN),++C;break;case yr.CIRCLE:var G=s[P=N[1]],B=s[P+1],Y=s[P+2]-G,X=s[P+3]-B,z=Math.sqrt(Y*Y+X*X);t.moveTo(G+z,B),t.arc(G,B,z,0,2*Math.PI,!0),++C;break;case yr.CLOSE_PATH:t.closePath(),++C;break;case yr.CUSTOM:P=N[1],l=N[2];var W=N[3],V=N[4],K=6==N.length?N[5]:void 0;D.geometry=W,D.feature=S,C in L||(L[C]=[]);var q=L[C];K?K(s,P,l,2,q):(q[0]=s[P],q[1]=s[P+1],q.length=2),V(q,D),++C;break;case yr.DRAW_IMAGE:P=N[1],l=N[2],m=N[3],c=N[4],h=N[5],g=o?null:N[6];var H=N[7],Z=N[8],U=N[9],J=N[10],Q=N[11],$=N[12],tt=N[13],et=N[14];if(!m&&N.length>=19){_=N[18],b=N[19],w=N[20],x=N[21];var it=this.drawLabelWithPointPlacement_(_,b,w,x);m=it.label,N[3]=m;var nt=N[22];c=(it.anchorX-nt)*this.pixelRatio,N[4]=c;var ot=N[23];h=(it.anchorY-ot)*this.pixelRatio,N[5]=h,H=m.height,N[7]=H,et=m.width,N[14]=et}var rt=void 0;N.length>24&&(rt=N[24]);var st=void 0,at=void 0,ut=void 0;N.length>16?(st=N[15],at=N[16],ut=N[17]):(st=Yn,at=!1,ut=!1),Q&&F?$+=M:Q||F||($-=M);for(var lt=0,ct=0;P<l;P+=2)if(!(rt&&rt[lt++]<et/this.pixelRatio)){if(g){var ht=Math.floor(ct);g.length<ht+1&&((v=[1/0,1/0,-1/0,-1/0]).push(g[0][4]),g.push(v)),v=g[ht]}this.replayImageOrLabel_(t,s[P],s[P+1],m,c,h,v,H,Z,U,J,$,tt,n,et,st,at?k:null,ut?j:null),v&&(ct===Math.floor(ct)&&this.declutterItems.push(this,v,S),ct+=1/v[4])}++C;break;case yr.DRAW_CHARS:var ft=N[1],pt=N[2],dt=N[3];v=o?null:N[4];var yt=N[5];x=N[6];var vt=N[7],gt=N[8],mt=N[9];w=N[10];var _t=N[11];_=N[12],b=N[13];var bt=N[14],wt=this.textStates[b],xt=wt.font,St=wt.scale*gt,Tt=void 0;xt in this.widths_?Tt=this.widths_[xt]:(Tt={},this.widths_[xt]=Tt);var Ot=Xr(s,ft,pt,2),Ct=St*Qn(xt,_,Tt);if(yt||Ct<=Ot){var Et=this.textStates[b].textAlign,Pt=zr(s,ft,pt,2,_,(Ot-Ct)*jr[Et],vt,St,Qn,xt,Tt);if(Pt){var Rt=void 0,It=void 0,kt=void 0,jt=void 0,Lt=void 0;if(w)for(Rt=0,It=Pt.length;Rt<It;++Rt)kt=(Lt=Pt[Rt])[4],jt=this.createLabel(kt,b,"",w),c=Lt[2]+_t,h=dt*jt.height+2*(.5-dt)*_t-mt,this.replayImageOrLabel_(t,Lt[0],Lt[1],jt,c,h,v,jt.height,1,0,0,Lt[3],bt,!1,jt.width,Yn,null,null);if(x)for(Rt=0,It=Pt.length;Rt<It;++Rt)kt=(Lt=Pt[Rt])[4],jt=this.createLabel(kt,b,x,""),c=Lt[2],h=dt*jt.height-mt,this.replayImageOrLabel_(t,Lt[0],Lt[1],jt,c,h,v,jt.height,1,0,0,Lt[3],bt,!1,jt.width,Yn,null,null)}}this.declutterItems.push(this,v,S),++C;break;case yr.END_GEOMETRY:if(void 0!==o){var Mt=o(S=N[1]);if(Mt)return Mt}++C;break;case yr.FILL:A?R++:this.fill_(t),++C;break;case yr.MOVE_TO_LINE_TO:for(P=N[1],l=N[2],T=s[P],y=(O=s[P+1])+.5|0,(d=T+.5|0)===f&&y===p||(t.moveTo(T,O),f=d,p=y),P+=2;P<l;P+=2)d=(T=s[P])+.5|0,y=(O=s[P+1])+.5|0,P!=l-2&&d===f&&y===p||(t.lineTo(T,O),f=d,p=y);++C;break;case yr.SET_FILL_STYLE:k=N,this.alignFill_=N[2],R&&(this.fill_(t),R=0,I&&(t.stroke(),I=0)),t.fillStyle=N[1],++C;break;case yr.SET_STROKE_STYLE:j=N,I&&(t.stroke(),I=0),this.setStrokeStyle_(t,N),++C;break;case yr.STROKE:A?I++:t.stroke(),++C;break;default:++C}}R&&this.fill_(t),I&&t.stroke()},t.prototype.execute=function(t,e,i,n){this.viewRotation_=i,this.execute_(t,e,this.instructions,n,void 0,void 0)},t.prototype.executeHitDetection=function(t,e,i,n,o){return this.viewRotation_=i,this.execute_(t,e,this.hitDetectionInstructions,!0,n,o)},t}(),$r=[Br,Dr,Gr,Nr,Yr,Ar],ts=function(){function t(t,e,i,n,o,r){this.maxExtent_=t,this.overlaps_=n,this.pixelRatio_=i,this.resolution_=e,this.renderBuffer_=r,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=[1,0,0,1,0,0],this.createExecutors_(o)}return t.prototype.clip=function(t,e){var i=this.getClipCoords(e);t.beginPath(),t.moveTo(i[0],i[1]),t.lineTo(i[2],i[3]),t.lineTo(i[4],i[5]),t.lineTo(i[6],i[7]),t.clip()},t.prototype.createExecutors_=function(t){for(var e in t){var i=this.executorsByZIndex_[e];void 0===i&&(i={},this.executorsByZIndex_[e]=i);var n=t[e];for(var o in n){var r=n[o];i[o]=new Qr(this.resolution_,this.pixelRatio_,this.overlaps_,r)}}},t.prototype.hasExecutors=function(t){for(var e in this.executorsByZIndex_)for(var i=this.executorsByZIndex_[e],n=0,o=t.length;n<o;++n)if(t[n]in i)return!0;return!1},t.prototype.forEachFeatureAtCoordinate=function(t,e,i,n,o,r){var s=2*(n=Math.round(n))+1,a=An(this.hitDetectionTransform_,n+.5,n+.5,1/e,-1/e,-i,-t[0],-t[1]);this.hitDetectionContext_||(this.hitDetectionContext_=xn(s,s));var u,l=this.hitDetectionContext_;l.canvas.width!==s||l.canvas.height!==s?(l.canvas.width=s,l.canvas.height=s):l.clearRect(0,0,s,s),void 0!==this.renderBuffer_&&(li(u=[1/0,1/0,-1/0,-1/0],t),Je(u,e*(this.renderBuffer_+n),u));var c,h=function(t){if(void 0!==es[t])return es[t];for(var e=2*t+1,i=new Array(e),n=0;n<e;n++)i[n]=new Array(e);var o=t,r=0,s=0;for(;o>=r;)is(i,t+o,t+r),is(i,t+r,t+o),is(i,t-r,t+o),is(i,t-o,t+r),is(i,t-o,t-r),is(i,t-r,t-o),is(i,t+r,t-o),is(i,t+o,t-r),r++,2*((s+=1+2*r)-o)+1>0&&(s+=1-2*(o-=1));return es[t]=i,i}(n);function f(t){for(var e=l.getImageData(0,0,s,s).data,i=0;i<s;i++)for(var n=0;n<s;n++)if(h[i][n]&&e[4*(n*s+i)+3]>0){var a=void 0;return(!r||c!=Nr&&c!=Yr||-1!==r.indexOf(t))&&(a=o(t)),a||void l.clearRect(0,0,s,s)}}var p,d,y,v,g,m=Object.keys(this.executorsByZIndex_).map(Number);for(m.sort(de),p=m.length-1;p>=0;--p){var _=m[p].toString();for(y=this.executorsByZIndex_[_],d=$r.length-1;d>=0;--d)if(void 0!==(v=y[c=$r[d]])&&(g=v.executeHitDetection(l,a,i,f,u)))return g}},t.prototype.getClipCoords=function(t){var e=this.maxExtent_;if(!e)return null;var i=e[0],n=e[1],o=e[2],r=e[3],s=[i,n,i,r,o,r,o,n];return Fr(s,0,8,2,t,s),s},t.prototype.isEmpty=function(){return le(this.executorsByZIndex_)},t.prototype.execute=function(t,e,i,n,o,r){var s=Object.keys(this.executorsByZIndex_).map(Number);s.sort(de),this.maxExtent_&&(t.save(),this.clip(t,e));var a,u,l,c,h,f,p=o||$r;for(a=0,u=s.length;a<u;++a){var d=s[a].toString();for(h=this.executorsByZIndex_[d],l=0,c=p.length;l<c;++l){var y=p[l];if(void 0!==(f=h[y]))if(!r||y!=Nr&&y!=Yr)f.execute(t,e,i,n);else{var v=r[d];v?v.push(f,e.slice(0)):r[d]=[f,e.slice(0)]}}}this.maxExtent_&&t.restore()},t}(),es={0:[[!0]]};function is(t,e,i){var n,o=Math.floor(t.length/2);if(e>=o)for(n=o;n<e;n++)t[n][i]=!0;else if(e<o)for(n=e+1;n<o;n++)t[n][i]=!0}function ns(t,e,i,n,o,r){for(var s=Object.keys(t).map(Number).sort(de),a=0,u=s.length;a<u;++a)for(var l=t[s[a].toString()],c=void 0,h=0,f=l.length;h<f;){var p=l[h++];p!==c&&(c=p,r.push({items:p.declutterItems,opacity:n}));var d=l[h++];p.execute(e,d,i,o)}}var os=ts,rs=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ss=function(t){function e(e,i,n,o){var r=t.call(this,e)||this;return r.inversePixelTransform=i,r.frameState=n,r.context=o,r}return rs(e,t),e}(we),as=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),us=function(t){function e(e){var i=t.call(this)||this;return i.boundHandleImageChange_=i.handleImageChange_.bind(i),i.layer_=e,i}return as(e,t),e.prototype.getFeatures=function(t){return Jt()},e.prototype.prepareFrame=function(t){return Jt()},e.prototype.renderFrame=function(t,e){return Jt()},e.prototype.loadedTileCallback=function(t,e,i){t[e]||(t[e]={}),t[e][i.tileCoord.toString()]=i},e.prototype.createLoadedTileFinder=function(t,e,i){return function(n,o){var r=this.loadedTileCallback.bind(this,i,n);return t.forEachLoadedTile(e,n,o,r)}.bind(this)},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,n,o){},e.prototype.getDataAtPixel=function(t,e,i){return Jt()},e.prototype.getLayer=function(){return this.layer_},e.prototype.handleFontsChanged=function(){},e.prototype.handleImageChange_=function(t){t.target.getState()===On&&this.renderIfReadyAndVisible()},e.prototype.loadImage=function(t){var e=t.getState();return e!=On&&e!=Cn&&t.addEventListener(Te,this.boundHandleImageChange_),e==Sn&&(t.load(),e=t.getState()),e==On},e.prototype.renderIfReadyAndVisible=function(){var t=this.getLayer();t.getVisible()&&t.getSourceState()==Wi&&t.changed()},e}(Pe),ls=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),cs=function(t){function e(e){var i=t.call(this,e)||this;return i.container=null,i.renderedResolution,i.tempTransform_=[1,0,0,1,0,0],i.pixelTransform=[1,0,0,1,0,0],i.inversePixelTransform=[1,0,0,1,0,0],i.context=null,i.containerReused=!1,i}return ls(e,t),e.prototype.useContainer=function(t,e,i){var n,o,r=this.getLayer().getClassName();t&&""===t.style.opacity&&t.className===r&&((a=t.firstElementChild)instanceof HTMLCanvasElement&&(o=a.getContext("2d")));if(o&&o.canvas.style.transform===e?(this.container=t,this.context=o,this.containerReused=!0):this.containerReused&&(this.container=null,this.context=null,this.containerReused=!1),!this.container){(n=document.createElement("div")).className=r;var s=n.style;s.position="absolute",s.width="100%",s.height="100%";var a=(o=xn()).canvas;n.appendChild(a),(s=a.style).position="absolute",s.left="0",s.transformOrigin="top left",this.container=n,this.context=o}},e.prototype.clip=function(t,e,i){var n=e.pixelRatio,o=e.size[0]*n/2,r=e.size[1]*n/2,s=e.viewState.rotation,a=_i(i),u=bi(i),l=di(i),c=pi(i);Fn(e.coordinateToPixelTransform,a),Fn(e.coordinateToPixelTransform,u),Fn(e.coordinateToPixelTransform,l),Fn(e.coordinateToPixelTransform,c),t.save(),$n(t,-s,o,r),t.beginPath(),t.moveTo(a[0]*n,a[1]*n),t.lineTo(u[0]*n,u[1]*n),t.lineTo(l[0]*n,l[1]*n),t.lineTo(c[0]*n,c[1]*n),t.clip(),$n(t,s,o,r)},e.prototype.clipUnrotated=function(t,e,i){var n=_i(i),o=bi(i),r=di(i),s=pi(i);Fn(e.coordinateToPixelTransform,n),Fn(e.coordinateToPixelTransform,o),Fn(e.coordinateToPixelTransform,r),Fn(e.coordinateToPixelTransform,s);var a=this.inversePixelTransform;Fn(a,n),Fn(a,o),Fn(a,r),Fn(a,s),t.save(),t.beginPath(),t.moveTo(Math.round(n[0]),Math.round(n[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.lineTo(Math.round(r[0]),Math.round(r[1])),t.lineTo(Math.round(s[0]),Math.round(s[1])),t.clip()},e.prototype.dispatchRenderEvent_=function(t,e,i){var n=this.getLayer();if(n.hasListener(t)){var o=new ss(t,this.inversePixelTransform,i,e);n.dispatchEvent(o)}},e.prototype.preRender=function(t,e){this.dispatchRenderEvent_(Hi,t,e)},e.prototype.postRender=function(t,e){this.dispatchRenderEvent_(Zi,t,e)},e.prototype.getRenderTransform=function(t,e,i,n,o,r,s){var a=o/2,u=r/2,l=n/e,c=-l,h=-t[0]+s,f=-t[1];return An(this.tempTransform_,a,u,l,c,-i,h,f)},e.prototype.getDataAtPixel=function(t,e,i){var n,o=Fn(this.inversePixelTransform,t.slice()),r=this.context;try{n=r.getImageData(Math.round(o[0]),Math.round(o[1]),1,1).data}catch(t){return"SecurityError"===t.name?new Uint8Array:n}return 0===n[3]?null:n},e}(us),hs={Point:function(t,e,i,n){var o=i.getImage();if(o){if(o.getImageState()!=On)return;var r=t.getBuilder(i.getZIndex(),Nr);r.setImageStyle(o,t.addDeclutter(!1)),r.drawPoint(e,n)}var s=i.getText();if(s){var a=t.getBuilder(i.getZIndex(),Yr);a.setTextStyle(s,t.addDeclutter(!!o)),a.drawText(e,n)}},LineString:function(t,e,i,n){var o=i.getStroke();if(o){var r=t.getBuilder(i.getZIndex(),Gr);r.setFillStrokeStyle(null,o),r.drawLineString(e,n)}var s=i.getText();if(s){var a=t.getBuilder(i.getZIndex(),Yr);a.setTextStyle(s,t.addDeclutter(!1)),a.drawText(e,n)}},Polygon:function(t,e,i,n){var o=i.getFill(),r=i.getStroke();if(o||r){var s=t.getBuilder(i.getZIndex(),Br);s.setFillStrokeStyle(o,r),s.drawPolygon(e,n)}var a=i.getText();if(a){var u=t.getBuilder(i.getZIndex(),Yr);u.setTextStyle(a,t.addDeclutter(!1)),u.drawText(e,n)}},MultiPoint:function(t,e,i,n){var o=i.getImage();if(o){if(o.getImageState()!=On)return;var r=t.getBuilder(i.getZIndex(),Nr);r.setImageStyle(o,t.addDeclutter(!1)),r.drawMultiPoint(e,n)}var s=i.getText();if(s){var a=t.getBuilder(i.getZIndex(),Yr);a.setTextStyle(s,t.addDeclutter(!!o)),a.drawText(e,n)}},MultiLineString:function(t,e,i,n){var o=i.getStroke();if(o){var r=t.getBuilder(i.getZIndex(),Gr);r.setFillStrokeStyle(null,o),r.drawMultiLineString(e,n)}var s=i.getText();if(s){var a=t.getBuilder(i.getZIndex(),Yr);a.setTextStyle(s,t.addDeclutter(!1)),a.drawText(e,n)}},MultiPolygon:function(t,e,i,n){var o=i.getFill(),r=i.getStroke();if(r||o){var s=t.getBuilder(i.getZIndex(),Br);s.setFillStrokeStyle(o,r),s.drawMultiPolygon(e,n)}var a=i.getText();if(a){var u=t.getBuilder(i.getZIndex(),Yr);u.setTextStyle(a,t.addDeclutter(!1)),u.drawText(e,n)}},GeometryCollection:function(t,e,i,n){var o,r,s=e.getGeometriesArray();for(o=0,r=s.length;o<r;++o){(0,hs[s[o].getType()])(t,s[o],i,n)}},Circle:function(t,e,i,n){var o=i.getFill(),r=i.getStroke();if(o||r){var s=t.getBuilder(i.getZIndex(),Dr);s.setFillStrokeStyle(o,r),s.drawCircle(e,n)}var a=i.getText();if(a){var u=t.getBuilder(i.getZIndex(),Yr);u.setTextStyle(a,t.addDeclutter(!1)),u.drawText(e,n)}}};function fs(t,e){return parseInt($t(t),10)-parseInt($t(e),10)}function ps(t,e){var i=ds(t,e);return i*i}function ds(t,e){return.5*t/e}function ys(t,e,i,n,o,r){var s=!1,a=i.getImage();if(a){var u=a.getImageState();u==On||u==Cn?a.unlistenImageChange(o):(u==Sn&&a.load(),u=a.getImageState(),a.listenImageChange(o),s=!0)}return function(t,e,i,n,o){var r=i.getGeometryFunction()(e);if(!r)return;var s=r.simplifyTransformed(n,o);if(i.getRenderer())!function t(e,i,n,o){if(i.getType()==an){for(var r=i.getGeometries(),s=0,a=r.length;s<a;++s)t(e,r[s],n,o);return}e.getBuilder(n.getZIndex(),Ar).drawCustom(i,o,n.getRenderer())}(t,s,i,e);else{(0,hs[s.getType()])(t,s,i,e)}}(t,e,i,n,r),s}var vs=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),gs=[1,0,0,1,0,0],ms=function(t){function e(){var e,i,n,o,r,s=t.call(this)||this;return s.extent_=[1/0,1/0,-1/0,-1/0],s.extentRevision_=-1,s.simplifiedGeometryMaxMinSquaredTolerance=0,s.simplifiedGeometryRevision=0,s.simplifyTransformedInternal=(e=function(t,e,i){if(!i)return this.getSimplifiedGeometry(e);var n=this.clone();return n.applyTransform(i),n.getSimplifiedGeometry(e)},r=!1,function(){var t=Array.prototype.slice.call(arguments);return r&&this===o&&me(t,n)||(r=!0,o=this,n=t,i=e.apply(this,arguments)),i}),s}return vs(e,t),e.prototype.simplifyTransformed=function(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)},e.prototype.clone=function(){return Jt()},e.prototype.closestPointXY=function(t,e,i,n){return Jt()},e.prototype.containsXY=function(t,e){var i=this.getClosestPoint([t,e]);return i[0]===t&&i[1]===e},e.prototype.getClosestPoint=function(t,e){var i=e||[NaN,NaN];return this.closestPointXY(t[0],t[1],i,1/0),i},e.prototype.intersectsCoordinate=function(t){return this.containsXY(t[0],t[1])},e.prototype.computeExtent=function(t){return Jt()},e.prototype.getExtent=function(t){return this.extentRevision_!=this.getRevision()&&(this.extent_=this.computeExtent(this.extent_),this.extentRevision_=this.getRevision()),function(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}(this.extent_,t)},e.prototype.rotate=function(t,e){Jt()},e.prototype.scale=function(t,e,i){Jt()},e.prototype.simplify=function(t){return this.getSimplifiedGeometry(t*t)},e.prototype.getSimplifiedGeometry=function(t){return Jt()},e.prototype.getType=function(){return Jt()},e.prototype.applyTransform=function(t){Jt()},e.prototype.intersectsExtent=function(t){return Jt()},e.prototype.translate=function(t,e){Jt()},e.prototype.transform=function(t,e){var i=Ko(t),n=i.getUnits()==Oo.TILE_PIXELS?function(t,n,o){var r=i.getExtent(),s=i.getWorldExtent(),a=gi(s)/gi(r);return An(gs,s[0],s[3],a,-a,0,0,0),Fr(t,0,t.length,o,gs,n),Jo(i,e)(t,n,o)}:Jo(i,e);return this.applyTransform(n),this},e}(Me),_s="XY",bs="XYZ",ws="XYM",xs="XYZM",Ss=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();function Ts(t){var e;return t==_s?e=2:t==bs||t==ws?e=3:t==xs&&(e=4),e}var Os=function(t){function e(){var e=t.call(this)||this;return e.layout=_s,e.stride=2,e.flatCoordinates=null,e}return Ss(e,t),e.prototype.computeExtent=function(t){return si(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.getCoordinates=function(){return Jt()},e.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)},e.prototype.getFlatCoordinates=function(){return this.flatCoordinates},e.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)},e.prototype.getLayout=function(){return this.layout},e.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)},e.prototype.getSimplifiedGeometryInternal=function(t){return this},e.prototype.getStride=function(){return this.stride},e.prototype.setFlatCoordinates=function(t,e){this.stride=Ts(t),this.layout=t,this.flatCoordinates=e},e.prototype.setCoordinates=function(t,e){Jt()},e.prototype.setLayout=function(t,e,i){var n;if(t)n=Ts(t);else{for(var o=0;o<i;++o){if(0===e.length)return this.layout=_s,void(this.stride=2);e=e[0]}t=function(t){var e;2==t?e=_s:3==t?e=bs:4==t&&(e=xs);return e}(n=e.length)}this.layout=t,this.stride=n},e.prototype.applyTransform=function(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())},e.prototype.rotate=function(t,e){var i=this.getFlatCoordinates();if(i){var n=this.getStride();!function(t,e,i,n,o,r,s){for(var a=s||[],u=Math.cos(o),l=Math.sin(o),c=r[0],h=r[1],f=0,p=e;p<i;p+=n){var d=t[p]-c,y=t[p+1]-h;a[f++]=c+d*u-y*l,a[f++]=h+d*l+y*u;for(var v=p+2;v<p+n;++v)a[f++]=t[v]}s&&a.length!=f&&(a.length=f)}(i,0,i.length,n,t,e,i),this.changed()}},e.prototype.scale=function(t,e,i){var n=e;void 0===n&&(n=t);var o=i;o||(o=yi(this.getExtent()));var r=this.getFlatCoordinates();if(r){var s=this.getStride();!function(t,e,i,n,o,r,s,a){for(var u=a||[],l=s[0],c=s[1],h=0,f=e;f<i;f+=n){var p=t[f]-l,d=t[f+1]-c;u[h++]=l+o*p,u[h++]=c+r*d;for(var y=f+2;y<f+n;++y)u[h++]=t[y]}a&&u.length!=h&&(u.length=h)}(r,0,r.length,s,t,n,o,r),this.changed()}},e.prototype.translate=function(t,e){var i=this.getFlatCoordinates();if(i){var n=this.getStride();!function(t,e,i,n,o,r,s){for(var a=s||[],u=0,l=e;l<i;l+=n){a[u++]=t[l]+o,a[u++]=t[l+1]+r;for(var c=l+2;c<l+n;++c)a[u++]=t[c]}s&&a.length!=u&&(a.length=u)}(i,0,i.length,n,t,e,i),this.changed()}},e}(ms),Cs=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Es=function(t){function e(e,i,n,o,r,s,a){var u=t.call(this)||this;return u.context_=e,u.pixelRatio_=i,u.extent_=n,u.transform_=o,u.viewRotation_=r,u.squaredTolerance_=s,u.userTransform_=a,u.contextFillState_=null,u.contextStrokeState_=null,u.contextTextState_=null,u.fillState_=null,u.strokeState_=null,u.image_=null,u.imageAnchorX_=0,u.imageAnchorY_=0,u.imageHeight_=0,u.imageOpacity_=0,u.imageOriginX_=0,u.imageOriginY_=0,u.imageRotateWithView_=!1,u.imageRotation_=0,u.imageScale_=0,u.imageWidth_=0,u.text_="",u.textOffsetX_=0,u.textOffsetY_=0,u.textRotateWithView_=!1,u.textRotation_=0,u.textScale_=0,u.textFillState_=null,u.textStrokeState_=null,u.textState_=null,u.pixelCoordinates_=[],u.tmpLocalTransform_=[1,0,0,1,0,0],u}return Cs(e,t),e.prototype.drawImages_=function(t,e,i,n){if(this.image_){var o=Fr(t,e,i,2,this.transform_,this.pixelCoordinates_),r=this.context_,s=this.tmpLocalTransform_,a=r.globalAlpha;1!=this.imageOpacity_&&(r.globalAlpha=a*this.imageOpacity_);var u=this.imageRotation_;this.imageRotateWithView_&&(u+=this.viewRotation_);for(var l=0,c=o.length;l<c;l+=2){var h=o[l]-this.imageAnchorX_,f=o[l+1]-this.imageAnchorY_;if(0!==u||1!=this.imageScale_){var p=h+this.imageAnchorX_,d=f+this.imageAnchorY_;An(s,p,d,this.imageScale_,this.imageScale_,u,-p,-d),r.setTransform.apply(r,s)}r.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,h,f,this.imageWidth_,this.imageHeight_)}0===u&&1==this.imageScale_||r.setTransform(1,0,0,1,0,0),1!=this.imageOpacity_&&(r.globalAlpha=a)}},e.prototype.drawText_=function(t,e,i,n){if(this.textState_&&""!==this.text_){this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);var o=Fr(t,e,i,n,this.transform_,this.pixelCoordinates_),r=this.context_,s=this.textRotation_;for(this.textRotateWithView_&&(s+=this.viewRotation_);e<i;e+=n){var a=o[e]+this.textOffsetX_,u=o[e+1]+this.textOffsetY_;if(0!==s||1!=this.textScale_){var l=An(this.tmpLocalTransform_,a,u,this.textScale_,this.textScale_,s,-a,-u);r.setTransform.apply(r,l)}this.textStrokeState_&&r.strokeText(this.text_,a,u),this.textFillState_&&r.fillText(this.text_,a,u)}0===s&&1==this.textScale_||r.setTransform(1,0,0,1,0,0)}},e.prototype.moveToLineTo_=function(t,e,i,n,o){var r=this.context_,s=Fr(t,e,i,n,this.transform_,this.pixelCoordinates_);r.moveTo(s[0],s[1]);var a=s.length;o&&(a-=2);for(var u=2;u<a;u+=2)r.lineTo(s[u],s[u+1]);return o&&r.closePath(),i},e.prototype.drawRings_=function(t,e,i,n){for(var o=0,r=i.length;o<r;++o)e=this.moveToLineTo_(t,e,i[o],n,!0);return e},e.prototype.drawCircle=function(t){if(xi(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=function(t,e,i){var n=t.getFlatCoordinates();if(n){var o=t.getStride();return Fr(n,0,n.length,o,e,i)}return null}(t,this.transform_,this.pixelCoordinates_),i=e[2]-e[0],n=e[3]-e[1],o=Math.sqrt(i*i+n*n),r=this.context_;r.beginPath(),r.arc(e[0],e[1],o,0,2*Math.PI),this.fillState_&&r.fill(),this.strokeState_&&r.stroke()}""!==this.text_&&this.drawText_(t.getCenter(),0,2,2)}},e.prototype.setStyle=function(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())},e.prototype.setTransform=function(t){this.transform_=t},e.prototype.drawGeometry=function(t){switch(t.getType()){case $i:this.drawPoint(t);break;case tn:this.drawLineString(t);break;case nn:this.drawPolygon(t);break;case on:this.drawMultiPoint(t);break;case rn:this.drawMultiLineString(t);break;case sn:this.drawMultiPolygon(t);break;case an:this.drawGeometryCollection(t);break;case un:this.drawCircle(t)}},e.prototype.drawFeature=function(t,e){var i=e.getGeometryFunction()(t);i&&xi(this.extent_,i.getExtent())&&(this.setStyle(e),this.drawGeometry(i))},e.prototype.drawGeometryCollection=function(t){for(var e=t.getGeometriesArray(),i=0,n=e.length;i<n;++i)this.drawGeometry(e[i])},e.prototype.drawPoint=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)},e.prototype.drawMultiPoint=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)},e.prototype.drawLineString=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),xi(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var e=this.context_,i=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(i,0,i.length,t.getStride(),!1),e.stroke()}if(""!==this.text_){var n=t.getFlatMidpoint();this.drawText_(n,0,2,2)}}},e.prototype.drawMultiLineString=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getExtent();if(xi(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var i=this.context_,n=t.getFlatCoordinates(),o=0,r=t.getEnds(),s=t.getStride();i.beginPath();for(var a=0,u=r.length;a<u;++a)o=this.moveToLineTo_(n,o,r[a],s,!1);i.stroke()}if(""!==this.text_){var l=t.getFlatMidpoints();this.drawText_(l,0,l.length,2)}}},e.prototype.drawPolygon=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),xi(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){var i=t.getFlatInteriorPoint();this.drawText_(i,0,2,2)}}},e.prototype.drawMultiPolygon=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),xi(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=this.context_,i=t.getOrientedFlatCoordinates(),n=0,o=t.getEndss(),r=t.getStride();e.beginPath();for(var s=0,a=o.length;s<a;++s){var u=o[s];n=this.drawRings_(i,n,u,r)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){var l=t.getFlatInteriorPoints();this.drawText_(l,0,l.length,2)}}},e.prototype.setContextFillState_=function(t){var e=this.context_,i=this.contextFillState_;i?i.fillStyle!=t.fillStyle&&(i.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})},e.prototype.setContextStrokeState_=function(t){var e=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=t.lineCap&&(i.lineCap=t.lineCap,e.lineCap=t.lineCap),e.setLineDash&&(me(i.lineDash,t.lineDash)||e.setLineDash(i.lineDash=t.lineDash),i.lineDashOffset!=t.lineDashOffset&&(i.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset)),i.lineJoin!=t.lineJoin&&(i.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),i.lineWidth!=t.lineWidth&&(i.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),i.miterLimit!=t.miterLimit&&(i.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),i.strokeStyle!=t.strokeStyle&&(i.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})},e.prototype.setContextTextState_=function(t){var e=this.context_,i=this.contextTextState_,n=t.textAlign?t.textAlign:"center";i?(i.font!=t.font&&(i.font=t.font,e.font=t.font),i.textAlign!=n&&(i.textAlign=n,e.textAlign=n),i.textBaseline!=t.textBaseline&&(i.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=n,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:n,textBaseline:t.textBaseline})},e.prototype.setFillStrokeStyle=function(t,e){if(t){var i=t.getColor();this.fillState_={fillStyle:mn(i||"#000")}}else this.fillState_=null;if(e){var n=e.getColor(),o=e.getLineCap(),r=e.getLineDash(),s=e.getLineDashOffset(),a=e.getLineJoin(),u=e.getWidth(),l=e.getMiterLimit();this.strokeState_={lineCap:void 0!==o?o:"round",lineDash:r||Bn,lineDashOffset:s||0,lineJoin:void 0!==a?a:"round",lineWidth:this.pixelRatio_*(void 0!==u?u:1),miterLimit:void 0!==l?l:10,strokeStyle:mn(n||"#000")}}else this.strokeState_=null},e.prototype.setImageStyle=function(t){if(t){var e=t.getAnchor(),i=t.getImage(1),n=t.getOrigin(),o=t.getSize();this.imageAnchorX_=e[0],this.imageAnchorY_=e[1],this.imageHeight_=o[1],this.image_=i,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=n[0],this.imageOriginY_=n[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation(),this.imageScale_=t.getScale()*this.pixelRatio_,this.imageWidth_=o[0]}else this.image_=null},e.prototype.setTextStyle=function(t){if(t){var e=t.getFill();if(e){var i=e.getColor();this.textFillState_={fillStyle:mn(i||"#000")}}else this.textFillState_=null;var n=t.getStroke();if(n){var o=n.getColor(),r=n.getLineCap(),s=n.getLineDash(),a=n.getLineDashOffset(),u=n.getLineJoin(),l=n.getWidth(),c=n.getMiterLimit();this.textStrokeState_={lineCap:void 0!==r?r:"round",lineDash:s||Bn,lineDashOffset:a||0,lineJoin:void 0!==u?u:"round",lineWidth:void 0!==l?l:1,miterLimit:void 0!==c?c:10,strokeStyle:mn(o||"#000")}}else this.textStrokeState_=null;var h=t.getFont(),f=t.getOffsetX(),p=t.getOffsetY(),d=t.getRotateWithView(),y=t.getRotation(),v=t.getScale(),g=t.getText(),m=t.getTextAlign(),_=t.getTextBaseline();this.textState_={font:void 0!==h?h:"10px sans-serif",textAlign:void 0!==m?m:"center",textBaseline:void 0!==_?_:"middle"},this.text_=void 0!==g?g:"",this.textOffsetX_=void 0!==f?this.pixelRatio_*f:0,this.textOffsetY_=void 0!==p?this.pixelRatio_*p:0,this.textRotateWithView_=void 0!==d&&d,this.textRotation_=void 0!==y?y:0,this.textScale_=this.pixelRatio_*(void 0!==v?v:1)}else this.text_=""},e}(lr),Ps="fraction",Rs="pixels",Is=function(){function t(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}return t.prototype.clear=function(){this.cache_={},this.cacheSize_=0},t.prototype.canExpireCache=function(){return this.cacheSize_>this.maxCacheSize_},t.prototype.expire=function(){if(this.canExpireCache()){var t=0;for(var e in this.cache_){var i=this.cache_[e];0!=(3&t++)||i.hasListener()||(delete this.cache_[e],--this.cacheSize_)}}},t.prototype.get=function(t,e,i){var n=ks(t,e,i);return n in this.cache_?this.cache_[n]:null},t.prototype.set=function(t,e,i,n){var o=ks(t,e,i);this.cache_[o]=n,++this.cacheSize_},t.prototype.setSize=function(t){this.maxCacheSize_=t,this.expire()},t}();function ks(t,e,i){return e+":"+t+":"+(i?function(t){return"string"==typeof t?t:gn(t)}(i):"null")}var js=new Is,Ls=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ms=function(t){function e(e,i,n,o){var r=t.call(this)||this;return r.extent=e,r.pixelRatio_=n,r.resolution=i,r.state=o,r}return Ls(e,t),e.prototype.changed=function(){this.dispatchEvent(Te)},e.prototype.getExtent=function(){return this.extent},e.prototype.getImage=function(){return Jt()},e.prototype.getPixelRatio=function(){return this.pixelRatio_},e.prototype.getResolution=function(){return this.resolution},e.prototype.getState=function(){return this.state},e.prototype.load=function(){Jt()},e}(Se),Fs=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();function Ds(t,e,i){var n=t;if(n.src&&wn){var o=n.decode(),r=!0;return o.then((function(){r&&e()})).catch((function(t){r&&("EncodingError"===t.name&&"Invalid image type."===t.message?e():i())})),function(){r=!1}}var s=[he(n,Ce,e),he(n,Oe,i)];return function(){s.forEach(fe)}}var As=function(t){function e(e,i,n,o,r,s){var a=t.call(this,e,i,n,Sn)||this;return a.src_=o,a.image_=new Image,null!==r&&(a.image_.crossOrigin=r),a.unlisten_=null,a.state=Sn,a.imageLoadFunction_=s,a}return Fs(e,t),e.prototype.getImage=function(){return this.image_},e.prototype.handleImageError_=function(){this.state=Cn,this.unlistenImage_(),this.changed()},e.prototype.handleImageLoad_=function(){void 0===this.resolution&&(this.resolution=gi(this.extent)/this.image_.height),this.state=On,this.unlistenImage_(),this.changed()},e.prototype.load=function(){this.state!=Sn&&this.state!=Cn||(this.state=Tn,this.changed(),this.imageLoadFunction_(this,this.src_),this.unlisten_=Ds(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))},e.prototype.setImage=function(t){this.image_=t},e.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},e}(Ms),Ns=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Gs=function(t){function e(e,i,n,o,r,s){var a=t.call(this)||this;return a.hitDetectionImage_=null,a.image_=e||new Image,null!==o&&(a.image_.crossOrigin=o),a.canvas_=s?document.createElement("canvas"):null,a.color_=s,a.unlisten_=null,a.imageState_=r,a.size_=n,a.src_=i,a.tainted_,a}return Ns(e,t),e.prototype.isTainted_=function(t){if(void 0===this.tainted_&&this.imageState_===On){t||(t=xn(1,1)).drawImage(this.image_,0,0);try{t.getImageData(0,0,1,1),this.tainted_=!1}catch(t){this.tainted_=!0}}return!0===this.tainted_},e.prototype.dispatchChangeEvent_=function(){this.dispatchEvent(Te)},e.prototype.handleImageError_=function(){this.imageState_=Cn,this.unlistenImage_(),this.dispatchChangeEvent_()},e.prototype.handleImageLoad_=function(){this.imageState_=On,this.size_&&(this.image_.width=this.size_[0],this.image_.height=this.size_[1]),this.size_=[this.image_.width,this.image_.height],this.unlistenImage_(),this.replaceColor_(),this.dispatchChangeEvent_()},e.prototype.getImage=function(t){return this.canvas_?this.canvas_:this.image_},e.prototype.getImageState=function(){return this.imageState_},e.prototype.getHitDetectionImage=function(t){if(!this.hitDetectionImage_)if(this.isTainted_()){var e=this.size_[0],i=this.size_[1],n=xn(e,i);n.fillRect(0,0,e,i),this.hitDetectionImage_=n.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_},e.prototype.getSize=function(){return this.size_},e.prototype.getSrc=function(){return this.src_},e.prototype.load=function(){if(this.imageState_==Sn){this.imageState_=Tn;try{this.image_.src=this.src_}catch(t){this.handleImageError_()}this.unlisten_=Ds(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this))}},e.prototype.replaceColor_=function(){if(this.color_){this.canvas_.width=this.image_.width,this.canvas_.height=this.image_.height;var t=this.canvas_.getContext("2d");if(t.drawImage(this.image_,0,0),this.isTainted_(t)){var e=this.color_;return t.globalCompositeOperation="multiply",t.fillStyle="rgb("+e[0]+","+e[1]+","+e[2]+")",t.fillRect(0,0,this.image_.width,this.image_.height),t.globalCompositeOperation="destination-in",void t.drawImage(this.image_,0,0)}for(var i=t.getImageData(0,0,this.image_.width,this.image_.height),n=i.data,o=this.color_[0]/255,r=this.color_[1]/255,s=this.color_[2]/255,a=0,u=n.length;a<u;a+=4)n[a]*=o,n[a+1]*=r,n[a+2]*=s;t.putImageData(i,0,0)}},e.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},e}(Se);var Bs="bottom-left",Ys="bottom-right",Xs="top-left",zs="top-right",Ws=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Vs=function(t){function e(e){var i=this,n=e||{},o=void 0!==n.opacity?n.opacity:1,r=void 0!==n.rotation?n.rotation:0,s=void 0!==n.scale?n.scale:1,a=void 0!==n.rotateWithView&&n.rotateWithView;(i=t.call(this,{opacity:o,rotation:r,scale:s,displacement:void 0!==n.displacement?n.displacement:[0,0],rotateWithView:a})||this).anchor_=void 0!==n.anchor?n.anchor:[.5,.5],i.normalizedAnchor_=null,i.anchorOrigin_=void 0!==n.anchorOrigin?n.anchorOrigin:Xs,i.anchorXUnits_=void 0!==n.anchorXUnits?n.anchorXUnits:Ps,i.anchorYUnits_=void 0!==n.anchorYUnits?n.anchorYUnits:Ps,i.crossOrigin_=void 0!==n.crossOrigin?n.crossOrigin:null;var u=void 0!==n.img?n.img:null,l=void 0!==n.imgSize?n.imgSize:null,c=n.src;Ge(!(void 0!==c&&u),4),Ge(!u||u&&l,5),void 0!==c&&0!==c.length||!u||(c=u.src||$t(u)),Ge(void 0!==c&&c.length>0,6);var h=void 0!==n.src?Sn:On;return i.color_=void 0!==n.color?yn(n.color):null,i.iconImage_=function(t,e,i,n,o,r){var s=js.get(e,n,r);return s||(s=new Gs(t,e,i,n,o,r),js.set(e,n,r,s)),s}(u,c,l,i.crossOrigin_,h,i.color_),i.offset_=void 0!==n.offset?n.offset:[0,0],i.offsetOrigin_=void 0!==n.offsetOrigin?n.offsetOrigin:Xs,i.origin_=null,i.size_=void 0!==n.size?n.size:null,i}return Ws(e,t),e.prototype.clone=function(){return new e({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,crossOrigin:this.crossOrigin_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,src:this.getSrc(),offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,size:null!==this.size_?this.size_.slice():void 0,opacity:this.getOpacity(),scale:this.getScale(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView()})},e.prototype.getAnchor=function(){if(this.normalizedAnchor_)return this.normalizedAnchor_;var t=this.anchor_,e=this.getSize();if(this.anchorXUnits_==Ps||this.anchorYUnits_==Ps){if(!e)return null;t=this.anchor_.slice(),this.anchorXUnits_==Ps&&(t[0]*=e[0]),this.anchorYUnits_==Ps&&(t[1]*=e[1])}if(this.anchorOrigin_!=Xs){if(!e)return null;t===this.anchor_&&(t=this.anchor_.slice()),this.anchorOrigin_!=zs&&this.anchorOrigin_!=Ys||(t[0]=-t[0]+e[0]),this.anchorOrigin_!=Bs&&this.anchorOrigin_!=Ys||(t[1]=-t[1]+e[1])}return this.normalizedAnchor_=t,this.normalizedAnchor_},e.prototype.setAnchor=function(t){this.anchor_=t,this.normalizedAnchor_=null},e.prototype.getColor=function(){return this.color_},e.prototype.getImage=function(t){return this.iconImage_.getImage(t)},e.prototype.getImageSize=function(){return this.iconImage_.getSize()},e.prototype.getHitDetectionImageSize=function(){return this.getImageSize()},e.prototype.getImageState=function(){return this.iconImage_.getImageState()},e.prototype.getHitDetectionImage=function(t){return this.iconImage_.getHitDetectionImage(t)},e.prototype.getOrigin=function(){if(this.origin_)return this.origin_;var t=this.offset_,e=this.getDisplacement();if(this.offsetOrigin_!=Xs){var i=this.getSize(),n=this.iconImage_.getSize();if(!i||!n)return null;t=t.slice(),this.offsetOrigin_!=zs&&this.offsetOrigin_!=Ys||(t[0]=n[0]-i[0]-t[0]),this.offsetOrigin_!=Bs&&this.offsetOrigin_!=Ys||(t[1]=n[1]-i[1]-t[1])}return t[0]+=e[0],t[1]+=e[1],this.origin_=t,this.origin_},e.prototype.getSrc=function(){return this.iconImage_.getSrc()},e.prototype.getSize=function(){return this.size_?this.size_:this.iconImage_.getSize()},e.prototype.listenImageChange=function(t){this.iconImage_.addEventListener(Te,t)},e.prototype.load=function(){this.iconImage_.load()},e.prototype.unlistenImageChange=function(t){this.iconImage_.removeEventListener(Te,t)},e}(no);function Ks(t,e,i,n,o,r,s){var a=xn(t[0]/2,t[1]/2);a.imageSmoothingEnabled=!1;for(var u=a.canvas,l=new Es(a,.5,o,null,s),c=i.length,h=Math.floor(16777215/c),f={},p=1;p<=c;++p){var d=i[p-1],y=d.getStyleFunction()||n;if(n){var v=y(d,r);if(v){Array.isArray(v)||(v=[v]);for(var g="#"+("000000"+(p*h).toString(16)).slice(-6),m=0,_=v.length;m<_;++m){var b=v[m],w=b.clone(),x=w.getFill();x&&x.setColor(g);var S=w.getStroke();S&&S.setColor(g),w.setText(void 0);var T=b.getImage();if(T){var O=T.getImageSize();if(!O)continue;var C=document.createElement("canvas");C.width=O[0],C.height=O[1];var E=C.getContext("2d",{alpha:!1});E.fillStyle=g;var P=E.canvas;E.fillRect(0,0,P.width,P.height),xn(O?O[0]:P.width,O?O[1]:P.height).drawImage(P,0,0),w.setImage(new Vs({img:P,imgSize:O,anchor:T.getAnchor(),anchorXUnits:Rs,anchorYUnits:Rs,offset:T.getOrigin(),size:T.getSize(),opacity:T.getOpacity(),scale:T.getScale(),rotation:T.getRotation(),rotateWithView:T.getRotateWithView()}))}var R=Number(w.getZIndex());(L=f[R])||(L={},f[R]=L,L[nn]=[],L[un]=[],L[tn]=[],L[$i]=[]);var I=w.getGeometryFunction()(d);I&&xi(o,I.getExtent())&&L[I.getType().replace("Multi","")].push(I,w)}}}}for(var k=Object.keys(f).map(Number).sort(de),j=(p=0,k.length);p<j;++p){var L=f[k[p]];for(var M in L){var F=L[M];for(m=0,_=F.length;m<_;m+=2){l.setStyle(F[m+1]);for(var D=0,A=e.length;D<A;++D)l.setTransform(e[D]),l.drawGeometry(F[m])}}}return document.body.appendChild(a.canvas),a.getImageData(0,0,u.width,u.height)}function qs(t,e,i){var n=[];if(i){var o=4*(Math.round(t[0]/2)+Math.round(t[1]/2)*i.width),r=i.data[o],s=i.data[o+1],a=i.data[o+2]+256*(s+256*r),u=Math.floor(16777215/e.length);a&&a%u==0&&n.push(e[a/u-1])}return n}var Hs=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Zs=function(t){function e(e){var i=t.call(this,e)||this;return i.boundHandleStyleImageChange_=i.handleStyleImageChange_.bind(i),i.animatingOrInteracting_,i.dirty_=!1,i.hitDetectionImageData_=null,i.renderedFeatures_=null,i.renderedRevision_=-1,i.renderedResolution_=NaN,i.renderedExtent_=[1/0,1/0,-1/0,-1/0],i.renderedRotation_,i.renderedCenter_=null,i.renderedProjection_=null,i.renderedRenderOrder_=null,i.replayGroup_=null,i.replayGroupChanged=!0,i}return Hs(e,t),e.prototype.useContainer=function(e,i,n){n<1&&(e=null),t.prototype.useContainer.call(this,e,i,n)},e.prototype.renderFrame=function(t,e){var i=t.pixelRatio,n=t.layerStatesArray[t.layerIndex];!function(t,e,i){Mn(t,e,0,0,i,0,0)}(this.pixelTransform,1/i,1/i),Nn(this.inversePixelTransform,this.pixelTransform);var o=Gn(this.pixelTransform);this.useContainer(e,o,n.opacity);var r=this.context,s=r.canvas,a=this.replayGroup_;if(!a||a.isEmpty())return!this.containerReused&&s.width>0&&(s.width=0),this.container;var u=Math.round(t.size[0]*i),l=Math.round(t.size[1]*i);s.width!=u||s.height!=l?(s.width=u,s.height=l,s.style.transform!==o&&(s.style.transform=o)):this.containerReused||r.clearRect(0,0,u,l),this.preRender(r,t);var c=t.extent,h=t.viewState,f=h.center,p=h.resolution,d=h.projection,y=h.rotation,v=d.getExtent(),g=this.getLayer().getSource(),m=!1;if(n.extent){var _=rr(n.extent,d);(m=!ti(_,t.extent)&&xi(_,t.extent))&&this.clip(r,t,_)}var b=t.viewHints,w=!(b[_o]||b[bo]),x=this.getRenderTransform(f,p,y,i,u,l,0),S=this.getLayer().getDeclutter()?{}:null;if(a.execute(r,x,y,w,void 0,S),g.getWrapX()&&d.canWrapX()&&!ti(v,c)){for(var T=c[0],O=wi(v),C=0,E=void 0;T<v[0];){E=O*--C;var P=this.getRenderTransform(f,p,y,i,u,l,E);a.execute(r,P,y,w,void 0,S),T+=O}for(C=0,T=c[2];T>v[2];){E=O*++C;var R=this.getRenderTransform(f,p,y,i,u,l,E);a.execute(r,R,y,w,void 0,S),T-=O}}if(S){var I=t.viewHints;ns(S,r,y,1,!(I[_o]||I[bo]),t.declutterItems)}m&&r.restore(),this.postRender(r,t);var k=n.opacity,j=this.container;return k!==parseFloat(j.style.opacity)&&(j.style.opacity=1===k?"":k),this.container},e.prototype.getFeatures=function(t){return new Promise(function(e,i){if(!this.hitDetectionImageData_&&!this.animatingOrInteracting_){var n=[this.context.canvas.width,this.context.canvas.height];Fn(this.pixelTransform,n);var o=this.renderedCenter_,r=this.renderedResolution_,s=this.renderedRotation_,a=this.renderedProjection_,u=this.renderedExtent_,l=this.getLayer(),c=[],h=n[0]/2,f=n[1]/2;c.push(this.getRenderTransform(o,r,s,.5,h,f,0).slice());var p=l.getSource(),d=a.getExtent();if(p.getWrapX()&&a.canWrapX()&&!ti(d,u)){for(var y=u[0],v=wi(d),g=0,m=void 0;y<d[0];)m=v*--g,c.push(this.getRenderTransform(o,r,s,.5,h,f,m).slice()),y+=v;for(g=0,y=u[2];y>d[2];)m=v*++g,c.push(this.getRenderTransform(o,r,s,.5,h,f,m).slice()),y-=v}this.hitDetectionImageData_=Ks(n,c,this.renderedFeatures_,l.getStyleFunction(),u,r,s)}e(qs(t,this.renderedFeatures_,this.hitDetectionImageData_))}.bind(this))},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,n,o){if(this.replayGroup_){var r=e.viewState.resolution,s=e.viewState.rotation,a=this.getLayer(),u={};return this.replayGroup_.forEachFeatureAtCoordinate(t,r,s,i,(function(t){var e=$t(t);if(!(e in u))return u[e]=!0,n(t,a)}),a.getDeclutter()?o:null)}},e.prototype.handleFontsChanged=function(){var t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()},e.prototype.handleStyleImageChange_=function(t){this.renderIfReadyAndVisible()},e.prototype.prepareFrame=function(t){var e=this.getLayer(),i=e.getSource();if(!i)return!1;var n=t.viewHints[_o],o=t.viewHints[bo],r=e.getUpdateWhileAnimating(),s=e.getUpdateWhileInteracting();if(!this.dirty_&&!r&&n||!s&&o)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;var a=t.extent,u=t.viewState,l=u.projection,c=u.resolution,h=t.pixelRatio,f=e.getRevision(),p=e.getRenderBuffer(),d=e.getRenderOrder();void 0===d&&(d=fs);var y=u.center.slice(),v=Je(a,p*c),g=[v.slice()],m=l.getExtent();if(i.getWrapX()&&l.canWrapX()&&!ti(m,t.extent)){var _=wi(m),b=Math.max(wi(v)/2,_);v[0]=m[0]-b,v[2]=m[2]+b,wo(y,l);var w=function(t,e){var i=e.getExtent(),n=yi(t);if(e.canWrapX()&&(n[0]<i[0]||n[0]>=i[2])){var o=wi(i),r=Math.floor((n[0]-i[0])/o)*o;t[0]-=r,t[2]-=r}return t}(g[0],l);w[0]<m[0]&&w[2]<m[2]?g.push([w[0]+_,w[1],w[2]+_,w[3]]):w[0]>m[0]&&w[2]>m[2]&&g.push([w[0]-_,w[1],w[2]-_,w[3]])}if(!this.dirty_&&this.renderedResolution_==c&&this.renderedRevision_==f&&this.renderedRenderOrder_==d&&ti(this.renderedExtent_,v))return this.replayGroupChanged=!1,!0;this.replayGroup_=null,this.dirty_=!1;var x,S=new Mr(ds(c,h),v,c,h,e.getDeclutter()),T=nr;if(T){for(var O=0,C=g.length;O<C;++O)i.loadFeatures(or(g[O],l),c,T);x=Uo(T,l)}else for(O=0,C=g.length;O<C;++O)i.loadFeatures(g[O],c,l);var E=ps(c,h),P=function(t){var i,n=t.getStyleFunction()||e.getStyleFunction();if(n&&(i=n(t,c)),i){var o=this.renderFeature(t,E,i,S,x);this.dirty_=this.dirty_||o}}.bind(this),R=or(v,l),I=i.getFeaturesInExtent(R);d&&I.sort(d);for(O=0,C=I.length;O<C;++O)P(I[O]);this.renderedFeatures_=I;var k=S.finish(),j=new os(v,c,h,i.getOverlaps(),k,e.getRenderBuffer());return this.renderedResolution_=c,this.renderedRevision_=f,this.renderedRenderOrder_=d,this.renderedExtent_=v,this.renderedRotation_=u.rotation,this.renderedCenter_=y,this.renderedProjection_=l,this.replayGroup_=j,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0},e.prototype.renderFeature=function(t,e,i,n,o){if(!i)return!1;var r=!1;if(Array.isArray(i))for(var s=0,a=i.length;s<a;++s)r=ys(n,t,i[s],e,this.boundHandleStyleImageChange_,o)||r;else r=ys(n,t,i,e,this.boundHandleStyleImageChange_,o);return r},e}(cs),Us=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Js=function(t){function e(e){return t.call(this,e)||this}return Us(e,t),e.prototype.createRenderer=function(){return new Zs(this)},e}(mo);function Qs(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $s(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var ta=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.url,n=void 0===i?void 0:i,o=e.datetime,r=void 0===o?void 0:o,s=e.mimetype,a=void 0===s?void 0:s,u=e.reloadTime,l=void 0===u?void 0:u,c=e.className,h=void 0===c?void 0:c,f=e.imageSmoothingEnabled,p=void 0===f?void 0:f,d=e.ol,y=void 0===d?{}:d;Qs(this,t),this.options={url:n,datetime:r,mimetype:a,reloadTime:l,className:h,imageSmoothingEnabled:p,ol:y},this._normalizeOLOptions(this.options.ol),this.layer=void 0,this.layerGroup=void 0,this.reloadTimerId=void 0,this.visible=!1,this.zIndex=void 0,this.opacity=1}var e,i,n;return e=t,(i=[{key:"getId",value:function(){return this.getUrl()}},{key:"getUrl",value:function(){return this.options.url}},{key:"getDatetime",value:function(){return this.options.datetime}},{key:"getMIMEType",value:function(){return void 0===this.options.mimetype?"application/octet-stream":this.options.mimetype}},{key:"getReloadTime",value:function(){return this.options.reloadTime}},{key:"setReloadTime",value:function(t){return this.options.reloadTime=t,this._reload(),this}},{key:"getVisible",value:function(){return this.visible}},{key:"setVisible",value:function(t){return this.visible=t,void 0!==this.layer&&("setVisible"in this.layer?this.layer.setVisible(t):this.visible?this.layer.addTo(this.layerGroup):this.layerGroup.removeLayer(this.layer)),this}},{key:"getZIndex",value:function(){return this.zIndex}},{key:"setZIndex",value:function(t){return this.zIndex=t,void 0!==this.layer&&this.layer.setZIndex(t),this}},{key:"getOpacity",value:function(){return this.opacity}},{key:"setOpacity",value:function(t){return this.opacity=t,void 0!==this.layer&&this.layer.setOpacity(t),this}},{key:"getLayerGroup",value:function(){return this.layerGroup}},{key:"setLayerGroup",value:function(t){if(void 0!==this.layerGroup&&void 0!==this.layer&&("remove"in this.layerGroup.getLayers()?this.layerGroup.getLayers().remove(this.layer):this.layerGroup.removeLayer(this.layer)),void 0===t&&(this.layer=void 0),this.layerGroup=t,void 0!==this.layerGroup)if("addLayer"in this.layerGroup){var e=this.getLLLayer();this.getVisible()&&this.layerGroup.addLayer(e)}else this.layerGroup.getLayers().push(this.getOLLayer());return this.setReloadTime(this.getReloadTime()),this}},{key:"getOLLayer",value:function(){return void 0!==this.layer||(this.layer=this._makeOLLayer()),this.layer}},{key:"makeOLLayer",value:function(){return new Js({className:this.className})}},{key:"_makeOLLayer",value:function(){var t=this,e=this.makeOLLayer();return e.setVisible(this.visible),e.setZIndex(this.zIndex),e.setOpacity(this.opacity),"events"in this.options.ol&&void 0!==this.options.ol.events&&["prerender","postrender"].forEach((function(i){i in t.options.ol.events&&void 0!==t.options.ol.events[i]&&e.on(i,(function(n){t.options.ol.events[i].call(t,n,e)}))})),void 0===this.options.imageSmoothingEnabled||this.options.imageSmoothingEnabled||(e.on("prerender",(function(e){e.context.imageSmoothingEnabled=t.options.imageSmoothingEnabled})),e.on("postrender",(function(e){e.context.imageSmoothingEnabled=!t.options.imageSmoothingEnabled}))),e}},{key:"getLLLayer",value:function(){return void 0!==this.layer||(this.layer=this._makeLLLayer()),this.layer}},{key:"makeLLLayer",value:function(){return L.Layer()}},{key:"_makeLLLayer",value:function(){return this.makeLLLayer()}},{key:"_reload",value:function(){if(void 0!==this.reloadTimerId&&(clearTimeout(this.reloadTimerId),this.reloadTimerId=void 0),void 0!==this.options.reloadTime&&void 0!==this.layerGroup){var t=function(){if(this.reloadTimerId=void 0,void 0!==this.layerGroup){var e=this._makeOLLayer();if("getUrl"in e.getSource()){var i=this.layerGroup,n=e.getSource().on("change",function(){"ready"!=e.getSource().getState()&&"error"!=e.getSource().getState()||(function(t){if(Array.isArray(t))for(var e=0,i=t.length;e<i;++e)fe(t[e]);else fe(t)}(n),"ready"==e.getSource().getState()&&void 0!==this.layerGroup?(e.setVisible(this.layer.getVisible()),e.setOpacity(this.layer.getOpacity()),e.setZIndex(this.layer.getZIndex()),this.layerGroup.getLayers().remove(this.layer),this.layer=e):void 0!==this.layerGroup?this.layerGroup.getLayers().remove(e):i.getLayers().remove(e),void 0===this.reloadTimerId&&void 0!==this.options.reloadTime&&void 0!==this.layerGroup&&(this.reloadTimerId=setTimeout(t,1e3*this.options.reloadTime)))}.bind(this));this.layerGroup.getLayers().push(e),e.setVisible(!0)}else this.layerGroup.getLayers().push(e),e.setVisible(!0),setTimeout(function(){this.layer=e,void 0===this.reloadTimerId&&void 0!==this.options.reloadTime&&(this.reloadTimerId=setTimeout(t,1e3*this.options.reloadTime))}.bind(this),1e3)}}.bind(this);return this.reloadTimerId=setTimeout(t,1e3*this.options.reloadTime),this}}},{key:"_normalizeOLOptions",value:function(t){var e=t.source,i=void 0===e?{}:e,n=t.events,o=void 0===n?void 0:n,r=t.style,s=void 0===r?void 0:r;this.options.ol={source:i,events:o,style:s}}},{key:"className",get:function(){return this.options.className},set:function(t){this.options.className=t}},{key:"imageSmoothingEnabled",get:function(){return this.options.imageSmoothingEnabled},set:function(t){this.options.imageSmoothingEnabled=t}}])&&$s(e.prototype,i),n&&$s(e,n),t}();F(ta.prototype);var ea=ta;function ia(t){return(ia="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function na(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function oa(t,e,i){return(oa="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ua(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(i):o.value}})(t,e,i||t)}function ra(t,e){return(ra=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function sa(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=ua(t);if(e){var o=ua(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return aa(this,i)}}function aa(t,e){return!e||"object"!==ia(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ua(t){return(ua=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var la=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ra(t,e)}(r,t);var e,i,n,o=sa(r);function r(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),(t=o.call(this)).times=[],t}return e=r,(i=[{key:"getResources",value:function(){return this.times.map((function(t){return this.items[t.valueOf()]}),this)}},{key:"getTimes",value:function(){return this.times}},{key:"getItemById",value:function(t){var e=oa(ua(r.prototype),"getItemById",this).call(this,t);return void 0===e?new ea:e}},{key:"getResourceByTime",value:function(t){return this.getItemById(isNaN(t)?"":t.valueOf())}},{key:"containsTime",value:function(t){return this.getIndexById(isNaN(t)?"":t.valueOf())>-1}},{key:"getIndexByTime",value:function(t){var e=-1;return isNaN(t)||this.times.forEach((function(i,n){i.valueOf()==t.valueOf()&&(e=n)})),e}},{key:"getNewestResource",value:function(){return this.times.length<1?new ea:this.getResourceByTime(this.times[this.times.length-1])}},{key:"append",value:function(t){return this._append(t),this._sortTimes(),this}},{key:"remove",value:function(t){return this._remove(isNaN(t)?"":t.valueOf()),this._sortTimes(),this}},{key:"setResources",value:function(t){return t.forEach((function(t){this._append(t)}),this),this._filterTimesByResources(t),this._sortTimes(),this}},{key:"_append",value:function(t){var e=t.getDatetime(),i=void 0===e?"":e.valueOf();this.containsId(i)?(this.trigger("replace:item",t,this.getItemById(i)),this.items[i]=t):(this.itemIds.push(i),this.items[i]=t,void 0===e||isNaN(e)||this.times.push(e),this.trigger("add:item",t))}},{key:"_remove",value:function(t){var e=this.getIndexById(t);if(e>-1){var i=this.items[t];if(delete this.items[t],this.itemIds.splice(e,1),void 0!==t&&""!==t&&!isNaN(t)){var n=this.times.findIndex((function(e){return e.valueOf()==t}));n>-1&&this.times.splice(n,1)}this.trigger("remove:item",i)}}},{key:"_filterTimesByResources",value:function(t){var e=!1;this.times=this.times.filter((function(i){var n=!1;return t.findIndex((function(t){var n=!1,o=t.getDatetime();return void 0!==o&&i.valueOf()==o.valueOf()?n=!0:void 0===o&&(e=!0),n}),this)<0&&(this.remove(i.valueOf()),n=!0),!n}),this),e&&this.remove("")}},{key:"_sortTimes",value:function(){this.times.sort((function(t,e){return t.valueOf()-e.valueOf()}))}}])&&na(e.prototype,i),n&&na(e,n),r}(Ut);function ca(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ha(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var fa=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.id,n=void 0===i?void 0:i,o=e.visible,r=void 0===o||o,s=e.zIndex,a=void 0===s?void 0:s,u=e.displayMethod,l=void 0===u?"floor":u,c=e.displayMaxResourceAge,h=void 0===c?10800:c,f=e.displayFadeStart,p=void 0===f?900:f,d=e.displayFadeStartOpacity,y=void 0===d?.95:d,v=e.resources,g=void 0===v?void 0:v,m=e.className,_=void 0===m?void 0:m,b=e.imageSmoothingEnabled,w=void 0===b?void 0:b,x=e.tooltip,S=void 0===x?void 0:x;ca(this,t),this.options={id:n,visible:r,zIndex:a,displayMethod:l,displayMaxResourceAge:h,displayFadeStart:p,displayFadeStartOpacity:y,resources:g,className:_,imageSmoothingEnabled:w,tooltip:S},this.layerGroup=void 0,this.collection=new la,this.displayedResourceTime=new Date("invalid"),this.collection.on("add:item",(function(t){t.className=this.className,this._addOLLayer(t)}),this),this.collection.on("remove:item",(function(t){this._removeOLLayer(t)}),this),this.collection.on("replace:item",(function(t,e){t!==e&&(t.className=this.className,this._replaceOLLayer(t,e))}),this),void 0!==this.options.resources&&this.collection.setResources(this.options.resources),delete this.options.resources}var e,i,n;return e=t,(i=[{key:"getId",value:function(){return this.options.id}},{key:"setId",value:function(t){return this.options.id=t,this}},{key:"getVisible",value:function(){return this.options.visible}},{key:"setVisible",value:function(t){return(this.options.visible?!t:t)&&(this.options.visible=!!t,void 0!==this.layerGroup&&this.layerGroup.setVisible(this.options.visible),this.getResourceCollection().getItems().forEach((function(t){isNaN(t.getDatetime())&&t.setVisible(this.options.visible),t.setLayerGroup(this.options.visible?this.layerGroup:void 0)}),this),this.trigger("change:visible")),this}},{key:"getZIndex",value:function(){return this.options.zIndex}},{key:"setZIndex",value:function(t){return this.options.zIndex=t,void 0!==this.layerGroup&&this.layerGroup.setZIndex(t),this.getResourceCollection().getItems().forEach((function(e){e.setZIndex(t)})),this}},{key:"getLayerGroup",value:function(){return void 0===this.layerGroup?new qi:this.layerGroup}},{key:"setLayerGroup",value:function(t){return this.layerGroup=t,void 0!==this.layerGroup&&("setVisible"in this.layerGroup&&this.layerGroup.setVisible(this.options.visible),this.layerGroup.setZIndex(this.options.zIndex)),this.getResourceCollection().getItems().forEach((function(e){e.setLayerGroup(this.options.visible?t:void 0)}),this),this}},{key:"getResourceCollection",value:function(){return this.collection}},{key:"appendResource",value:function(t){return this.collection.append(t),this.setDisplayTime(this.displayedResourceTime),this.trigger("change:resources"),this}},{key:"removeResource",value:function(t){return this._hideVisibleResource(),this.collection.remove(t.getDatetime()),this.setDisplayTime(this.displayedResourceTime),this.trigger("change:resources"),this}},{key:"setResources",value:function(t){return this._hideVisibleResource(),this.collection.setResources(t),this.setDisplayTime(this.displayedResourceTime),this.trigger("change:resources"),this}},{key:"getDisplayedResource",value:function(){return this.getVisible()&&void 0!==this.layerGroup?isNaN(this.displayedResourceTime)&&this.collection.getTimes().length>0?new ea:this.collection.getResourceByTime(this.displayedResourceTime):new ea}},{key:"setDisplayTime",value:function(t){if(!this.getVisible())return this;var e=this._getResourceTimeByDisplayTime(t);if((void 0===e||void 0!==e&&!isNaN(this.displayedResourceTime)&&this.displayedResourceTime.valueOf()!=e.valueOf())&&this._hideVisibleResource(),void 0!==e){this.displayedResourceTime=e;var i=this.getResourceCollection().getItemById(e.valueOf());if(i.getId()){i.setVisible(!0);var n=1;Math.abs(t.valueOf()-e.valueOf())>1e3*this.options.displayMaxResourceAge?n=0:Math.abs(t.valueOf()-e.valueOf())>1e3*this.options.displayFadeStart&&(n=this.options.displayFadeStartOpacity*(Math.abs(t.valueOf()-e.valueOf())-1e3*this.options.displayMaxResourceAge)/(1e3*(this.options.displayFadeStart-this.options.displayMaxResourceAge))),i.setOpacity(n)}}else this.displayedResourceTime=new Date("invalid");return this}},{key:"getTooltip",value:function(){return this.options.tooltip}},{key:"setTooltip",value:function(t){return this.options.tooltip=t,this}},{key:"setResourcesOLStyle",value:function(){var t=arguments;return this.getResourceCollection().getItems().forEach((function(e){"setOLStyle"in e&&e.setOLStyle.apply(e,t)})),this}},{key:"_hideVisibleResource",value:function(){isNaN(this.displayedResourceTime)||this.getResourceCollection().getItemById(this.displayedResourceTime.valueOf()).setVisible(!1)}},{key:"_addOLLayer",value:function(t){isNaN(t.getDatetime())&&t.setVisible(this.getVisible()),void 0!==this.options.imageSmoothingEnabled&&void 0===t.imageSmoothingEnabled&&(t.imageSmoothingEnabled=this.options.imageSmoothingEnabled),t.setLayerGroup(this.getLayerGroup()),t.setZIndex(this.options.zIndex)}},{key:"_removeOLLayer",value:function(t){t.setLayerGroup(void 0)}},{key:"_replaceOLLayer",value:function(t,e){this._removeOLLayer(e),this._addOLLayer(t)}},{key:"_getResourceTimeByDisplayTime",value:function(t){if(!isNaN(t)){var e=void 0;return this.collection.getTimes().forEach((function(i){switch(this.options.displayMethod){case"exact":t.valueOf()==i.valueOf()&&(e=i);break;case"nearest":(void 0===e||Math.abs(t.valueOf()-i.valueOf())<Math.abs(t.valueOf()-e.valueOf()))&&(e=i);break;case"floor":default:(void 0===e||i.valueOf()<=t.valueOf()&&t.valueOf()-i.valueOf()<t.valueOf()-e.valueOf())&&(e=i)}}),this),e}}},{key:"className",get:function(){return this.options.className},set:function(t){this.options.className=t}}])&&ha(e.prototype,i),n&&ha(e,n),t}();F(fa.prototype);var pa=fa;function da(t){return(da="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ya(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function va(t,e,i){return(va="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ba(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(i):o.value}})(t,e,i||t)}function ga(t,e){return(ga=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ma(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=ba(t);if(e){var o=ba(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return _a(this,i)}}function _a(t,e){return!e||"object"!==da(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ba(t){return(ba=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var wa=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ga(t,e)}(r,t);var e,i,n,o=ma(r);function r(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),(e=o.call(this)).options=U.a.extend(!0,{exclusiveVisibility:!1,syncVisibility:!1},t),e}return e=r,(i=[{key:"getItemById",value:function(t){return void 0===va(ba(r.prototype),"getItemById",this).call(this,t)?new pa:this.items[t]}},{key:"append",value:function(t){var e=this;return this.options.exclusiveVisibility&&t.getVisible()&&this.isVisible()?t.setVisible(!1):e.options.syncVisibility&&(t.getVisible()?this.isVisible()||this.getItems().forEach((function(t){t.setVisible(!0)}),this):this.isVisible()&&t.setVisible(!0)),t.on("change:visible",(function(){e.options.exclusiveVisibility?this.getVisible()&&e.getItems().forEach((function(t){t.getId()!=this.getId()&&t.setVisible(!1)}),this):e.options.syncVisibility&&e.getItems().forEach((function(t){t.getId()!=this.getId()&&t.setVisible(this.getVisible())}),this)})),va(ba(r.prototype),"append",this).call(this,t)}},{key:"getVisibleTypes",value:function(){return this.getItems().filter((function(t){return t.getVisible()}))}},{key:"isVisible",value:function(){return this.getVisibleTypes().length>0}},{key:"setExclusiveVisibility",value:function(t){if(this.options.exclusiveVisibility!=t&&t){var e=!1;this.getItems().forEach((function(t){e?t.setVisible(!1):e=t.getVisible()}),this)}return this.options.exclusiveVisibility=t,this}},{key:"setSyncVisibility",value:function(t){return this.options.syncVisibility!=t&&t&&this.isVisible()&&this.getItems().forEach((function(t){t.setVisible(!0)}),this),this.options.syncVisibility=t,this}}])&&ya(e.prototype,i),n&&ya(e,n),r}(Ut);var xa=function t(e){var i=this,n=e.map,o=e.typeCollection,r=e.tooltip;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tooltipFeature=void 0,this.tooltipPixelColor=void 0,this.map=n,this.typeCollection=o,this.tooltip=r,Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this.tooltip),"tooltipNode")&&void 0===this.tooltip.tooltipNode&&(this.tooltip.tooltipNode=U()("<div>").css("position","absolute").prependTo(this.map.getMap().getTargetElement())),this.tooltip.on("hide:tooltip",(function(){i.tooltipFeature=void 0,i.tooltipPixelColor=void 0})),this.map.on("move:pointer",(function(t){if(!t.dragging)if((t=i.map.getExtendedEventByTypeCollection(t,i.typeCollection)).feature||t.color){if(t.feature===i.tooltipFeature&&(void 0===t.color&&void 0===i.tooltipPixelColor||void 0!==t.color&&void 0!==i.tooltipPixelColor&&t.color.join(",")===i.tooltipPixelColor.join(",")))return void i.tooltip.show({posX:t.pixel[0],posY:t.pixel[1]});i.tooltipFeature=void 0,i.tooltipPixelColor=void 0;var e=t.synviewType.getTooltip().call(void 0,t);void 0!==e?(i.tooltipFeature=t.feature,i.tooltipPixelColor=t.color,i.tooltip.content=e,i.tooltip.hide().show({posX:t.pixel[0],posY:t.pixel[1]})):i.tooltip.hide()}else i.tooltip.hide()}))};function Sa(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Ta=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.options=U.a.extend(!0,{map:void 0,timeline:void 0,tooltip:void 0},e),void 0===this.options.map&&(this.options.map=new qt),void 0===this.options.timeline&&(this.options.timeline=new V),this.typeCollection=new wa,this.tooltip=void 0,this.options.timeline.on("change:time",(function(){this.getTypeCollection().getItems().map((function(t){t.setDisplayTime(this.options.timeline.getSelectedTime())}),this)}),this);var i=this.options.timeline,n=function(){var t=i.isLastEnabledTime();this.getVisible()?i.setTimesBySetID(this.getId(),this.getResourceCollection().getTimes()):i.setTimesBySetID(this.getId(),[]),t?i.last():isNaN(i.getSelectedTime())&&i.first()},o=function(t){t.setLayerGroup(this.options.map.makeLayerGroup()),n.call(t),t.setDisplayTime(this.getTimeline().getSelectedTime()),t.on("change:resources",n),t.on("change:visible",n),void 0!==t.getTooltip()&&void 0===this.tooltip&&(this.tooltip=new xa({map:this.options.map,typeCollection:this.typeCollection,tooltip:this.options.tooltip}))},r=function(t){this.getTimeline().deleteSetID(t.getId())};this.typeCollection.on("add:item",o,this),this.typeCollection.on("remove:item",r,this),this.typeCollection.on("replace:item",(function(t,e){o.call(this,t),r.call(this,e)}),this)}var e,i,n;return e=t,(i=[{key:"getTimeline",value:function(){return this.options.timeline}},{key:"getMap",value:function(){return this.options.map}},{key:"getTypeCollection",value:function(){return this.typeCollection}},{key:"appendType",value:function(t){if(void 0===t.getId()){var e,i=0;do{e="synview-type-"+i++}while(this.getTypeCollection().containsId(e));t.setId(e)}return this.getTypeCollection().append(t),this}},{key:"getTooltip",value:function(){return this.options.tooltip}}])&&Sa(e.prototype,i),n&&Sa(e,n),t}();function Oa(t){return(Oa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ca(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(!t)return;if("string"==typeof t)return Ea(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Ea(t,e)}(t))){var e=0,i=function(){};return{s:i,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,o,r=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return r=t.done,t},e:function(t){s=!0,o=t},f:function(){try{r||null==n.return||n.return()}finally{if(s)throw o}}}}function Ea(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Pa(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ra(t,e,i){return(Ra="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ma(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(i):o.value}})(t,e,i||t)}function Ia(t,e){return(Ia=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ka(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Ma(t);if(e){var o=Ma(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return ja(this,i)}}function ja(t,e){return!e||"object"!==Oa(e)&&"function"!=typeof e?La(t):e}function La(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ma(t){return(Ma=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Fa=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ia(t,e)}(r,t);var e,i,n,o=ka(r);function r(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),void 0===(e=o.call(this,t)).options.layerGroup&&(e.options.layerGroup=new qi,e.options.map.addLayer(e.options.layerGroup)),e.options.map.getView().on("change:center",function(){this.trigger("change:view",this)}.bind(La(e))),e.options.map.getView().on("change:resolution",function(){this.trigger("change:view",this)}.bind(La(e))),e.options.map.on("pointermove",function(t){this.trigger("move:pointer",t)}.bind(La(e))),e.options.map.on("click",function(t){this.trigger("click:pointer",t)}.bind(La(e))),e.options.map.on("singleclick",function(t){this.trigger("singleclick:pointer",t)}.bind(La(e))),e.options.map.on("dblclick",function(t){this.trigger("dblclick:pointer",t)}.bind(La(e))),e.options.map.on("pointerdrag",function(t){this.trigger("drag:pointer",t)}.bind(La(e))),e}return e=r,(i=[{key:"getViewCenter",value:function(){return Qo(this.options.map.getView().getCenter(),this.options.map.getView().getProjection(),"EPSG:4326")}},{key:"setViewCenter",value:function(t){var e,i=!0;return t=t.map((function(t){return isNaN(t)?void(i=!1):1*t})),i&&this.options.map.getView().setCenter(Qo(t,"EPSG:4326",void 0!==e?e:"EPSG:3857")),this}},{key:"getViewZoom",value:function(){return this.options.map.getView().getZoom()}},{key:"setViewZoom",value:function(t){return isNaN(t)||this.options.map.getView().setZoom(1*t),this}},{key:"makeLayerGroup",value:function(){var t=new qi;return this.options.layerGroup.getLayers().push(t),t}},{key:"getExtendedEventByTypeCollection",value:function(t,e){t=Ra(Ma(r.prototype),"getExtendedEventByTypeCollection",this).call(this,t,e);var i=new Map;e.getVisibleTypes().filter((function(t){return void 0!==t.getTooltip()})).map((function(t){return i.set(t,[])}));var n,o=new Set,s=new Set,a=Ca(i.keys());try{var u=function(){var t=n.value;t.getLayerGroup().getLayers().getArray().filter((function(t){return t.getVisible()})).forEach((function(e){i.get(t).push(e),o.add(e),s.add(e.getClassName())}))};for(a.s();!(n=a.n()).done;)u()}catch(t){a.e(t)}finally{a.f()}return this.options.map.forEachFeatureAtPixel(t.pixel,(function(e,n){var o,r=Ca(i.keys());try{var s=function(){var r=o.value;if(i.get(r).forEach((function(i){void 0===t.synviewType&&i===n&&(t.feature=e,t.layer=n,t.synviewType=r)})),void 0!==t.synviewType)return"break"};for(r.s();!(o=r.n()).done&&"break"!==s(););}catch(t){r.e(t)}finally{r.f()}return void 0!==t.synviewType}),{hitTolerance:5,layerFilter:function(t){return o.has(t)}}),void 0===t.feature&&this.options.map.forEachLayerAtPixel(t.pixel,(function(e,n){if(null==n||n.length<1)return!1;var o,r=Ca(i.keys());try{var s=function(){var r=o.value;if(i.get(r).forEach((function(i){void 0===t.synviewType&&i.getClassName()==e.getClassName()&&(t.color=n,t.layer=e,t.synviewType=r)})),void 0!==t.synviewType)return"break"};for(r.s();!(o=r.n()).done&&"break"!==s(););}catch(t){r.e(t)}finally{r.f()}return void 0!==t.synviewType}),{hitTolerance:5,layerFilter:function(t){return s.has(t.getClassName())}}),t}},{key:"findLayerInType",value:function(t,e){return e.getLayerGroup().getLayers().getArray().findIndex((function(e){return e==t}))>-1}}])&&Pa(e.prototype,i),n&&Pa(e,n),r}(qt);function Da(t){return(Da="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Aa(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Na(t,e){return(Na=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ga(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Ya(t);if(e){var o=Ya(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Ba(this,i)}}function Ba(t,e){return!e||"object"!==Da(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ya(t){return(Ya=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Xa=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Na(t,e)}(r,t);var e,i,n,o=Ga(r);function r(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),void 0===(e=o.call(this,t)).options.layerGroup&&(e.options.layerGroup=L.layerGroup().addTo(e.options.map)),e}return e=r,(i=[{key:"makeLayerGroup",value:function(){return L.layerGroup().addTo(this.options.layerGroup)}}])&&Aa(e.prototype,i),n&&Aa(e,n),r}(qt),za=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();var Wa=function(t){function e(e){var i=t.call(this)||this;if(i.id_=void 0,i.geometryName_="geometry",i.style_=null,i.styleFunction_=void 0,i.geometryChangeKey_=null,i.addEventListener(Le(i.geometryName_),i.handleGeometryChanged_),e)if("function"==typeof e.getSimplifiedGeometry){var n=e;i.setGeometry(n)}else{var o=e;i.setProperties(o)}return i}return za(e,t),e.prototype.clone=function(){var t=new e(this.getProperties());t.setGeometryName(this.getGeometryName());var i=this.getGeometry();i&&t.setGeometry(i.clone());var n=this.getStyle();return n&&t.setStyle(n),t},e.prototype.getGeometry=function(){return this.get(this.geometryName_)},e.prototype.getId=function(){return this.id_},e.prototype.getGeometryName=function(){return this.geometryName_},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.handleGeometryChange_=function(){this.changed()},e.prototype.handleGeometryChanged_=function(){this.geometryChangeKey_&&(fe(this.geometryChangeKey_),this.geometryChangeKey_=null);var t=this.getGeometry();t&&(this.geometryChangeKey_=ce(t,Te,this.handleGeometryChange_,this)),this.changed()},e.prototype.setGeometry=function(t){this.set(this.geometryName_,t)},e.prototype.setStyle=function(t){this.style_=t,this.styleFunction_=t?function(t){if("function"==typeof t)return t;var e;Array.isArray(t)?e=t:(Ge("function"==typeof t.getZIndex,41),e=[t]);return function(){return e}}(t):void 0,this.changed()},e.prototype.setId=function(t){this.id_=t,this.changed()},e.prototype.setGeometryName=function(t){this.removeEventListener(Le(this.geometryName_),this.handleGeometryChanged_),this.geometryName_=t,this.addEventListener(Le(this.geometryName_),this.handleGeometryChanged_),this.handleGeometryChanged_()},e}(Me),Va=function(){function t(){this.dataProjection=null,this.defaultFeatureProjection=null}return t.prototype.getReadOptions=function(t,e){var i;if(e){var n=e.dataProjection?Ko(e.dataProjection):this.readProjection(t);e.extent&&n&&n.getUnits()===Oo.TILE_PIXELS&&(n=Ko(n)).setWorldExtent(e.extent),i={dataProjection:n,featureProjection:e.featureProjection}}return this.adaptOptions(i)},t.prototype.adaptOptions=function(t){return se({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection},t)},t.prototype.getType=function(){return Jt()},t.prototype.readFeature=function(t,e){return Jt()},t.prototype.readFeatures=function(t,e){return Jt()},t.prototype.readGeometry=function(t,e){return Jt()},t.prototype.readProjection=function(t){return Jt()},t.prototype.writeFeature=function(t,e){return Jt()},t.prototype.writeFeatures=function(t,e){return Jt()},t.prototype.writeGeometry=function(t,e){return Jt()},t}();function Ka(t,e,i){var n,o=i?Ko(i.featureProjection):null,r=i?Ko(i.dataProjection):null;if(n=o&&r&&!Zo(o,r)?(e?t.clone():t).transform(e?o:r,e?r:o):t,e&&i&&void 0!==i.decimals){var s=Math.pow(10,i.decimals);n===t&&(n=t.clone()),n.applyTransform((function(t){for(var e=0,i=t.length;e<i;++e)t[e]=Math.round(t[e]*s)/s;return t}))}return n}var qa="arraybuffer",Ha="json",Za="text",Ua="xml",Ja=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();function Qa(t){if("string"==typeof t){var e=JSON.parse(t);return e||null}return null!==t?t:null}var $a=function(t){function e(){return t.call(this)||this}return Ja(e,t),e.prototype.getType=function(){return Ha},e.prototype.readFeature=function(t,e){return this.readFeatureFromObject(Qa(t),this.getReadOptions(t,e))},e.prototype.readFeatures=function(t,e){return this.readFeaturesFromObject(Qa(t),this.getReadOptions(t,e))},e.prototype.readFeatureFromObject=function(t,e){return Jt()},e.prototype.readFeaturesFromObject=function(t,e){return Jt()},e.prototype.readGeometry=function(t,e){return this.readGeometryFromObject(Qa(t),this.getReadOptions(t,e))},e.prototype.readGeometryFromObject=function(t,e){return Jt()},e.prototype.readProjection=function(t){return this.readProjectionFromObject(Qa(t))},e.prototype.readProjectionFromObject=function(t){return Jt()},e.prototype.writeFeature=function(t,e){return JSON.stringify(this.writeFeatureObject(t,e))},e.prototype.writeFeatureObject=function(t,e){return Jt()},e.prototype.writeFeatures=function(t,e){return JSON.stringify(this.writeFeaturesObject(t,e))},e.prototype.writeFeaturesObject=function(t,e){return Jt()},e.prototype.writeGeometry=function(t,e){return JSON.stringify(this.writeGeometryObject(t,e))},e.prototype.writeGeometryObject=function(t,e){return Jt()},e}(Va),tu=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();function eu(t){for(var e=[],i=0,n=t.length;i<n;++i)e.push(t[i].clone());return e}var iu=function(t){function e(e){var i=t.call(this)||this;return i.geometries_=e||null,i.changeEventsKeys_=[],i.listenGeometriesChange_(),i}return tu(e,t),e.prototype.unlistenGeometriesChange_=function(){this.changeEventsKeys_.forEach(fe),this.changeEventsKeys_.length=0},e.prototype.listenGeometriesChange_=function(){if(this.geometries_)for(var t=0,e=this.geometries_.length;t<e;++t)this.changeEventsKeys_.push(ce(this.geometries_[t],Te,this.changed,this))},e.prototype.clone=function(){var t=new e(null);return t.setGeometries(this.geometries_),t},e.prototype.closestPointXY=function(t,e,i,n){if(n<Qe(this.getExtent(),t,e))return n;for(var o=this.geometries_,r=0,s=o.length;r<s;++r)n=o[r].closestPointXY(t,e,i,n);return n},e.prototype.containsXY=function(t,e){for(var i=this.geometries_,n=0,o=i.length;n<o;++n)if(i[n].containsXY(t,e))return!0;return!1},e.prototype.computeExtent=function(t){ri(t);for(var e=this.geometries_,i=0,n=e.length;i<n;++i)ui(t,e[i].getExtent());return t},e.prototype.getGeometries=function(){return eu(this.geometries_)},e.prototype.getGeometriesArray=function(){return this.geometries_},e.prototype.getGeometriesArrayRecursive=function(){for(var t=[],e=this.geometries_,i=0,n=e.length;i<n;++i)e[i].getType()===this.getType()?t=t.concat(e[i].getGeometriesArrayRecursive()):t.push(e[i]);return t},e.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<this.simplifiedGeometryMaxMinSquaredTolerance)return this;for(var i=[],n=this.geometries_,o=!1,r=0,s=n.length;r<s;++r){var a=n[r],u=a.getSimplifiedGeometry(t);i.push(u),u!==a&&(o=!0)}if(o){var l=new e(null);return l.setGeometriesArray(i),l}return this.simplifiedGeometryMaxMinSquaredTolerance=t,this},e.prototype.getType=function(){return an},e.prototype.intersectsExtent=function(t){for(var e=this.geometries_,i=0,n=e.length;i<n;++i)if(e[i].intersectsExtent(t))return!0;return!1},e.prototype.isEmpty=function(){return 0===this.geometries_.length},e.prototype.rotate=function(t,e){for(var i=this.geometries_,n=0,o=i.length;n<o;++n)i[n].rotate(t,e);this.changed()},e.prototype.scale=function(t,e,i){var n=i;n||(n=yi(this.getExtent()));for(var o=this.geometries_,r=0,s=o.length;r<s;++r)o[r].scale(t,e,n);this.changed()},e.prototype.setGeometries=function(t){this.setGeometriesArray(eu(t))},e.prototype.setGeometriesArray=function(t){this.unlistenGeometriesChange_(),this.geometries_=t,this.listenGeometriesChange_(),this.changed()},e.prototype.applyTransform=function(t){for(var e=this.geometries_,i=0,n=e.length;i<n;++i)e[i].applyTransform(t);this.changed()},e.prototype.translate=function(t,e){for(var i=this.geometries_,n=0,o=i.length;n<o;++n)i[n].translate(t,e);this.changed()},e.prototype.disposeInternal=function(){this.unlistenGeometriesChange_(),t.prototype.disposeInternal.call(this)},e}(ms);function nu(t,e,i,n,o,r,s){var a,u=t[e],l=t[e+1],c=t[i]-u,h=t[i+1]-l;if(0===c&&0===h)a=e;else{var f=((o-u)*c+(r-l)*h)/(c*c+h*h);if(f>1)a=i;else{if(f>0){for(var p=0;p<n;++p)s[p]=Bi(t[e+p],t[i+p],f);return void(s.length=n)}a=e}}for(p=0;p<n;++p)s[p]=t[a+p];s.length=n}function ou(t,e,i,n,o){var r=t[e],s=t[e+1];for(e+=n;e<i;e+=n){var a=t[e],u=t[e+1],l=Ai(r,s,a,u);l>o&&(o=l),r=a,s=u}return o}function ru(t,e,i,n,o){for(var r=0,s=i.length;r<s;++r){var a=i[r];o=ou(t,e,a,n,o),e=a}return o}function su(t,e,i,n,o,r,s,a,u,l,c){if(e==i)return l;var h,f;if(0===o){if((f=Ai(s,a,t[e],t[e+1]))<l){for(h=0;h<n;++h)u[h]=t[e+h];return u.length=n,f}return l}for(var p=c||[NaN,NaN],d=e+n;d<i;)if(nu(t,d-n,d,n,s,a,p),(f=Ai(s,a,p[0],p[1]))<l){for(l=f,h=0;h<n;++h)u[h]=p[h];u.length=n,d+=n}else d+=n*Math.max((Math.sqrt(f)-Math.sqrt(l))/o|0,1);if(r&&(nu(t,i-n,e,n,s,a,p),(f=Ai(s,a,p[0],p[1]))<l)){for(l=f,h=0;h<n;++h)u[h]=p[h];u.length=n}return l}function au(t,e,i,n,o,r,s,a,u,l,c){for(var h=c||[NaN,NaN],f=0,p=i.length;f<p;++f){var d=i[f];l=su(t,e,d,n,o,r,s,a,u,l,h),e=d}return l}function uu(t,e,i,n){for(var o=0,r=i.length;o<r;++o)for(var s=i[o],a=0;a<n;++a)t[e++]=s[a];return e}function lu(t,e,i,n,o){for(var r=o||[],s=0,a=0,u=i.length;a<u;++a){var l=uu(t,e,i[a],n);r[s++]=l,e=l}return r.length=s,r}function cu(t,e,i,n,o,r){var s=NaN,a=NaN,u=(i-e)/n;if(1===u)s=t[e],a=t[e+1];else if(2==u)s=(1-o)*t[e]+o*t[e+n],a=(1-o)*t[e+1]+o*t[e+n+1];else if(0!==u){for(var l=t[e],c=t[e+1],h=0,f=[0],p=e+n;p<i;p+=n){var d=t[p],y=t[p+1];h+=Math.sqrt((d-l)*(d-l)+(y-c)*(y-c)),f.push(h),l=d,c=y}var v=o*h,g=function(t,e,i){for(var n,o,r=i||de,s=0,a=t.length,u=!1;s<a;)(o=+r(t[n=s+(a-s>>1)],e))<0?s=n+1:(a=n,u=!o);return u?s:~s}(f,v);if(g<0){var m=(v-f[-g-2])/(f[-g-1]-f[-g-2]),_=e+(-g-2)*n;s=Bi(t[_],t[_+n],m),a=Bi(t[_+1],t[_+n+1],m)}else s=t[e+g*n],a=t[e+g*n+1]}return r?(r[0]=s,r[1]=a,r):[s,a]}function hu(t,e,i,n,o,r){if(i==e)return null;var s;if(o<t[e+n-1])return r?((s=t.slice(e,e+n))[n-1]=o,s):null;if(t[i-1]<o)return r?((s=t.slice(i-n,i))[n-1]=o,s):null;if(o==t[e+n-1])return t.slice(e,e+n);for(var a=e/n,u=i/n;a<u;){var l=a+u>>1;o<t[(l+1)*n-1]?u=l:a=l+1}var c=t[a*n-1];if(o==c)return t.slice((a-1)*n,(a-1)*n+n);var h=(o-c)/(t[(a+1)*n-1]-c);s=[];for(var f=0;f<n-1;++f)s.push(Bi(t[(a-1)*n+f],t[a*n+f],h));return s.push(o),s}function fu(t,e,i,n,o){return!function(t,e){var i;return(i=e(pi(t)))||(i=e(di(t)))||(i=e(bi(t)))?i:(i=e(_i(t)))||!1}(o,(function(o){return!pu(t,e,i,n,o[0],o[1])}))}function pu(t,e,i,n,o,r){for(var s=0,a=t[i-n],u=t[i-n+1];e<i;e+=n){var l=t[e],c=t[e+1];u<=r?c>r&&(l-a)*(r-u)-(o-a)*(c-u)>0&&s++:c<=r&&(l-a)*(r-u)-(o-a)*(c-u)<0&&s--,a=l,u=c}return 0!==s}function du(t,e,i,n,o,r){if(0===i.length)return!1;if(!pu(t,e,i[0],n,o,r))return!1;for(var s=1,a=i.length;s<a;++s)if(pu(t,i[s-1],i[s],n,o,r))return!1;return!0}function yu(t,e,i,n,o){for(var r,s=[t[e],t[e+1]],a=[];e+n<i;e+=n){if(a[0]=t[e+n],a[1]=t[e+n+1],r=o(s,a))return r;s[0]=a[0],s[1]=a[1]}return!1}function vu(t,e,i,n,o){var r=ci([1/0,1/0,-1/0,-1/0],t,e,i,n);return!!xi(o,r)&&(!!ti(o,r)||(r[0]>=o[0]&&r[2]<=o[2]||(r[1]>=o[1]&&r[3]<=o[3]||yu(t,e,i,n,(function(t,e){return function(t,e,i){var n=!1,o=ii(t,e),r=ii(t,i);if(o===Ve||r===Ve)n=!0;else{var s=t[0],a=t[1],u=t[2],l=t[3],c=e[0],h=e[1],f=i[0],p=i[1],d=(p-h)/(f-c),y=void 0,v=void 0;r&Ke&&!(o&Ke)&&(n=(y=f-(p-l)/d)>=s&&y<=u),n||!(r&qe)||o&qe||(n=(v=p-(f-u)*d)>=a&&v<=l),n||!(r&He)||o&He||(n=(y=f-(p-a)/d)>=s&&y<=u),n||!(r&Ze)||o&Ze||(n=(v=p-(f-s)*d)>=a&&v<=l)}return n}(o,t,e)})))))}function gu(t,e,i,n,o){if(!function(t,e,i,n,o){return!!vu(t,e,i,n,o)||(!!pu(t,e,i,n,o[0],o[1])||(!!pu(t,e,i,n,o[0],o[3])||(!!pu(t,e,i,n,o[2],o[1])||!!pu(t,e,i,n,o[2],o[3]))))}(t,e,i[0],n,o))return!1;if(1===i.length)return!0;for(var r=1,s=i.length;r<s;++r)if(fu(t,i[r-1],i[r],n,o)&&!vu(t,i[r-1],i[r],n,o))return!1;return!0}var mu=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),_u=function(t){function e(e,i){var n=t.call(this)||this;return n.flatMidpoint_=null,n.flatMidpointRevision_=-1,n.maxDelta_=-1,n.maxDeltaRevision_=-1,void 0===i||Array.isArray(e[0])?n.setCoordinates(e,i):n.setFlatCoordinates(i,e),n}return mu(e,t),e.prototype.appendCoordinate=function(t){this.flatCoordinates?ge(this.flatCoordinates,t):this.flatCoordinates=t.slice(),this.changed()},e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,i,n){return n<Qe(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(ou(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),su(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,i,n))},e.prototype.forEachSegment=function(t){return yu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.getCoordinateAtM=function(t,e){if(this.layout!=ws&&this.layout!=xs)return null;var i=void 0!==e&&e;return hu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i)},e.prototype.getCoordinates=function(){return sr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getCoordinateAt=function(t,e){return cu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e)},e.prototype.getLength=function(){return Xr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getFlatMidpoint=function(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[];return i.length=xr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i,0),new e(i,_s)},e.prototype.getType=function(){return tn},e.prototype.intersectsExtent=function(t){return vu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=uu(this.flatCoordinates,0,t,this.stride),this.changed()},e}(Os),bu=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),wu=function(t){function e(e,i,n){var o=t.call(this)||this;if(o.ends_=[],o.maxDelta_=-1,o.maxDeltaRevision_=-1,Array.isArray(e[0]))o.setCoordinates(e,i);else if(void 0!==i&&n)o.setFlatCoordinates(i,e),o.ends_=n;else{for(var r=o.getLayout(),s=e,a=[],u=[],l=0,c=s.length;l<c;++l){var h=s[l];0===l&&(r=h.getLayout()),ge(a,h.getFlatCoordinates()),u.push(a.length)}o.setFlatCoordinates(r,a),o.ends_=u}return o}return bu(e,t),e.prototype.appendLineString=function(t){this.flatCoordinates?ge(this.flatCoordinates,t.getFlatCoordinates().slice()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice())},e.prototype.closestPointXY=function(t,e,i,n){return n<Qe(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(ru(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),au(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,i,n))},e.prototype.getCoordinateAtM=function(t,e,i){if(this.layout!=ws&&this.layout!=xs||0===this.flatCoordinates.length)return null;var n=void 0!==e&&e,o=void 0!==i&&i;return function(t,e,i,n,o,r,s){if(s)return hu(t,e,i[i.length-1],n,o,r);var a;if(o<t[n-1])return r?((a=t.slice(0,n))[n-1]=o,a):null;if(t[t.length-1]<o)return r?((a=t.slice(t.length-n))[n-1]=o,a):null;for(var u=0,l=i.length;u<l;++u){var c=i[u];if(e!=c){if(o<t[e+n-1])return null;if(o<=t[c-1])return hu(t,e,c,n,o,!1);e=c}}return null}(this.flatCoordinates,0,this.ends_,this.stride,t,n,o)},e.prototype.getCoordinates=function(){return ar(this.flatCoordinates,0,this.ends_,this.stride)},e.prototype.getEnds=function(){return this.ends_},e.prototype.getLineString=function(t){return t<0||this.ends_.length<=t?null:new _u(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)},e.prototype.getLineStrings=function(){for(var t=this.flatCoordinates,e=this.ends_,i=this.layout,n=[],o=0,r=0,s=e.length;r<s;++r){var a=e[r],u=new _u(t.slice(o,a),i);n.push(u),o=a}return n},e.prototype.getFlatMidpoints=function(){for(var t=[],e=this.flatCoordinates,i=0,n=this.ends_,o=this.stride,r=0,s=n.length;r<s;++r){var a=n[r];ge(t,cu(e,i,a,o,.5)),i=a}return t},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[],n=[];return i.length=Sr(this.flatCoordinates,0,this.ends_,this.stride,t,i,0,n),new e(i,_s,n)},e.prototype.getType=function(){return rn},e.prototype.intersectsExtent=function(t){return function(t,e,i,n,o){for(var r=0,s=i.length;r<s;++r){if(vu(t,e,i[r],n,o))return!0;e=i[r]}return!1}(this.flatCoordinates,0,this.ends_,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var i=lu(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()},e}(Os),xu=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Su=function(t){function e(e,i){var n=t.call(this)||this;return n.setCoordinates(e,i),n}return xu(e,t),e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,i,n){var o=this.flatCoordinates,r=Ai(t,e,o[0],o[1]);if(r<n){for(var s=this.stride,a=0;a<s;++a)i[a]=o[a];return i.length=s,r}return n},e.prototype.getCoordinates=function(){return this.flatCoordinates?this.flatCoordinates.slice():[]},e.prototype.computeExtent=function(t){return e=this.flatCoordinates,i=t,n=e[0],o=e[1],oi(n,o,n,o,i);var e,i,n,o},e.prototype.getType=function(){return $i},e.prototype.intersectsExtent=function(t){return ei(t,this.flatCoordinates[0],this.flatCoordinates[1])},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=function(t,e,i,n){for(var o=0,r=i.length;o<r;++o)t[e++]=i[o];return e}(this.flatCoordinates,0,t,this.stride),this.changed()},e}(Os),Tu=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ou=function(t){function e(e,i){var n=t.call(this)||this;return i&&!Array.isArray(e[0])?n.setFlatCoordinates(i,e):n.setCoordinates(e,i),n}return Tu(e,t),e.prototype.appendPoint=function(t){this.flatCoordinates?ge(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.changed()},e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,i,n){if(n<Qe(this.getExtent(),t,e))return n;for(var o=this.flatCoordinates,r=this.stride,s=0,a=o.length;s<a;s+=r){var u=Ai(t,e,o[s],o[s+1]);if(u<n){n=u;for(var l=0;l<r;++l)i[l]=o[s+l];i.length=r}}return n},e.prototype.getCoordinates=function(){return sr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getPoint=function(t){var e=this.flatCoordinates?this.flatCoordinates.length/this.stride:0;return t<0||e<=t?null:new Su(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)},e.prototype.getPoints=function(){for(var t=this.flatCoordinates,e=this.layout,i=this.stride,n=[],o=0,r=t.length;o<r;o+=i){var s=new Su(t.slice(o,o+i),e);n.push(s)}return n},e.prototype.getType=function(){return on},e.prototype.intersectsExtent=function(t){for(var e=this.flatCoordinates,i=this.stride,n=0,o=e.length;n<o;n+=i){if(ei(t,e[n],e[n+1]))return!0}return!1},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=uu(this.flatCoordinates,0,t,this.stride),this.changed()},e}(Os);function Cu(t,e,i,n){for(var o=0,r=t[i-n],s=t[i-n+1];e<i;e+=n){var a=t[e],u=t[e+1];o+=s*a-r*u,r=a,s=u}return o/2}function Eu(t,e,i,n){for(var o=0,r=0,s=i.length;r<s;++r){var a=i[r];o+=Cu(t,e,a,n),e=a}return o}var Pu=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ru=function(t){function e(e,i){var n=t.call(this)||this;return n.maxDelta_=-1,n.maxDeltaRevision_=-1,void 0===i||Array.isArray(e[0])?n.setCoordinates(e,i):n.setFlatCoordinates(i,e),n}return Pu(e,t),e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,i,n){return n<Qe(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(ou(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),su(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,i,n))},e.prototype.getArea=function(){return Cu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getCoordinates=function(){return sr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[];return i.length=xr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i,0),new e(i,_s)},e.prototype.getType=function(){return en},e.prototype.intersectsExtent=function(t){return!1},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=uu(this.flatCoordinates,0,t,this.stride),this.changed()},e}(Os);function Iu(t,e,i,n,o,r,s){for(var a,u,l,c,h,f,p,d=o[r+1],y=[],v=0,g=i.length;v<g;++v){var m=i[v];for(c=t[m-n],f=t[m-n+1],a=e;a<m;a+=n)h=t[a],p=t[a+1],(d<=f&&p<=d||f<=d&&d<=p)&&(l=(d-f)/(p-f)*(h-c)+c,y.push(l)),c=h,f=p}var _=NaN,b=-1/0;for(y.sort(de),c=y[0],a=1,u=y.length;a<u;++a){h=y[a];var w=Math.abs(h-c);w>b&&du(t,e,i,n,l=(c+h)/2,d)&&(_=l,b=w),c=h}return isNaN(_)&&(_=o[r]),s?(s.push(_,d,b),s):[_,d,b]}function ku(t,e,i,n){for(;e<i-n;){for(var o=0;o<n;++o){var r=t[e+o];t[e+o]=t[i-n+o],t[i-n+o]=r}e+=n,i-=n}}function ju(t,e,i,n){for(var o=0,r=t[i-n],s=t[i-n+1];e<i;e+=n){var a=t[e],u=t[e+1];o+=(a-r)*(u+s),r=a,s=u}return o>0}function Lu(t,e,i,n,o){for(var r=void 0!==o&&o,s=0,a=i.length;s<a;++s){var u=i[s],l=ju(t,e,u,n);if(0===s){if(r&&l||!r&&!l)return!1}else if(r&&!l||!r&&l)return!1;e=u}return!0}function Mu(t,e,i,n,o){for(var r=void 0!==o&&o,s=0,a=i.length;s<a;++s){var u=i[s],l=ju(t,e,u,n);(0===s?r&&l||!r&&!l:r&&!l||!r&&l)&&ku(t,e,u,n),e=u}return e}function Fu(t,e,i,n,o){for(var r=0,s=i.length;r<s;++r)e=Mu(t,e,i[r],n,o);return e}var Du=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Au=function(t){function e(e,i,n){var o=t.call(this)||this;return o.ends_=[],o.flatInteriorPointRevision_=-1,o.flatInteriorPoint_=null,o.maxDelta_=-1,o.maxDeltaRevision_=-1,o.orientedRevision_=-1,o.orientedFlatCoordinates_=null,void 0!==i&&n?(o.setFlatCoordinates(i,e),o.ends_=n):o.setCoordinates(e,i),o}return Du(e,t),e.prototype.appendLinearRing=function(t){this.flatCoordinates?ge(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice())},e.prototype.closestPointXY=function(t,e,i,n){return n<Qe(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(ru(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),au(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,i,n))},e.prototype.containsXY=function(t,e){return du(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)},e.prototype.getArea=function(){return Eu(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)},e.prototype.getCoordinates=function(t){var e;return void 0!==t?Mu(e=this.getOrientedFlatCoordinates().slice(),0,this.ends_,this.stride,t):e=this.flatCoordinates,ar(e,0,this.ends_,this.stride)},e.prototype.getEnds=function(){return this.ends_},e.prototype.getFlatInteriorPoint=function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var t=yi(this.getExtent());this.flatInteriorPoint_=Iu(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_},e.prototype.getInteriorPoint=function(){return new Su(this.getFlatInteriorPoint(),ws)},e.prototype.getLinearRingCount=function(){return this.ends_.length},e.prototype.getLinearRing=function(t){return t<0||this.ends_.length<=t?null:new Ru(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)},e.prototype.getLinearRings=function(){for(var t=this.layout,e=this.flatCoordinates,i=this.ends_,n=[],o=0,r=0,s=i.length;r<s;++r){var a=i[r],u=new Ru(e.slice(o,a),t);n.push(u),o=a}return n},e.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;Lu(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Mu(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[],n=[];return i.length=Cr(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),i,0,n),new e(i,_s,n)},e.prototype.getType=function(){return nn},e.prototype.intersectsExtent=function(t){return gu(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var i=lu(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()},e}(Os),Nu=Au;var Gu=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Bu=function(t){function e(e,i,n){var o=t.call(this)||this;if(o.endss_=[],o.flatInteriorPointsRevision_=-1,o.flatInteriorPoints_=null,o.maxDelta_=-1,o.maxDeltaRevision_=-1,o.orientedRevision_=-1,o.orientedFlatCoordinates_=null,!n&&!Array.isArray(e[0])){for(var r=o.getLayout(),s=e,a=[],u=[],l=0,c=s.length;l<c;++l){var h=s[l];0===l&&(r=h.getLayout());for(var f=a.length,p=h.getEnds(),d=0,y=p.length;d<y;++d)p[d]+=f;ge(a,h.getFlatCoordinates()),u.push(p)}i=r,e=a,n=u}return void 0!==i&&n?(o.setFlatCoordinates(i,e),o.endss_=n):o.setCoordinates(e,i),o}return Gu(e,t),e.prototype.appendPolygon=function(t){var e;if(this.flatCoordinates){var i=this.flatCoordinates.length;ge(this.flatCoordinates,t.getFlatCoordinates());for(var n=0,o=(e=t.getEnds().slice()).length;n<o;++n)e[n]+=i}else this.flatCoordinates=t.getFlatCoordinates().slice(),e=t.getEnds().slice(),this.endss_.push();this.endss_.push(e),this.changed()},e.prototype.clone=function(){for(var t=this.endss_.length,i=new Array(t),n=0;n<t;++n)i[n]=this.endss_[n].slice();return new e(this.flatCoordinates.slice(),this.layout,i)},e.prototype.closestPointXY=function(t,e,i,n){return n<Qe(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(function(t,e,i,n,o){for(var r=0,s=i.length;r<s;++r){var a=i[r];o=ru(t,e,a,n,o),e=a[a.length-1]}return o}(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),function(t,e,i,n,o,r,s,a,u,l,c){for(var h=c||[NaN,NaN],f=0,p=i.length;f<p;++f){var d=i[f];l=au(t,e,d,n,o,r,s,a,u,l,h),e=d[d.length-1]}return l}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,t,e,i,n))},e.prototype.containsXY=function(t,e){return function(t,e,i,n,o,r){if(0===i.length)return!1;for(var s=0,a=i.length;s<a;++s){var u=i[s];if(du(t,e,u,n,o,r))return!0;e=u[u.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)},e.prototype.getArea=function(){return function(t,e,i,n){for(var o=0,r=0,s=i.length;r<s;++r){var a=i[r];o+=Eu(t,e,a,n),e=a[a.length-1]}return o}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)},e.prototype.getCoordinates=function(t){var e;return void 0!==t?Fu(e=this.getOrientedFlatCoordinates().slice(),0,this.endss_,this.stride,t):e=this.flatCoordinates,ur(e,0,this.endss_,this.stride)},e.prototype.getEndss=function(){return this.endss_},e.prototype.getFlatInteriorPoints=function(){if(this.flatInteriorPointsRevision_!=this.getRevision()){var t=function(t,e,i,n){for(var o=[],r=[1/0,1/0,-1/0,-1/0],s=0,a=i.length;s<a;++s){var u=i[s];r=si(t,e,u[0],n),o.push((r[0]+r[2])/2,(r[1]+r[3])/2),e=u[u.length-1]}return o}(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=function(t,e,i,n,o){for(var r=[],s=0,a=i.length;s<a;++s){var u=i[s];r=Iu(t,e,u,n,o,2*s,r),e=u[u.length-1]}return r}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_},e.prototype.getInteriorPoints=function(){return new Ou(this.getFlatInteriorPoints().slice(),ws)},e.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;!function(t,e,i,n,o){for(var r=0,s=i.length;r<s;++r){var a=i[r];if(!Lu(t,e,a,n,o))return!1;a.length&&(e=a[a.length-1])}return!0}(t,0,this.endss_,this.stride)?(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Fu(this.orientedFlatCoordinates_,0,this.endss_,this.stride)):this.orientedFlatCoordinates_=t,this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[],n=[];return i.length=function(t,e,i,n,o,r,s,a){for(var u=0,l=i.length;u<l;++u){var c=i[u],h=[];s=Cr(t,e,c,n,o,r,s,h),a.push(h),e=c[c.length-1]}return s}(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),i,0,n),new e(i,_s,n)},e.prototype.getPolygon=function(t){if(t<0||this.endss_.length<=t)return null;var e;if(0===t)e=0;else{var i=this.endss_[t-1];e=i[i.length-1]}var n=this.endss_[t].slice(),o=n[n.length-1];if(0!==e)for(var r=0,s=n.length;r<s;++r)n[r]-=e;return new Nu(this.flatCoordinates.slice(e,o),this.layout,n)},e.prototype.getPolygons=function(){for(var t=this.layout,e=this.flatCoordinates,i=this.endss_,n=[],o=0,r=0,s=i.length;r<s;++r){var a=i[r].slice(),u=a[a.length-1];if(0!==o)for(var l=0,c=a.length;l<c;++l)a[l]-=o;var h=new Nu(e.slice(o,u),t,a);n.push(h),o=u}return n},e.prototype.getType=function(){return sn},e.prototype.intersectsExtent=function(t){return function(t,e,i,n,o){for(var r=0,s=i.length;r<s;++r){var a=i[r];if(gu(t,e,a,n,o))return!0;e=a[a.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);var i=function(t,e,i,n,o){for(var r=o||[],s=0,a=0,u=i.length;a<u;++a){var l=lu(t,e,i[a],n,r[s]);r[s++]=l,e=l[l.length-1]}return r.length=s,r}(this.flatCoordinates,0,t,this.stride,this.endss_);if(0===i.length)this.flatCoordinates.length=0;else{var n=i[i.length-1];this.flatCoordinates.length=0===n.length?0:n[n.length-1]}this.changed()},e}(Os),Yu=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();function Xu(t,e){if(!t)return null;var i;switch(t.type){case $i:i=function(t){return new Su(t.coordinates)}(t);break;case tn:i=function(t){return new _u(t.coordinates)}(t);break;case nn:i=function(t){return new Nu(t.coordinates)}(t);break;case on:i=function(t){return new Ou(t.coordinates)}(t);break;case rn:i=function(t){return new wu(t.coordinates)}(t);break;case sn:i=function(t){return new Bu(t.coordinates)}(t);break;case an:i=function(t,e){var i=t.geometries.map((function(t){return Xu(t,e)}));return new iu(i)}(t);break;default:throw new Error("Unsupported GeoJSON type: "+t.type)}return Ka(i,!1,e)}function zu(t,e){var i,n=(t=Ka(t,!0,e)).getType();switch(n){case $i:i=function(t,e){return{type:"Point",coordinates:t.getCoordinates()}}(t);break;case tn:i=function(t,e){return{type:"LineString",coordinates:t.getCoordinates()}}(t);break;case nn:i=function(t,e){var i;e&&(i=e.rightHanded);return{type:"Polygon",coordinates:t.getCoordinates(i)}}(t,e);break;case on:i=function(t,e){return{type:"MultiPoint",coordinates:t.getCoordinates()}}(t);break;case rn:i=function(t,e){return{type:"MultiLineString",coordinates:t.getCoordinates()}}(t);break;case sn:i=function(t,e){var i;e&&(i=e.rightHanded);return{type:"MultiPolygon",coordinates:t.getCoordinates(i)}}(t,e);break;case an:i=function(t,e){return{type:"GeometryCollection",geometries:t.getGeometriesArray().map((function(t){var i=se({},e);return delete i.featureProjection,zu(t,i)}))}}(t,e);break;case un:i={type:"GeometryCollection",geometries:[]};break;default:throw new Error("Unsupported geometry type: "+n)}return i}var Wu=function(t){function e(e){var i=this,n=e||{};return(i=t.call(this)||this).dataProjection=Ko(n.dataProjection?n.dataProjection:"EPSG:4326"),n.featureProjection&&(i.defaultFeatureProjection=Ko(n.featureProjection)),i.geometryName_=n.geometryName,i.extractGeometryName_=n.extractGeometryName,i}return Yu(e,t),e.prototype.readFeatureFromObject=function(t,e){var i=null,n=Xu((i="Feature"===t.type?t:{type:"Feature",geometry:t,properties:null}).geometry,e),o=new Wa;return this.geometryName_?o.setGeometryName(this.geometryName_):this.extractGeometryName_&&"geometry_name"in i!==void 0&&o.setGeometryName(i.geometry_name),o.setGeometry(n),"id"in i&&o.setId(i.id),i.properties&&o.setProperties(i.properties,!0),o},e.prototype.readFeaturesFromObject=function(t,e){var i=null;if("FeatureCollection"===t.type){i=[];for(var n=t.features,o=0,r=n.length;o<r;++o)i.push(this.readFeatureFromObject(n[o],e))}else i=[this.readFeatureFromObject(t,e)];return i},e.prototype.readGeometryFromObject=function(t,e){return Xu(t,e)},e.prototype.readProjectionFromObject=function(t){var e,i=t.crs;return i?"name"==i.type?e=Ko(i.properties.name):"EPSG"===i.type?e=Ko("EPSG:"+i.properties.code):Ge(!1,36):e=this.dataProjection,e},e.prototype.writeFeatureObject=function(t,e){e=this.adaptOptions(e);var i={type:"Feature",geometry:null,properties:null},n=t.getId();void 0!==n&&(i.id=n);var o=t.getGeometry();o&&(i.geometry=zu(o,e));var r=t.getProperties();return delete r[t.getGeometryName()],le(r)||(i.properties=r),i},e.prototype.writeFeaturesObject=function(t,e){e=this.adaptOptions(e);for(var i=[],n=0,o=t.length;n<o;++n)i.push(this.writeFeatureObject(t[n],e));return{type:"FeatureCollection",features:i}},e.prototype.writeGeometryObject=function(t,e){return zu(t,this.adaptOptions(e))},e}($a),Vu=!1;function Ku(t,e,i,n){return function(o,r,s){var a=new XMLHttpRequest;a.open("GET","function"==typeof t?t(o,r,s):t,!0),e.getType()==qa&&(a.responseType="arraybuffer"),a.withCredentials=Vu,a.onload=function(t){if(!a.status||a.status>=200&&a.status<300){var r=e.getType(),u=void 0;r==Ha||r==Za?u=a.responseText:r==Ua?(u=a.responseXML)||(u=(new DOMParser).parseFromString(a.responseText,"application/xml")):r==qa&&(u=a.response),u?i.call(this,e.readFeatures(u,{extent:o,featureProjection:s}),e.readProjection(u)):n.call(this)}else n.call(this)}.bind(this),a.onerror=function(){n.call(this)}.bind(this),a.send()}}function qu(t,e){return Ku(t,e,(function(t,e){"function"==typeof this.addFeatures&&this.addFeatures(t)}),be)}function Hu(t,e){return[[-1/0,-1/0,1/0,1/0]]}var Zu=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();function Uu(t){return t?Array.isArray(t)?function(e){return t}:"function"==typeof t?t:function(e){return[t]}:null}var Ju=function(t){function e(e){var i=t.call(this)||this;return i.projection_=Ko(e.projection),i.attributions_=Uu(e.attributions),i.attributionsCollapsible_=void 0===e.attributionsCollapsible||e.attributionsCollapsible,i.loading=!1,i.state_=void 0!==e.state?e.state:Wi,i.wrapX_=void 0!==e.wrapX&&e.wrapX,i}return Zu(e,t),e.prototype.getAttributions=function(){return this.attributions_},e.prototype.getAttributionsCollapsible=function(){return this.attributionsCollapsible_},e.prototype.getProjection=function(){return this.projection_},e.prototype.getResolutions=function(){return Jt()},e.prototype.getState=function(){return this.state_},e.prototype.getWrapX=function(){return this.wrapX_},e.prototype.refresh=function(){this.changed()},e.prototype.setAttributions=function(t){this.attributions_=Uu(t),this.changed()},e.prototype.setState=function(t){this.state_=t,this.changed()},e}(Me),Qu="addfeature",$u="changefeature",tl="clear",el="removefeature",il=function(){function t(t){this.rbush_=new Vr.a(t),this.items_={}}return t.prototype.insert=function(t,e){var i={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(i),this.items_[$t(e)]=i},t.prototype.load=function(t,e){for(var i=new Array(e.length),n=0,o=e.length;n<o;n++){var r=t[n],s=e[n],a={minX:r[0],minY:r[1],maxX:r[2],maxY:r[3],value:s};i[n]=a,this.items_[$t(s)]=a}this.rbush_.load(i)},t.prototype.remove=function(t){var e=$t(t),i=this.items_[e];return delete this.items_[e],null!==this.rbush_.remove(i)},t.prototype.update=function(t,e){var i=this.items_[$t(e)];ai([i.minX,i.minY,i.maxX,i.maxY],t)||(this.remove(e),this.insert(t,e))},t.prototype.getAll=function(){return this.rbush_.all().map((function(t){return t.value}))},t.prototype.getInExtent=function(t){var e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map((function(t){return t.value}))},t.prototype.forEach=function(t){return this.forEach_(this.getAll(),t)},t.prototype.forEachInExtent=function(t,e){return this.forEach_(this.getInExtent(t),e)},t.prototype.forEach_=function(t,e){for(var i,n=0,o=t.length;n<o;n++)if(i=e(t[n]))return i;return i},t.prototype.isEmpty=function(){return le(this.items_)},t.prototype.clear=function(){this.rbush_.clear(),this.items_={}},t.prototype.getExtent=function(t){var e=this.rbush_.toJSON();return oi(e.minX,e.minY,e.maxX,e.maxY,t)},t.prototype.concat=function(t){for(var e in this.rbush_.load(t.rbush_.all()),t.items_)this.items_[e]=t.items_[e]},t}(),nl=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ol=function(t){function e(e,i){var n=t.call(this,e)||this;return n.feature=i,n}return nl(e,t),e}(we),rl=function(t){function e(e){var i=this,n=e||{};(i=t.call(this,{attributions:n.attributions,projection:void 0,state:Wi,wrapX:void 0===n.wrapX||n.wrapX})||this).loader_=be,i.format_=n.format,i.overlaps_=void 0===n.overlaps||n.overlaps,i.url_=n.url,void 0!==n.loader?i.loader_=n.loader:void 0!==i.url_&&(Ge(i.format_,7),i.loader_=qu(i.url_,i.format_)),i.strategy_=void 0!==n.strategy?n.strategy:Hu;var o,r,s=void 0===n.useSpatialIndex||n.useSpatialIndex;return i.featuresRtree_=s?new il:null,i.loadedExtentsRtree_=new il,i.nullGeometryFeatures_={},i.idIndex_={},i.uidIndex_={},i.featureChangeKeys_={},i.featuresCollection_=null,Array.isArray(n.features)?r=n.features:n.features&&(r=(o=n.features).getArray()),s||void 0!==o||(o=new Ne(r)),void 0!==r&&i.addFeaturesInternal(r),void 0!==o&&i.bindFeaturesCollection_(o),i}return nl(e,t),e.prototype.addFeature=function(t){this.addFeatureInternal(t),this.changed()},e.prototype.addFeatureInternal=function(t){var e=$t(t);if(this.addToIndex_(e,t)){this.setupChangeEvents_(e,t);var i=t.getGeometry();if(i){var n=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(n,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new ol(Qu,t))}else this.featuresCollection_&&this.featuresCollection_.remove(t)},e.prototype.setupChangeEvents_=function(t,e){this.featureChangeKeys_[t]=[ce(e,Te,this.handleFeatureChange_,this),ce(e,re,this.handleFeatureChange_,this)]},e.prototype.addToIndex_=function(t,e){var i=!0,n=e.getId();return void 0!==n&&(n.toString()in this.idIndex_?i=!1:this.idIndex_[n.toString()]=e),i&&(Ge(!(t in this.uidIndex_),30),this.uidIndex_[t]=e),i},e.prototype.addFeatures=function(t){this.addFeaturesInternal(t),this.changed()},e.prototype.addFeaturesInternal=function(t){for(var e=[],i=[],n=[],o=0,r=t.length;o<r;o++){var s=$t(u=t[o]);this.addToIndex_(s,u)&&i.push(u)}o=0;for(var a=i.length;o<a;o++){var u;s=$t(u=i[o]);this.setupChangeEvents_(s,u);var l=u.getGeometry();if(l){var c=l.getExtent();e.push(c),n.push(u)}else this.nullGeometryFeatures_[s]=u}this.featuresRtree_&&this.featuresRtree_.load(e,n);o=0;for(var h=i.length;o<h;o++)this.dispatchEvent(new ol(Qu,i[o]))},e.prototype.bindFeaturesCollection_=function(t){var e=!1;this.addEventListener(Qu,(function(i){e||(e=!0,t.push(i.feature),e=!1)})),this.addEventListener(el,(function(i){e||(e=!0,t.remove(i.feature),e=!1)})),t.addEventListener(ne,function(t){e||(e=!0,this.addFeature(t.element),e=!1)}.bind(this)),t.addEventListener(oe,function(t){e||(e=!0,this.removeFeature(t.element),e=!1)}.bind(this)),this.featuresCollection_=t},e.prototype.clear=function(t){if(t){for(var e in this.featureChangeKeys_){this.featureChangeKeys_[e].forEach(fe)}this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_)for(var i in this.featuresRtree_.forEach(this.removeFeatureInternal.bind(this)),this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[i]);this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};var n=new ol(tl);this.dispatchEvent(n),this.changed()},e.prototype.forEachFeature=function(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)},e.prototype.forEachFeatureAtCoordinateDirect=function(t,e){var i=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(i,(function(i){return i.getGeometry().intersectsCoordinate(t)?e(i):void 0}))},e.prototype.forEachFeatureInExtent=function(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)},e.prototype.forEachFeatureIntersectingExtent=function(t,e){return this.forEachFeatureInExtent(t,(function(i){if(i.getGeometry().intersectsExtent(t)){var n=e(i);if(n)return n}}))},e.prototype.getFeaturesCollection=function(){return this.featuresCollection_},e.prototype.getFeatures=function(){var t;return this.featuresCollection_?t=this.featuresCollection_.getArray():this.featuresRtree_&&(t=this.featuresRtree_.getAll(),le(this.nullGeometryFeatures_)||ge(t,ue(this.nullGeometryFeatures_))),t},e.prototype.getFeaturesAtCoordinate=function(t){var e=[];return this.forEachFeatureAtCoordinateDirect(t,(function(t){e.push(t)})),e},e.prototype.getFeaturesInExtent=function(t){return this.featuresRtree_?this.featuresRtree_.getInExtent(t):this.featuresCollection_?this.featuresCollection_.getArray():[]},e.prototype.getClosestFeatureToCoordinate=function(t,e){var i=t[0],n=t[1],o=null,r=[NaN,NaN],s=1/0,a=[-1/0,-1/0,1/0,1/0],u=e||_e;return this.featuresRtree_.forEachInExtent(a,(function(t){if(u(t)){var e=t.getGeometry(),l=s;if((s=e.closestPointXY(i,n,r,s))<l){o=t;var c=Math.sqrt(s);a[0]=i-c,a[1]=n-c,a[2]=i+c,a[3]=n+c}}})),o},e.prototype.getExtent=function(t){return this.featuresRtree_.getExtent(t)},e.prototype.getFeatureById=function(t){var e=this.idIndex_[t.toString()];return void 0!==e?e:null},e.prototype.getFeatureByUid=function(t){var e=this.uidIndex_[t];return void 0!==e?e:null},e.prototype.getFormat=function(){return this.format_},e.prototype.getOverlaps=function(){return this.overlaps_},e.prototype.getUrl=function(){return this.url_},e.prototype.handleFeatureChange_=function(t){var e=t.target,i=$t(e),n=e.getGeometry();if(n){var o=n.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(o,e)):this.featuresRtree_&&this.featuresRtree_.update(o,e)}else i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[i]=e);var r=e.getId();if(void 0!==r){var s=r.toString();this.idIndex_[s]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[s]=e)}else this.removeFromIdIndex_(e),this.uidIndex_[i]=e;this.changed(),this.dispatchEvent(new ol($u,e))},e.prototype.hasFeature=function(t){var e=t.getId();return void 0!==e?e in this.idIndex_:$t(t)in this.uidIndex_},e.prototype.isEmpty=function(){return this.featuresRtree_.isEmpty()&&le(this.nullGeometryFeatures_)},e.prototype.loadFeatures=function(t,e,i){var n=this.loadedExtentsRtree_,o=this.strategy_(t,e);this.loading=!1;for(var r=function(t,r){var a=o[t];n.forEachInExtent(a,(function(t){return ti(t.extent,a)}))||(s.loader_.call(s,a,e,i),n.insert(a,{extent:a.slice()}),s.loading=s.loader_!==be)},s=this,a=0,u=o.length;a<u;++a)r(a)},e.prototype.refresh=function(){this.clear(!0),this.loadedExtentsRtree_.clear(),t.prototype.refresh.call(this)},e.prototype.removeLoadedExtent=function(t){var e,i=this.loadedExtentsRtree_;i.forEachInExtent(t,(function(i){if(ai(i.extent,t))return e=i,!0})),e&&i.remove(e)},e.prototype.removeFeature=function(t){var e=$t(t);e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t),this.removeFeatureInternal(t),this.changed()},e.prototype.removeFeatureInternal=function(t){var e=$t(t);this.featureChangeKeys_[e].forEach(fe),delete this.featureChangeKeys_[e];var i=t.getId();void 0!==i&&delete this.idIndex_[i.toString()],delete this.uidIndex_[e],this.dispatchEvent(new ol(el,t))},e.prototype.removeFromIdIndex_=function(t){var e=!1;for(var i in this.idIndex_)if(this.idIndex_[i]===t){delete this.idIndex_[i],e=!0;break}return e},e.prototype.setLoader=function(t){this.loader_=t},e.prototype.setUrl=function(t){Ge(this.format_,7),this.setLoader(qu(t,this.format_))},e}(Ju);function sl(t){return(sl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function al(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ul(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ll(t,e){return(ll=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function cl(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=fl(t);if(e){var o=fl(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return hl(this,i)}}function hl(t,e){return!e||"object"!==sl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function fl(t){return(fl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var pl=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ll(t,e)}(r,t);var e,i,n,o=cl(r);function r(){return al(this,r),o.apply(this,arguments)}return e=r,(i=[{key:"getId",value:function(){var t=this.getDatetime();return isNaN(t)?"":t.toISOString()}},{key:"makeOLLayer",value:function(){var t={source:this.options.ol.source,events:this.options.ol.events,style:this.options.ol.style};if(this.options.ol,!("refresh"in t.source)){var e=t.source;void 0!==this.options.url&&"format"in e&&void 0!==e.format&&(e.url=this.options.url),"projection"in e&&void 0!==e.projection||(e.projection="EPSG:4326"),t.source=new rl(e)}return"function"==typeof t.style&&(t.style=t.style.bind(this)),this.className&&(t.className=this.className),new Js(t)}},{key:"setOLStyle",value:function(t){return void 0===this.layer&&this.getOLLayer(),void 0!==this.layer&&"setStyle"in this.layer?(0==arguments.length?this.layer.setStyle(this.layer.getStyle()):this.layer.setStyle(t),this):this}}])&&ul(e.prototype,i),n&&ul(e,n),r}(ea);function dl(t){return(dl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yl(t,e){return(yl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function vl(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=ml(t);if(e){var o=ml(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return gl(this,i)}}function gl(t,e){return!e||"object"!==dl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ml(t){return(ml=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var _l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yl(t,e)}(i,t);var e=vl(i);function i(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(n=e.call(this,t)).options.ol.source.url=n.options.url,n.options.ol.source.format=new Wu,n}return i}(pl),bl=0,wl=1,xl=2,Sl=3,Tl=4;function Ol(t){return Math.pow(t,3)}var Cl=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),El=function(t){function e(e,i,n){var o=t.call(this)||this,r=n||{};return o.tileCoord=e,o.state=i,o.interimTile=null,o.hifi=!0,o.key="",o.transition_=void 0===r.transition?250:r.transition,o.transitionStarts_={},o}return Cl(e,t),e.prototype.changed=function(){this.dispatchEvent(Te)},e.prototype.release=function(){},e.prototype.getKey=function(){return this.key+"/"+this.tileCoord},e.prototype.getInterimTile=function(){if(!this.interimTile)return this;var t=this.interimTile;do{if(t.getState()==xl)return this.transition_=0,t;t=t.interimTile}while(t);return this},e.prototype.refreshInterimChain=function(){if(this.interimTile){var t=this.interimTile,e=this;do{if(t.getState()==xl){t.interimTile=null;break}t.getState()==wl?e=t:t.getState()==bl?e.interimTile=t.interimTile:e=t,t=e.interimTile}while(t)}},e.prototype.getTileCoord=function(){return this.tileCoord},e.prototype.getState=function(){return this.state},e.prototype.setState=function(t){if(this.state!==Sl&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()},e.prototype.load=function(){Jt()},e.prototype.getAlpha=function(t,e){if(!this.transition_)return 1;var i=this.transitionStarts_[t];if(i){if(-1===i)return 1}else i=e,this.transitionStarts_[t]=i;var n=e-i+1e3/60;return n>=this.transition_?1:Ol(n/this.transition_)},e.prototype.inTransition=function(t){return!!this.transition_&&-1!==this.transitionStarts_[t]},e.prototype.endTransition=function(t){this.transition_&&(this.transitionStarts_[t]=-1)},e}(Se),Pl=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Rl=[],Il=function(t){function e(e,i,n,o){var r=t.call(this,e,i,{transition:0})||this;return r.context_={},r.executorGroups={},r.loadingSourceTiles=0,r.errorSourceTileKeys={},r.hitDetectionImageData={},r.replayState_={},r.sourceTiles=null,r.wantedResolution,r.getSourceTiles=o.bind(void 0,r),r.sourceZ=-1,r.hifi=!1,r.wrappedTileCoord=n,r}return Pl(e,t),e.prototype.getContext=function(t){var e=$t(t);return e in this.context_||(this.context_[e]=xn(1,1,Rl)),this.context_[e]},e.prototype.hasContext=function(t){return $t(t)in this.context_},e.prototype.getImage=function(t){return this.hasContext(t)?this.getContext(t).canvas:null},e.prototype.getReplayState=function(t){var e=$t(t);return e in this.replayState_||(this.replayState_[e]={dirty:!1,renderedRenderOrder:null,renderedResolution:NaN,renderedRevision:-1,renderedTileResolution:NaN,renderedTileRevision:-1,renderedZ:-1,renderedTileZ:-1}),this.replayState_[e]},e.prototype.load=function(){this.getSourceTiles()},e.prototype.release=function(){for(var e in this.context_)Rl.push(this.context_[e].canvas);t.prototype.release.call(this)},e}(El),kl=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),jl=function(t){function e(e,i,n,o,r,s){var a=t.call(this,e,i,s)||this;return a.extent=null,a.format_=o,a.features_=null,a.loader_,a.projection=null,a.resolution,a.tileLoadFunction_=r,a.url_=n,a}return kl(e,t),e.prototype.getFormat=function(){return this.format_},e.prototype.getFeatures=function(){return this.features_},e.prototype.getKey=function(){return this.url_},e.prototype.load=function(){this.state==bl&&(this.setState(wl),this.tileLoadFunction_(this,this.url_),this.loader_&&this.loader_(this.extent,this.resolution,this.projection))},e.prototype.onLoad=function(t,e){this.setFeatures(t)},e.prototype.onError=function(){this.setState(Sl)},e.prototype.setFeatures=function(t){this.features_=t,this.setState(xl)},e.prototype.setLoader=function(t){this.loader_=t},e}(El);function Ll(t,e){return Array.isArray(t)?t:(void 0===e?e=[t,t]:(e[0]=t,e[1]=t),e)}function Ml(t,e,i,n){return void 0!==n?(n[0]=t,n[1]=e,n[2]=i,n):[t,e,i]}function Fl(t,e,i){return t+"/"+e+"/"+i}function Dl(t){return Fl(t[0],t[1],t[2])}function Al(t){return t.split("/").map(Number)}function Nl(t,e){var i=/\{z\}/g,n=/\{x\}/g,o=/\{y\}/g,r=/\{-y\}/g;return function(s,a,u){return s?t.replace(i,s[0].toString()).replace(n,s[1].toString()).replace(o,s[2].toString()).replace(r,(function(){var t=s[0],i=e.getFullTileRange(t);return Ge(i,55),(i.getHeight()-s[2]-1).toString()})):void 0}}function Gl(t,e){for(var i=t.length,n=new Array(i),o=0;o<i;++o)n[o]=Nl(t[o],e);return function(t){if(1===t.length)return t[0];return function(e,i,n){if(e){var o=Gi(function(t){return(t[1]<<t[0])+t[2]}(e),t.length);return t[o](e,i,n)}}}(n)}function Bl(t,e,i){}var Yl=function(){function t(t){this.highWaterMark=void 0!==t?t:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}return t.prototype.canExpireCache=function(){return this.getCount()>this.highWaterMark},t.prototype.clear=function(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null},t.prototype.containsKey=function(t){return this.entries_.hasOwnProperty(t)},t.prototype.forEach=function(t){for(var e=this.oldest_;e;)t(e.value_,e.key_,this),e=e.newer},t.prototype.get=function(t,e){var i=this.entries_[t];return Ge(void 0!==i,15),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_},t.prototype.remove=function(t){var e=this.entries_[t];return Ge(void 0!==e,15),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_},t.prototype.getCount=function(){return this.count_},t.prototype.getKeys=function(){var t,e=new Array(this.count_),i=0;for(t=this.newest_;t;t=t.older)e[i++]=t.key_;return e},t.prototype.getValues=function(){var t,e=new Array(this.count_),i=0;for(t=this.newest_;t;t=t.older)e[i++]=t.value_;return e},t.prototype.peekLast=function(){return this.oldest_.value_},t.prototype.peekLastKey=function(){return this.oldest_.key_},t.prototype.peekFirstKey=function(){return this.newest_.key_},t.prototype.pop=function(){var t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_},t.prototype.replace=function(t,e){this.get(t),this.entries_[t].value_=e},t.prototype.set=function(t,e){Ge(!(t in this.entries_),16);var i={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[t]=i,++this.count_},t.prototype.setSize=function(t){this.highWaterMark=t},t}(),Xl=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),zl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Xl(e,t),e.prototype.expireCache=function(t){for(;this.canExpireCache();){if(this.peekLast().getKey()in t)break;this.pop().release()}},e.prototype.pruneExceptNewestZ=function(){if(0!==this.getCount()){var t=Al(this.peekFirstKey())[0];this.forEach(function(e){e.tileCoord[0]!==t&&(this.remove(Dl(e.tileCoord)),e.release())}.bind(this))}},e}(Yl),Wl=function(){function t(t,e,i,n){this.minX=t,this.maxX=e,this.minY=i,this.maxY=n}return t.prototype.contains=function(t){return this.containsXY(t[1],t[2])},t.prototype.containsTileRange=function(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY},t.prototype.containsXY=function(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY},t.prototype.equals=function(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY},t.prototype.extend=function(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)},t.prototype.getHeight=function(){return this.maxY-this.minY+1},t.prototype.getSize=function(){return[this.getWidth(),this.getHeight()]},t.prototype.getWidth=function(){return this.maxX-this.minX+1},t.prototype.intersects=function(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY},t}();function Vl(t,e,i,n,o){return void 0!==o?(o.minX=t,o.maxX=e,o.minY=i,o.maxY=n,o):new Wl(t,e,i,n)}var Kl=Wl,ql=[0,0,0],Hl=function(){function t(t){var e,i,n,o;if(this.minZoom=void 0!==t.minZoom?t.minZoom:0,this.resolutions_=t.resolutions,Ge((e=this.resolutions_,i=!0,n=function(t,e){return e-t}||de,e.every((function(t,o){if(0===o)return!0;var r=n(e[o-1],t);return!(r>0||i&&0===r)}))),17),!t.origins)for(var r=0,s=this.resolutions_.length-1;r<s;++r)if(o){if(this.resolutions_[r]/this.resolutions_[r+1]!==o){o=void 0;break}}else o=this.resolutions_[r]/this.resolutions_[r+1];this.zoomFactor_=o,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==t.origin?t.origin:null,this.origins_=null,void 0!==t.origins&&(this.origins_=t.origins,Ge(this.origins_.length==this.resolutions_.length,20));var a=t.extent;void 0===a||this.origin_||this.origins_||(this.origin_=_i(a)),Ge(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,void 0!==t.tileSizes&&(this.tileSizes_=t.tileSizes,Ge(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=void 0!==t.tileSize?t.tileSize:this.tileSizes_?null:256,Ge(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=void 0!==a?a:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],void 0!==t.sizes?this.fullTileRanges_=t.sizes.map((function(t,e){return new Kl(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1))}),this):a&&this.calculateTileRanges_(a)}return t.prototype.forEachTileCoord=function(t,e,i){for(var n=this.getTileRangeForExtentAndZ(t,e),o=n.minX,r=n.maxX;o<=r;++o)for(var s=n.minY,a=n.maxY;s<=a;++s)i([e,o,s])},t.prototype.forEachTileCoordParentTileRange=function(t,e,i,n){var o,r,s=null,a=t[0]-1;for(2===this.zoomFactor_?(o=t[1],r=t[2]):s=this.getTileCoordExtent(t,n);a>=this.minZoom;){if(e(a,2===this.zoomFactor_?Vl(o=Math.floor(o/2),o,r=Math.floor(r/2),r,i):this.getTileRangeForExtentAndZ(s,a,i)))return!0;--a}return!1},t.prototype.getExtent=function(){return this.extent_},t.prototype.getMaxZoom=function(){return this.maxZoom},t.prototype.getMinZoom=function(){return this.minZoom},t.prototype.getOrigin=function(t){return this.origin_?this.origin_:this.origins_[t]},t.prototype.getResolution=function(t){return this.resolutions_[t]},t.prototype.getResolutions=function(){return this.resolutions_},t.prototype.getTileCoordChildTileRange=function(t,e,i){if(t[0]<this.maxZoom){if(2===this.zoomFactor_){var n=2*t[1],o=2*t[2];return Vl(n,n+1,o,o+1,e)}var r=this.getTileCoordExtent(t,i);return this.getTileRangeForExtentAndZ(r,t[0]+1,e)}return null},t.prototype.getTileRangeExtent=function(t,e,i){var n=this.getOrigin(t),o=this.getResolution(t),r=Ll(this.getTileSize(t),this.tmpSize_),s=n[0]+e.minX*r[0]*o,a=n[0]+(e.maxX+1)*r[0]*o;return oi(s,n[1]+e.minY*r[1]*o,a,n[1]+(e.maxY+1)*r[1]*o,i)},t.prototype.getTileRangeForExtentAndZ=function(t,e,i){var n=ql;this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,n);var o=n[1],r=n[2];return this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,n),Vl(o,n[1],r,n[2],i)},t.prototype.getTileCoordCenter=function(t){var e=this.getOrigin(t[0]),i=this.getResolution(t[0]),n=Ll(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*n[0]*i,e[1]-(t[2]+.5)*n[1]*i]},t.prototype.getTileCoordExtent=function(t,e){var i=this.getOrigin(t[0]),n=this.getResolution(t[0]),o=Ll(this.getTileSize(t[0]),this.tmpSize_),r=i[0]+t[1]*o[0]*n,s=i[1]-(t[2]+1)*o[1]*n;return oi(r,s,r+o[0]*n,s+o[1]*n,e)},t.prototype.getTileCoordForCoordAndResolution=function(t,e,i){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,i)},t.prototype.getTileCoordForXYAndResolution_=function(t,e,i,n,o){var r=this.getZForResolution(i),s=i/this.getResolution(r),a=this.getOrigin(r),u=Ll(this.getTileSize(r),this.tmpSize_),l=n?.5:0,c=n?.5:0,h=Math.floor((t-a[0])/i+l),f=Math.floor((a[1]-e)/i+c),p=s*h/u[0],d=s*f/u[1];return n?(p=Math.ceil(p)-1,d=Math.ceil(d)-1):(p=Math.floor(p),d=Math.floor(d)),Ml(r,p,d,o)},t.prototype.getTileCoordForXYAndZ_=function(t,e,i,n,o){var r=this.getOrigin(i),s=this.getResolution(i),a=Ll(this.getTileSize(i),this.tmpSize_),u=n?.5:0,l=n?.5:0,c=Math.floor((t-r[0])/s+u),h=Math.floor((r[1]-e)/s+l),f=c/a[0],p=h/a[1];return n?(f=Math.ceil(f)-1,p=Math.ceil(p)-1):(f=Math.floor(f),p=Math.floor(p)),Ml(i,f,p,o)},t.prototype.getTileCoordForCoordAndZ=function(t,e,i){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,i)},t.prototype.getTileCoordResolution=function(t){return this.resolutions_[t[0]]},t.prototype.getTileSize=function(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]},t.prototype.getFullTileRange=function(t){return this.fullTileRanges_?this.fullTileRanges_[t]:null},t.prototype.getZForResolution=function(t,e){return Mi(ye(this.resolutions_,t,e||0),this.minZoom,this.maxZoom)},t.prototype.calculateTileRanges_=function(t){for(var e=this.resolutions_.length,i=new Array(e),n=this.minZoom;n<e;++n)i[n]=this.getTileRangeForExtentAndZ(t,n);this.fullTileRanges_=i},t}();function Zl(t){var e=t.getDefaultTileGrid();return e||(e=Ql(t),t.setDefaultTileGrid(e)),e}function Ul(t){var e=t||{},i=e.extent||Ko("EPSG:3857").getExtent(),n={extent:i,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:Jl(i,e.maxZoom,e.tileSize,e.maxResolution)};return new Hl(n)}function Jl(t,e,i,n){for(var o=void 0!==e?e:42,r=gi(t),s=wi(t),a=Ll(void 0!==i?i:256),u=n>0?n:Math.max(s/a[0],r/a[1]),l=o+1,c=new Array(l),h=0;h<l;++h)c[h]=u/Math.pow(2,h);return c}function Ql(t,e,i,n){return function(t,e,i,n){var o=void 0!==n?n:Xe,r=Jl(t,e,i);return new Hl({extent:t,origin:vi(t,o),resolutions:r,tileSize:i})}($l(t),e,i,n)}function $l(t){var e=(t=Ko(t)).getExtent();if(!e){var i=180*To[Oo.DEGREES]/t.getMetersPerUnit();e=oi(-i,-i,i,i)}return e}var tc=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ec=function(t){function e(e){var i=t.call(this,{attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX})||this;i.opaque_=void 0!==e.opaque&&e.opaque,i.tilePixelRatio_=void 0!==e.tilePixelRatio?e.tilePixelRatio:1,i.tileGrid=void 0!==e.tileGrid?e.tileGrid:null;var n=[256,256],o=e.tileGrid;o&&Ll(o.getTileSize(o.getMinZoom()),n);var r="undefined"!=typeof screen,s=r?screen.availWidth||screen.width:1920,a=r?screen.availHeight||screen.height:1080,u=4*Math.ceil(s/n[0])*Math.ceil(a/n[1]);return i.tileCache=new zl(Math.max(u,e.cacheSize||0)),i.tmpSize=[0,0],i.key_=e.key||"",i.tileOptions={transition:e.transition},i.zDirection=e.zDirection?e.zDirection:0,i}return tc(e,t),e.prototype.canExpireCache=function(){return this.tileCache.canExpireCache()},e.prototype.expireCache=function(t,e){var i=this.getTileCacheForProjection(t);i&&i.expireCache(e)},e.prototype.forEachLoadedTile=function(t,e,i,n){var o=this.getTileCacheForProjection(t);if(!o)return!1;for(var r,s,a,u=!0,l=i.minX;l<=i.maxX;++l)for(var c=i.minY;c<=i.maxY;++c)s=Fl(e,l,c),a=!1,o.containsKey(s)&&(a=(r=o.get(s)).getState()===xl)&&(a=!1!==n(r)),a||(u=!1);return u},e.prototype.getGutterForProjection=function(t){return 0},e.prototype.getKey=function(){return this.key_},e.prototype.setKey=function(t){this.key_!==t&&(this.key_=t,this.changed())},e.prototype.getOpaque=function(t){return this.opaque_},e.prototype.getResolutions=function(){return this.tileGrid.getResolutions()},e.prototype.getTile=function(t,e,i,n,o){return Jt()},e.prototype.getTileGrid=function(){return this.tileGrid},e.prototype.getTileGridForProjection=function(t){return this.tileGrid?this.tileGrid:Zl(t)},e.prototype.getTileCacheForProjection=function(t){var e=this.getProjection();return e&&!Zo(e,t)?null:this.tileCache},e.prototype.getTilePixelRatio=function(t){return this.tilePixelRatio_},e.prototype.getTilePixelSize=function(t,e,i){var n,o,r,s=this.getTileGridForProjection(i),a=this.getTilePixelRatio(e),u=Ll(s.getTileSize(t),this.tmpSize);return 1==a?u:(n=u,o=a,void 0===(r=this.tmpSize)&&(r=[0,0]),r[0]=n[0]*o+.5|0,r[1]=n[1]*o+.5|0,r)},e.prototype.getTileCoordForTileUrlFunction=function(t,e){var i=void 0!==e?e:this.getProjection(),n=this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(t=function(t,e,i){var n=e[0],o=t.getTileCoordCenter(e),r=$l(i);if($e(r,o))return e;var s=wi(r),a=Math.ceil((r[0]-o[0])/s);return o[0]+=s*a,t.getTileCoordForCoordAndZ(o,n)}(n,t,i)),function(t,e){var i=t[0],n=t[1],o=t[2];if(e.getMinZoom()>i||i>e.getMaxZoom())return!1;var r,s=e.getExtent();return!(r=s?e.getTileRangeForExtentAndZ(s,i):e.getFullTileRange(i))||r.containsXY(n,o)}(t,n)?t:null},e.prototype.clear=function(){this.tileCache.clear()},e.prototype.refresh=function(){this.clear(),t.prototype.refresh.call(this)},e.prototype.useTile=function(t,e,i,n){},e}(Ju),ic=function(t){function e(e,i){var n=t.call(this,e)||this;return n.tile=i,n}return tc(e,t),e}(we),nc=ec,oc="tileloadstart",rc="tileloadend",sc="tileloaderror",ac=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uc=function(t){function e(e){var i=t.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection})||this;return i.generateTileUrlFunction_=!e.tileUrlFunction,i.tileLoadFunction=e.tileLoadFunction,i.tileUrlFunction=e.tileUrlFunction?e.tileUrlFunction.bind(i):Bl,i.urls=null,e.urls?i.setUrls(e.urls):e.url&&i.setUrl(e.url),i.tileLoadingKeys_={},i}return ac(e,t),e.prototype.getTileLoadFunction=function(){return this.tileLoadFunction},e.prototype.getTileUrlFunction=function(){return this.tileUrlFunction},e.prototype.getUrls=function(){return this.urls},e.prototype.handleTileChange=function(t){var e,i=t.target,n=$t(i),o=i.getState();o==wl?(this.tileLoadingKeys_[n]=!0,e=oc):n in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[n],e=o==Sl?sc:o==xl?rc:void 0),null!=e&&this.dispatchEvent(new ic(e,i))},e.prototype.setTileLoadFunction=function(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()},e.prototype.setTileUrlFunction=function(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),void 0!==e?this.setKey(e):this.changed()},e.prototype.setUrl=function(t){var e=function(t){var e=[],i=/\{([a-z])-([a-z])\}/.exec(t);if(i){var n=i[1].charCodeAt(0),o=i[2].charCodeAt(0),r=void 0;for(r=n;r<=o;++r)e.push(t.replace(i[0],String.fromCharCode(r)));return e}if(i=/\{(\d+)-(\d+)\}/.exec(t)){for(var s=parseInt(i[2],10),a=parseInt(i[1],10);a<=s;a++)e.push(t.replace(i[0],a.toString()));return e}return e.push(t),e}(t);this.urls=e,this.setUrls(e)},e.prototype.setUrls=function(t){this.urls=t;var e=t.join("\n");this.generateTileUrlFunction_?this.setTileUrlFunction(Gl(t,this.tileGrid),e):this.setKey(e)},e.prototype.useTile=function(t,e,i){var n=Fl(t,e,i);this.tileCache.containsKey(n)&&this.tileCache.get(n)},e}(nc),lc=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),cc=function(t){function e(e){var i=this,n=e.projection||"EPSG:3857",o=e.extent||$l(n),r=e.tileGrid||Ul({extent:o,maxResolution:e.maxResolution,maxZoom:void 0!==e.maxZoom?e.maxZoom:22,minZoom:e.minZoom,tileSize:e.tileSize||512});return(i=t.call(this,{attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,opaque:!1,projection:n,state:e.state,tileGrid:r,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:hc,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:void 0===e.wrapX||e.wrapX,transition:e.transition,zDirection:void 0===e.zDirection?1:e.zDirection})||this).format_=e.format?e.format:null,i.loadingTiles_={},i.sourceTileCache=new zl(i.tileCache.highWaterMark),i.overlaps_=null==e.overlaps||e.overlaps,i.tileClass=e.tileClass?e.tileClass:jl,i.tileGrids_={},i}return lc(e,t),e.prototype.getFeaturesInExtent=function(t){var e=[],i=this.tileCache;if(0===i.getCount())return e;var n=Al(i.peekFirstKey())[0],o=this.tileGrid;return i.forEach((function(i){if(i.tileCoord[0]===n&&i.getState()===xl)for(var r=i.getSourceTiles(),s=0,a=r.length;s<a;++s){var u=r[s],l=u.tileCoord;if(xi(t,o.getTileCoordExtent(l))){var c=u.getFeatures();if(c)for(var h=0,f=c.length;h<f;++h){var p=c[h],d=p.getGeometry();xi(t,d.getExtent())&&e.push(p)}}}})),e},e.prototype.getOverlaps=function(){return this.overlaps_},e.prototype.clear=function(){this.tileCache.clear(),this.sourceTileCache.clear()},e.prototype.expireCache=function(e,i){t.prototype.expireCache.call(this,e,i),this.sourceTileCache.expireCache({})},e.prototype.getSourceTiles=function(t,e,i){var n=i.wrappedTileCoord,o=this.getTileGridForProjection(e),r=o.getTileCoordExtent(n),s=n[0],a=o.getResolution(s);Je(r,-a,r);var u=this.tileGrid,l=u.getExtent();l&&mi(r,l,r);var c,h,f,p=u.getZForResolution(a,1),d=u.getMinZoom(),y=i.sourceTiles;if(y&&y.length>0&&y[0].tileCoord[0]===p)c=y,h=!0,f=p;else{c=[],f=p+1;do{--f,h=!0,u.forEachTileCoord(r,f,function(n){var o,r=this.tileUrlFunction(n,t,e);if(void 0!==r)if(this.sourceTileCache.containsKey(r)){var s=(o=this.sourceTileCache.get(r)).getState();if(s===xl||s===Sl||s===Tl)return void c.push(o)}else f===p&&((o=new this.tileClass(n,bl,r,this.format_,this.tileLoadFunction)).extent=u.getTileCoordExtent(n),o.projection=e,o.resolution=u.getResolution(n[0]),this.sourceTileCache.set(r,o),o.addEventListener(Te,this.handleTileChange.bind(this)),o.load());h=h&&o&&o.getState()===xl,o&&o.getState()!==Tl&&i.getState()===bl&&(i.loadingSourceTiles++,o.addEventListener(Te,(function t(){var e=o.getState(),n=o.getKey();if(e===xl||e===Sl){e===xl?(o.removeEventListener(Te,t),i.loadingSourceTiles--,delete i.errorSourceTileKeys[n]):e===Sl&&(i.errorSourceTileKeys[n]=!0);var r=Object.keys(i.errorSourceTileKeys).length;i.loadingSourceTiles-r==0&&(i.hifi=0===r,i.sourceZ=p,i.setState(xl))}})))}.bind(this)),h||(c.length=0)}while(!h&&f>d)}return i.getState()===bl&&i.setState(wl),h&&(i.hifi=p===f,i.sourceZ=f,i.getState()<xl?i.setState(xl):y&&me(c,y)||(i.sourceTiles=c)),c},e.prototype.getTile=function(t,e,i,n,o){var r,s=Fl(t,e,i),a=this.getKey();if(this.tileCache.containsKey(s)&&(r=this.tileCache.get(s)).key===a)return r;var u=[t,e,i],l=this.getTileCoordForTileUrlFunction(u,o),c=this.getTileGrid().getExtent(),h=this.getTileGridForProjection(o);if(l&&c){var f=h.getTileCoordExtent(l);Je(f,-h.getResolution(t),f),xi(c,f)||(l=null)}var p=!0;if(null!==l){var d=this.tileGrid,y=h.getResolution(t),v=d.getZForResolution(y,1),g=h.getTileCoordExtent(l);Je(g,-y,g),d.forEachTileCoord(g,v,function(t){p=p&&!this.tileUrlFunction(t,n,o)}.bind(this))}var m=new Il(u,p?Tl:bl,l,this.getSourceTiles.bind(this,n,o));return m.key=a,r?(m.interimTile=r,m.refreshInterimChain(),this.tileCache.replace(s,m)):this.tileCache.set(s,m),m},e.prototype.getTileGridForProjection=function(t){var e=t.getCode(),i=this.tileGrids_[e];if(!i){var n=this.tileGrid;i=Ql(t,void 0,n?n.getTileSize(n.getMinZoom()):void 0),this.tileGrids_[e]=i}return i},e.prototype.getTilePixelRatio=function(t){return t},e.prototype.getTilePixelSize=function(t,e,i){var n=Ll(this.getTileGridForProjection(i).getTileSize(t),this.tmpSize);return[Math.round(n[0]*e),Math.round(n[1]*e)]},e}(uc);function hc(t,e){var i=Ku(e,t.getFormat(),t.onLoad.bind(t),t.onError.bind(t));t.setLoader(i)}var fc="preload",pc="useInterimTilesOnError",dc="image",yc="hybrid",vc="vector",gc=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),mc=function(t){function e(e){var i=t.call(this,e)||this;return i.extentChanged=!0,i.renderedExtent_=null,i.renderedPixelRatio,i.renderedProjection=null,i.renderedRevision,i.renderedTiles=[],i.newTiles_=!1,i.tmpExtent=[1/0,1/0,-1/0,-1/0],i.tmpTileRange_=new Kl(0,0,0,0),i}return gc(e,t),e.prototype.isDrawableTile=function(t){var e=this.getLayer(),i=t.getState(),n=e.getUseInterimTilesOnError();return i==xl||i==Tl||i==Sl&&!n},e.prototype.getTile=function(t,e,i,n){var o=n.pixelRatio,r=n.viewState.projection,s=this.getLayer(),a=s.getSource().getTile(t,e,i,o,r);return a.getState()==Sl&&(s.getUseInterimTilesOnError()?s.getPreload()>0&&(this.newTiles_=!0):a.setState(xl)),this.isDrawableTile(a)||(a=a.getInterimTile()),a},e.prototype.loadedTileCallback=function(e,i,n){return!!this.isDrawableTile(n)&&t.prototype.loadedTileCallback.call(this,e,i,n)},e.prototype.prepareFrame=function(t){return!!this.getLayer().getSource()},e.prototype.renderFrame=function(t,e){var i=t.layerStatesArray[t.layerIndex],n=t.viewState,o=n.projection,r=n.resolution,s=n.center,a=n.rotation,u=t.pixelRatio,l=this.getLayer(),c=l.getSource(),h=c.getRevision(),f=c.getTileGridForProjection(o),p=f.getZForResolution(r,c.zDirection),d=f.getResolution(p),y=t.extent,v=i.extent&&rr(i.extent,o);v&&(y=mi(y,rr(i.extent,o)));var g=c.getTilePixelRatio(u),m=Math.round(t.size[0]*g),_=Math.round(t.size[1]*g);if(a){var b=Math.round(Math.sqrt(m*m+_*_));m=b,_=b}var w=d*m/2/g,x=d*_/2/g,S=[s[0]-w,s[1]-x,s[0]+w,s[1]+x],T=f.getTileRangeForExtentAndZ(y,p),O={};O[p]={};var C=this.createLoadedTileFinder(c,o,O),E=this.tmpExtent,P=this.tmpTileRange_;this.newTiles_=!1;for(var R=T.minX;R<=T.maxX;++R)for(var I=T.minY;I<=T.maxY;++I){var k=this.getTile(p,R,I,t);if(this.isDrawableTile(k)){var j=$t(this);if(k.getState()==xl){O[p][k.tileCoord.toString()]=k;var L=k.inTransition(j);this.newTiles_||!L&&-1!==this.renderedTiles.indexOf(k)||(this.newTiles_=!0)}if(1===k.getAlpha(j,t.time))continue}var M=f.getTileCoordChildTileRange(k.tileCoord,P,E),F=!1;M&&(F=C(p+1,M)),F||f.forEachTileCoordParentTileRange(k.tileCoord,C,P,E)}var D=d/r;An(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/g,1/g,a,-m/2,-_/2);var A=io(this.pixelTransform);this.useContainer(e,A,i.opacity);var N=this.context,G=N.canvas;Nn(this.inversePixelTransform,this.pixelTransform),An(this.tempTransform_,m/2,_/2,D,D,0,-m/2,-_/2),G.width!=m||G.height!=_?(G.width=m,G.height=_):this.containerReused||N.clearRect(0,0,m,_),v&&this.clipUnrotated(N,t,v),this.preRender(N,t),this.renderedTiles.length=0;var B,Y,X,z=Object.keys(O).map(Number);z.sort(de),1!==i.opacity||this.containerReused&&!c.getOpaque(t.viewState.projection)?(B=[],Y=[]):z=z.reverse();for(var W=z.length-1;W>=0;--W){var V=z[W],K=c.getTilePixelSize(V,u,o),q=f.getResolution(V)/d,H=K[0]*q*D,Z=K[1]*q*D,U=f.getTileCoordForCoordAndZ(_i(S),V),J=f.getTileCoordExtent(U),Q=Fn(this.tempTransform_,[g*(J[0]-S[0])/d,g*(S[3]-J[3])/d]),$=g*c.getGutterForProjection(o),tt=O[V];for(var et in tt){var it=(k=tt[et]).tileCoord,nt=Q[0]-(U[1]-it[1])*H,ot=Math.round(nt+H),rt=Q[1]-(U[2]-it[2])*Z,st=Math.round(rt+Z),at=ot-(R=Math.round(nt)),ut=st-(I=Math.round(rt)),lt=p===V;if(!(L=lt&&1!==k.getAlpha($t(this),t.time)))if(B){N.save(),X=[R,I,R+at,I,R+at,I+ut,R,I+ut];for(var ct=0,ht=B.length;ct<ht;++ct)if(p!==V&&V<Y[ct]){var ft=B[ct];N.beginPath(),N.moveTo(X[0],X[1]),N.lineTo(X[2],X[3]),N.lineTo(X[4],X[5]),N.lineTo(X[6],X[7]),N.moveTo(ft[6],ft[7]),N.lineTo(ft[4],ft[5]),N.lineTo(ft[2],ft[3]),N.lineTo(ft[0],ft[1]),N.clip()}B.push(X),Y.push(V)}else N.clearRect(R,I,at,ut);this.drawTileImage(k,t,R,I,at,ut,$,lt,i.opacity),B&&!L&&N.restore(),this.renderedTiles.push(k),this.updateUsedTiles(t.usedTiles,c,k)}}return this.renderedRevision=h,this.renderedResolution=d,this.extentChanged=!this.renderedExtent_||!ai(this.renderedExtent_,S),this.renderedExtent_=S,this.renderedPixelRatio=u,this.renderedProjection=o,this.manageTilePyramid(t,c,f,u,o,y,p,l.getPreload()),this.scheduleExpireCache(t,c),this.postRender(N,t),i.extent&&N.restore(),A!==G.style.transform&&(G.style.transform=A),this.container},e.prototype.drawTileImage=function(t,e,i,n,o,r,s,a,u){var l=this.getTileImage(t);if(l){var c=$t(this),h=a?t.getAlpha(c,e.time):1,f=u*h,p=f!==this.context.globalAlpha;p&&(this.context.save(),this.context.globalAlpha=f),this.context.drawImage(l,s,s,l.width-2*s,l.height-2*s,i,n,o,r),p&&this.context.restore(),1!==h?e.animate=!0:a&&t.endTransition(c)}},e.prototype.getImage=function(){var t=this.context;return t?t.canvas:null},e.prototype.getTileImage=function(t){return t.getImage()},e.prototype.scheduleExpireCache=function(t,e){if(e.canExpireCache()){var i=function(t,e,i){var n=$t(t);n in i.usedTiles&&t.expireCache(i.viewState.projection,i.usedTiles[n])}.bind(null,e);t.postRenderFunctions.push(i)}},e.prototype.updateUsedTiles=function(t,e,i){var n=$t(e);n in t||(t[n]={}),t[n][i.getKey()]=!0},e.prototype.manageTilePyramid=function(t,e,i,n,o,r,s,a,u){var l=$t(e);l in t.wantedTiles||(t.wantedTiles[l]={});var c,h,f,p,d,y,v=t.wantedTiles[l],g=t.tileQueue;for(y=i.getMinZoom();y<=s;++y)for(h=i.getTileRangeForExtentAndZ(r,y,h),f=i.getResolution(y),p=h.minX;p<=h.maxX;++p)for(d=h.minY;d<=h.maxY;++d)s-y<=a?((c=e.getTile(y,p,d,n,o)).getState()==bl&&(v[c.getKey()]=!0,g.isKeyQueued(c.getKey())||g.enqueue([c,l,i.getTileCoordCenter(c.tileCoord),f])),void 0!==u&&u(c)):e.useTile(y,p,d,o)},e}(cs);mc.prototype.getLayer;var _c=mc,bc=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),wc={image:[Br,Dr,Gr,Nr,Yr],hybrid:[Br,Gr],vector:[]},xc={image:[Ar],hybrid:[Nr,Yr,Ar],vector:[Br,Dr,Gr,Nr,Yr,Ar]},Sc=function(t){function e(e){var i=t.call(this,e)||this;return i.boundHandleStyleImageChange_=i.handleStyleImageChange_.bind(i),i.dirty_=!1,i.renderedLayerRevision_,i.renderedPixelToCoordinateTransform_=null,i.renderedRotation_,i.renderTileImageQueue_={},i.tileListenerKeys_={},i.tmpTransform_=[1,0,0,1,0,0],i}return bc(e,t),e.prototype.prepareTile=function(t,e,i,n){var o,r=$t(t),s=t.getState();return(s===xl&&t.hifi||s===Sl)&&r in this.tileListenerKeys_&&(fe(this.tileListenerKeys_[r]),delete this.tileListenerKeys_[r]),s!==xl&&s!==Sl||(this.updateExecutorGroup_(t,e,i),this.tileImageNeedsRender_(t,e,i)&&(o=!0,n&&(this.renderTileImageQueue_[r]=t))),o},e.prototype.getTile=function(e,i,n,o){var r=o.pixelRatio,s=o.viewState,a=s.resolution,u=s.projection,l=this.getLayer(),c=l.getSource().getTile(e,i,n,r,u);if(c.getState()<xl){c.wantedResolution=a;var h=$t(c);if(!(h in this.tileListenerKeys_)){var f=ce(c,Te,this.prepareTile.bind(this,c,r,u,!0));this.tileListenerKeys_[h]=f}}else{var p=o.viewHints;!!(p[_o]||p[bo])&&c.wantedResolution||(c.wantedResolution=a),this.prepareTile(c,r,u,!1)&&l.getRenderMode()!==vc&&this.renderTileImage_(c,o)}return t.prototype.getTile.call(this,e,i,n,o)},e.prototype.isDrawableTile=function(e){var i=this.getLayer();return t.prototype.isDrawableTile.call(this,e)&&i.getRenderMode()===vc||e.hasContext(i)},e.prototype.getTileImage=function(t){return t.getImage(this.getLayer())},e.prototype.prepareFrame=function(e){var i=this.getLayer().getRevision();return this.renderedLayerRevision_!=i&&(this.renderedTiles.length=0),this.renderedLayerRevision_=i,t.prototype.prepareFrame.call(this,e)},e.prototype.updateExecutorGroup_=function(t,e,i){var n=this.getLayer(),o=n.getRevision(),r=n.getRenderOrder()||null,s=t.wantedResolution,a=t.getReplayState(n);if(a.dirty||a.renderedResolution!==s||a.renderedRevision!=o||a.renderedRenderOrder!=r||a.renderedZ!==t.sourceZ){var u=n.getSource(),l=u.getTileGrid(),c=u.getTileGridForProjection(i).getTileCoordExtent(t.wrappedTileCoord),h=u.getSourceTiles(e,i,t),f=$t(n);delete t.hitDetectionImageData[f],t.executorGroups[f]=[];for(var p=function(i,o){var p=h[i];if(p.getState()!=xl)return"continue";var y=p.tileCoord,v=l.getTileCoordExtent(y),g=mi(c,v),m=ai(v,g)?null:Je(g,n.getRenderBuffer()*s,d.tmpExtent);a.dirty=!1;var _=new Mr(0,g,s,e,n.getDeclutter()),b=ps(s,e),w=function(t){var e,i=t.getStyleFunction()||n.getStyleFunction();if(i&&(e=i(t,s)),e){var o=this.renderFeature(t,b,e,_);this.dirty_=this.dirty_||o,a.dirty=a.dirty||o}},x=p.getFeatures();r&&r!==a.renderedRenderOrder&&x.sort(r);for(var S=0,T=x.length;S<T;++S){var O=x[S];m&&!xi(m,O.getGeometry().getExtent())||w.call(d,O)}var C=_.finish(),E=n.getRenderMode()!==vc&&n.getDeclutter()&&1===h.length?null:g,P=new os(E,s,e,u.getOverlaps(),C,n.getRenderBuffer());t.executorGroups[f].push(P)},d=this,y=0,v=h.length;y<v;++y)p(y);a.renderedRevision=o,a.renderedZ=t.sourceZ,a.renderedRenderOrder=r,a.renderedResolution=s}},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,n,o){var r=e.viewState.resolution,s=e.viewState.rotation;i=null==i?0:i;var a,u,l,c=this.getLayer(),h=c.getDeclutter(),f=c.getSource().getTileGridForProjection(e.viewState.projection),p={},d=this.renderedTiles,y=function(){var e=d[u],l=$e(f.getTileCoordExtent(e.wrappedTileCoord),t);if(!h&&!l)return"continue";for(var y=e.executorGroups[$t(c)],v=0,g=y.length;v<g;++v){var m=y[v];a=a||m.forEachFeatureAtCoordinate(t,r,s,i,(function(t){if(l||o&&-1!==o.indexOf(t)){var e=t.getId();if(void 0===e&&(e=$t(t)),!(e in p))return p[e]=!0,n(t,c)}}),c.getDeclutter()?o:null)}};for(u=0,l=d.length;u<l;++u)y();return a},e.prototype.getFeatures=function(t){return new Promise(function(e,i){for(var n,o=this.getLayer(),r=$t(o),s=o.getSource(),a=this.renderedProjection,u=a.getExtent(),l=this.renderedResolution,c=s.getTileGridForProjection(a),h=Fn(this.renderedPixelToCoordinateTransform_,t.slice()),f=c.getTileCoordForCoordAndResolution(h,l),p=0,d=this.renderedTiles.length;p<d;++p)if(f.toString()===this.renderedTiles[p].tileCoord.toString()){if((n=this.renderedTiles[p]).getState()===xl&&n.hifi){var y=c.getTileCoordExtent(n.tileCoord);s.getWrapX()&&a.canWrapX()&&!ti(u,y)&&wo(h,a);break}n=void 0}if(!n||n.loadingSourceTiles>0)e([]);else{var v=_i(c.getTileCoordExtent(n.wrappedTileCoord)),g=[(h[0]-v[0])/l,(v[1]-h[1])/l],m=n.getSourceTiles().reduce((function(t,e){return t.concat(e.getFeatures())}),[]),_=n.hitDetectionImageData[r];if(!_&&!this.animatingOrInteracting_){var b=Ll(c.getTileSize(c.getZForResolution(l))),w=[b[0]/2,b[1]/2],x=this.renderedRotation_;_=Ks(b,[this.getRenderTransform(c.getTileCoordCenter(n.wrappedTileCoord),l,0,.5,w[0],w[1],0)],m,o.getStyleFunction(),c.getTileCoordExtent(n.wrappedTileCoord),n.getReplayState(o).renderedResolution,x),n.hitDetectionImageData[r]=_}e(qs(g,m,_))}}.bind(this))},e.prototype.handleFontsChanged=function(){ae(this.renderTileImageQueue_);var t=this.getLayer();t.getVisible()&&void 0!==this.renderedLayerRevision_&&t.changed()},e.prototype.handleStyleImageChange_=function(t){this.renderIfReadyAndVisible()},e.prototype.renderFrame=function(e,i){var n=e.viewHints,o=!(n[_o]||n[bo]);this.renderQueuedTileImages_(o,e),t.prototype.renderFrame.call(this,e,i),this.renderedPixelToCoordinateTransform_=e.pixelToCoordinateTransform.slice(),this.renderedRotation_=e.viewState.rotation;var r=this.getLayer(),s=r.getRenderMode();if(s===dc)return this.container;var a=r.getSource(),u=e.usedTiles[$t(a)];for(var l in this.renderTileImageQueue_)u&&l in u||delete this.renderTileImageQueue_[l];for(var c=this.context,h=r.getDeclutter()?{}:null,f=xc[s],p=e.pixelRatio,d=e.viewState,y=d.center,v=d.resolution,g=d.rotation,m=e.size,_=Math.round(m[0]*p),b=Math.round(m[1]*p),w=this.renderedTiles,x=a.getTileGridForProjection(e.viewState.projection),S=[],T=[],O=w.length-1;O>=0;--O)for(var C=w[O],E=C.tileCoord,P=x.getTileCoordExtent(C.wrappedTileCoord),R=x.getTileCoordExtent(E,this.tmpExtent)[0]-P[0],I=Ln(Dn(this.inversePixelTransform.slice(),1/p,1/p),this.getRenderTransform(y,v,g,p,_,b,R)),k=C.executorGroups[$t(r)],j=!1,L=0,M=k.length;L<M;++L){var F=k[L];if(F.hasExecutors(f)){var D=C.tileCoord[0],A=void 0;if(!h&&!j){A=F.getClipCoords(I),c.save();for(var N=0,G=S.length;N<G;++N){var B=S[N];D<T[N]&&(c.beginPath(),c.moveTo(A[0],A[1]),c.lineTo(A[2],A[3]),c.lineTo(A[4],A[5]),c.lineTo(A[6],A[7]),c.moveTo(B[6],B[7]),c.lineTo(B[4],B[5]),c.lineTo(B[2],B[3]),c.lineTo(B[0],B[1]),c.clip())}}F.execute(c,I,g,o,f,h),h||j||(c.restore(),S.push(A),T.push(D),j=!0)}}h&&ns(h,c,g,e.layerStatesArray[e.layerIndex].opacity,o,e.declutterItems);return this.container},e.prototype.renderQueuedTileImages_=function(t,e){for(var i in this.renderTileImageQueue_){if(!t&&Date.now()-e.time>8){e.animate=!0;break}var n=this.renderTileImageQueue_[i];delete this.renderTileImageQueue_[i],this.renderTileImage_(n,e)}},e.prototype.renderFeature=function(t,e,i,n){if(!i)return!1;var o=!1;if(Array.isArray(i))for(var r=0,s=i.length;r<s;++r)o=ys(n,t,i[r],e,this.boundHandleStyleImageChange_)||o;else o=ys(n,t,i,e,this.boundHandleStyleImageChange_);return o},e.prototype.tileImageNeedsRender_=function(t,e,i){var n=this.getLayer(),o=t.getReplayState(n),r=n.getRevision(),s=t.sourceZ,a=t.wantedResolution;return o.renderedTileResolution!==a||o.renderedTileRevision!==r||o.renderedTileZ!==s},e.prototype.renderTileImage_=function(t,e){var i=this.getLayer(),n=t.getReplayState(i),o=i.getRevision(),r=t.executorGroups[$t(i)];n.renderedTileRevision=o,n.renderedTileZ=t.sourceZ;var s=t.wrappedTileCoord,a=s[0],u=i.getSource(),l=e.pixelRatio,c=e.viewState.projection,h=u.getTileGridForProjection(c),f=h.getResolution(t.tileCoord[0]),p=e.pixelRatio/t.wantedResolution*f,d=h.getResolution(a),y=t.getContext(i);l=Math.max(l,p/l);var v=u.getTilePixelSize(a,l,c);y.canvas.width=v[0],y.canvas.height=v[1];var g=l/p;if(1!==g){var m=jn(this.tmpTransform_);Dn(m,g,g),y.setTransform.apply(y,m)}var _=h.getTileCoordExtent(s,this.tmpExtent),b=p/d,w=jn(this.tmpTransform_);Dn(w,b,-b),function(t,e,i){Ln(t,Mn(kn,1,0,0,1,e,i))}(w,-_[0],-_[3]);for(var x=0,S=r.length;x<S;++x){r[x].execute(y,w,0,!0,wc[i.getRenderMode()])}n.renderedTileResolution=t.wantedResolution},e}(_c),Tc=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Oc=function(t){function e(e){var i=this,n=e||{},o=se({},n);delete o.preload,delete o.useInterimTilesOnError,i=t.call(this,o)||this;var r=n.renderMode||yc;return Ge(null==r||r==dc||r==yc||r==vc,28),i.renderMode_=r,i.setPreload(n.preload?n.preload:0),i.setUseInterimTilesOnError(void 0===n.useInterimTilesOnError||n.useInterimTilesOnError),i}return Tc(e,t),e.prototype.createRenderer=function(){return new Sc(this)},e.prototype.getFeatures=function(e){return t.prototype.getFeatures.call(this,e)},e.prototype.getRenderMode=function(){return this.renderMode_},e.prototype.getPreload=function(){return this.get(fc)},e.prototype.getUseInterimTilesOnError=function(){return this.get(pc)},e.prototype.setPreload=function(t){this.set(fc,t)},e.prototype.setUseInterimTilesOnError=function(t){this.set(pc,t)},e}(mo);function Cc(t){return(Cc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ec(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Pc(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Rc(t,e){return(Rc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ic(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=jc(t);if(e){var o=jc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return kc(this,i)}}function kc(t,e){return!e||"object"!==Cc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function jc(t){return(jc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Lc=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Rc(t,e)}(r,t);var e,i,n,o=Ic(r);function r(){return Ec(this,r),o.apply(this,arguments)}return e=r,(i=[{key:"makeOLLayer",value:function(){var t={source:this.options.ol.source,events:this.options.ol.events,style:this.options.ol.style};if(!("refresh"in t.source)){var e=t.source;!("tileUrlFunction"in e)&&void 0!==this.options.url&&"format"in e&&void 0!==e.format&&(e.url=this.options.url),"projection"in e&&void 0!==e.projection||(e.projection="EPSG:4326"),t.source=new cc(e)}return"function"==typeof t.style&&(t.style=t.style.bind(this)),this.className&&(t.className=this.className),new Oc(t)}}])&&Pc(e.prototype,i),n&&Pc(e,n),r}(pl);function Mc(t){return(Mc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Fc(t,e){return(Fc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Dc(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Nc(t);if(e){var o=Nc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Ac(this,i)}}function Ac(t,e){return!e||"object"!==Mc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Nc(t){return(Nc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Gc=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Fc(t,e)}(i,t);var e=Dc(i);function i(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(n=e.call(this,t)).options.ol.source.format=new Wu,n}return i}(Lc);function Bc(t,e,i,n){var o=Qo(i,e,t),r=qo(e,n,i),s=e.getMetersPerUnit();void 0!==s&&(r*=s);var a=t.getMetersPerUnit();void 0!==a&&(r/=a);var u=t.getExtent();if(!u||$e(u,o)){var l=qo(t,r,o)/r;isFinite(l)&&l>0&&(r/=l)}return r}function Yc(t,e,i,n){var o=i-t,r=n-e,s=Math.sqrt(o*o+r*r);return[Math.round(i+o/s),Math.round(n+r/s)]}function Xc(t,e,i,n,o,r,s,a,u,l,c){var h=xn(Math.round(i*t),Math.round(i*e));if(0===u.length)return h.canvas;h.scale(i,i);var f=[1/0,1/0,-1/0,-1/0];u.forEach((function(t,e,i){ui(f,t.extent)}));var p=wi(f),d=gi(f),y=xn(Math.round(i*p/n),Math.round(i*d/n)),v=i/n;u.forEach((function(t,e,i){var n=t.extent[0]-f[0],o=-(t.extent[3]-f[3]),r=wi(t.extent),s=gi(t.extent);y.drawImage(t.image,l,l,t.image.width-2*l,t.image.height-2*l,n*v,o*v,r*v,s*v)}));var g=_i(s);return a.getTriangles().forEach((function(t,e,o){var s=t.source,a=t.target,u=s[0][0],l=s[0][1],c=s[1][0],p=s[1][1],d=s[2][0],v=s[2][1],m=(a[0][0]-g[0])/r,_=-(a[0][1]-g[1])/r,b=(a[1][0]-g[0])/r,w=-(a[1][1]-g[1])/r,x=(a[2][0]-g[0])/r,S=-(a[2][1]-g[1])/r,T=u,O=l;u=0,l=0;var C=function(t){for(var e=t.length,i=0;i<e;i++){for(var n=i,o=Math.abs(t[i][i]),r=i+1;r<e;r++){var s=Math.abs(t[r][i]);s>o&&(o=s,n=r)}if(0===o)return null;var a=t[n];t[n]=t[i],t[i]=a;for(var u=i+1;u<e;u++)for(var l=-t[u][i]/t[i][i],c=i;c<e+1;c++)i==c?t[u][c]=0:t[u][c]+=l*t[i][c]}for(var h=new Array(e),f=e-1;f>=0;f--){h[f]=t[f][e]/t[f][f];for(var p=f-1;p>=0;p--)t[p][e]-=t[p][f]*h[f]}return h}([[c-=T,p-=O,0,0,b-m],[d-=T,v-=O,0,0,x-m],[0,0,c,p,w-_],[0,0,d,v,S-_]]);if(C){h.save(),h.beginPath();var E=(m+b+x)/3,P=(_+w+S)/3,R=Yc(E,P,m,_),I=Yc(E,P,b,w),k=Yc(E,P,x,S);h.moveTo(I[0],I[1]),h.lineTo(R[0],R[1]),h.lineTo(k[0],k[1]),h.clip(),h.transform(C[0],C[2],C[1],C[3],m,_),h.translate(f[0]-T,f[3]-O),h.scale(n/i,-n/i),h.drawImage(y.canvas,0,0),h.restore()}})),c&&(h.save(),h.strokeStyle="black",h.lineWidth=1,a.getTriangles().forEach((function(t,e,i){var n=t.target,o=(n[0][0]-g[0])/r,s=-(n[0][1]-g[1])/r,a=(n[1][0]-g[0])/r,u=-(n[1][1]-g[1])/r,l=(n[2][0]-g[0])/r,c=-(n[2][1]-g[1])/r;h.beginPath(),h.moveTo(a,u),h.lineTo(o,s),h.lineTo(l,c),h.closePath(),h.stroke()})),h.restore()),h.canvas}var zc=function(){function t(t,e,i,n,o,r){this.sourceProj_=t,this.targetProj_=e;var s={},a=Jo(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){var e=t[0]+"/"+t[1];return s[e]||(s[e]=a(t)),s[e]},this.maxSourceExtent_=n,this.errorThresholdSquared_=o*o,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!n&&!!this.sourceProj_.getExtent()&&wi(n)==wi(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?wi(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?wi(this.targetProj_.getExtent()):null;var u=_i(i),l=bi(i),c=di(i),h=pi(i),f=this.transformInv_(u),p=this.transformInv_(l),d=this.transformInv_(c),y=this.transformInv_(h),v=10+(r?Math.max(0,Math.ceil(Math.log2(fi(i)/(r*r*256*256)))):0);if(this.addQuad_(u,l,c,h,f,p,d,y,v),this.wrapsXInSource_){var g=1/0;this.triangles_.forEach((function(t,e,i){g=Math.min(g,t.source[0][0],t.source[1][0],t.source[2][0])})),this.triangles_.forEach(function(t){if(Math.max(t.source[0][0],t.source[1][0],t.source[2][0])-g>this.sourceWorldWidth_/2){var e=[[t.source[0][0],t.source[0][1]],[t.source[1][0],t.source[1][1]],[t.source[2][0],t.source[2][1]]];e[0][0]-g>this.sourceWorldWidth_/2&&(e[0][0]-=this.sourceWorldWidth_),e[1][0]-g>this.sourceWorldWidth_/2&&(e[1][0]-=this.sourceWorldWidth_),e[2][0]-g>this.sourceWorldWidth_/2&&(e[2][0]-=this.sourceWorldWidth_);var i=Math.min(e[0][0],e[1][0],e[2][0]);Math.max(e[0][0],e[1][0],e[2][0])-i<this.sourceWorldWidth_/2&&(t.source=e)}}.bind(this))}s={}}return t.prototype.addTriangle_=function(t,e,i,n,o,r){this.triangles_.push({source:[n,o,r],target:[t,e,i]})},t.prototype.addQuad_=function(t,e,i,n,o,r,s,a,u){var l=Ue([o,r,s,a]),c=this.sourceWorldWidth_?wi(l)/this.sourceWorldWidth_:null,h=this.sourceWorldWidth_,f=this.sourceProj_.canWrapX()&&c>.5&&c<1,p=!1;if(u>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_)p=wi(Ue([t,e,i,n]))/this.targetWorldWidth_>.25||p;!f&&this.sourceProj_.isGlobal()&&c&&(p=c>.25||p)}if(p||!this.maxSourceExtent_||xi(l,this.maxSourceExtent_)){if(!(p||isFinite(o[0])&&isFinite(o[1])&&isFinite(r[0])&&isFinite(r[1])&&isFinite(s[0])&&isFinite(s[1])&&isFinite(a[0])&&isFinite(a[1]))){if(!(u>0))return;p=!0}if(u>0){if(!p){var d=[(t[0]+i[0])/2,(t[1]+i[1])/2],y=this.transformInv_(d),v=void 0;if(f)v=(Gi(o[0],h)+Gi(s[0],h))/2-Gi(y[0],h);else v=(o[0]+s[0])/2-y[0];var g=(o[1]+s[1])/2-y[1];p=v*v+g*g>this.errorThresholdSquared_}if(p){if(Math.abs(t[0]-i[0])<=Math.abs(t[1]-i[1])){var m=[(e[0]+i[0])/2,(e[1]+i[1])/2],_=this.transformInv_(m),b=[(n[0]+t[0])/2,(n[1]+t[1])/2],w=this.transformInv_(b);this.addQuad_(t,e,m,b,o,r,_,w,u-1),this.addQuad_(b,m,i,n,w,_,s,a,u-1)}else{var x=[(t[0]+e[0])/2,(t[1]+e[1])/2],S=this.transformInv_(x),T=[(i[0]+n[0])/2,(i[1]+n[1])/2],O=this.transformInv_(T);this.addQuad_(t,x,T,n,o,S,O,a,u-1),this.addQuad_(x,e,i,T,S,r,s,O,u-1)}return}}if(f){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}this.addTriangle_(t,i,n,o,s,a),this.addTriangle_(t,e,i,o,r,s)}},t.prototype.calculateSourceExtent=function(){var t=[1/0,1/0,-1/0,-1/0];return this.triangles_.forEach((function(e,i,n){var o=e.source;li(t,o[0]),li(t,o[1]),li(t,o[2])})),t},t.prototype.getTriangles=function(){return this.triangles_},t}(),Wc=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Vc=function(t){function e(e,i,n,o,r,s){var a=this,u=e.getExtent(),l=i.getExtent(),c=l?mi(n,l):n,h=Bc(e,i,yi(c),o),f=new zc(e,i,c,u,.5*h,o),p=s(f.calculateSourceExtent(),h,r),d=p?Sn:En,y=p?p.getPixelRatio():1;return(a=t.call(this,n,o,y,d)||this).targetProj_=i,a.maxSourceExtent_=u,a.triangulation_=f,a.targetResolution_=o,a.targetExtent_=n,a.sourceImage_=p,a.sourcePixelRatio_=y,a.canvas_=null,a.sourceListenerKey_=null,a}return Wc(e,t),e.prototype.disposeInternal=function(){this.state==Tn&&this.unlistenSource_(),t.prototype.disposeInternal.call(this)},e.prototype.getImage=function(){return this.canvas_},e.prototype.getProjection=function(){return this.targetProj_},e.prototype.reproject_=function(){var t=this.sourceImage_.getState();if(t==On){var e=wi(this.targetExtent_)/this.targetResolution_,i=gi(this.targetExtent_)/this.targetResolution_;this.canvas_=Xc(e,i,this.sourcePixelRatio_,this.sourceImage_.getResolution(),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0)}this.state=t,this.changed()},e.prototype.load=function(){if(this.state==Sn){this.state=Tn,this.changed();var t=this.sourceImage_.getState();t==On||t==Cn?this.reproject_():(this.sourceListenerKey_=ce(this.sourceImage_,Te,(function(t){var e=this.sourceImage_.getState();e!=On&&e!=Cn||(this.unlistenSource_(),this.reproject_())}),this),this.sourceImage_.load())}},e.prototype.unlistenSource_=function(){fe(this.sourceListenerKey_),this.sourceListenerKey_=null},e}(Ms),Kc=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),qc="imageloadstart",Hc="imageloadend",Zc="imageloaderror",Uc=function(t){function e(e,i){var n=t.call(this,e)||this;return n.image=i,n}return Kc(e,t),e}(we);function Jc(t,e){t.getImage().src=e}var Qc=function(t){function e(e){var i=t.call(this,{attributions:e.attributions,projection:e.projection,state:e.state})||this;return i.resolutions_=void 0!==e.resolutions?e.resolutions:null,i.reprojectedImage_=null,i.reprojectedRevision_=0,i}return Kc(e,t),e.prototype.getResolutions=function(){return this.resolutions_},e.prototype.findNearestResolution=function(t){if(this.resolutions_){var e=ye(this.resolutions_,t,0);t=this.resolutions_[e]}return t},e.prototype.getImage=function(t,e,i,n){var o=this.getProjection();if(o&&n&&!Zo(o,n)){if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&Zo(this.reprojectedImage_.getProjection(),n)&&this.reprojectedImage_.getResolution()==e&&ai(this.reprojectedImage_.getExtent(),t))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new Vc(o,n,t,e,i,function(t,e,i){return this.getImageInternal(t,e,i,o)}.bind(this)),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}return o&&(n=o),this.getImageInternal(t,e,i,n)},e.prototype.getImageInternal=function(t,e,i,n){return Jt()},e.prototype.handleImageChange=function(t){var e=t.target;switch(e.getState()){case Tn:this.loading=!0,this.dispatchEvent(new Uc(qc,e));break;case On:this.loading=!1,this.dispatchEvent(new Uc(Hc,e));break;case Cn:this.loading=!1,this.dispatchEvent(new Uc(Zc,e))}},e}(Ju),$c=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),th=function(t){function e(e){var i=this,n=void 0!==e.crossOrigin?e.crossOrigin:null,o=void 0!==e.imageLoadFunction?e.imageLoadFunction:Jc;return(i=t.call(this,{attributions:e.attributions,projection:Ko(e.projection)})||this).url_=e.url,i.imageExtent_=e.imageExtent,i.image_=new As(i.imageExtent_,void 0,1,i.url_,n,o),i.imageSize_=e.imageSize?e.imageSize:null,i.image_.addEventListener(Te,i.handleImageChange.bind(i)),i}return $c(e,t),e.prototype.getImageExtent=function(){return this.imageExtent_},e.prototype.getImageInternal=function(t,e,i,n){return xi(t,this.image_.getExtent())?this.image_:null},e.prototype.getUrl=function(){return this.url_},e.prototype.handleImageChange=function(e){if(this.image_.getState()==On){var i=this.image_.getExtent(),n=this.image_.getImage(),o=void 0,r=void 0;this.imageSize_?(o=this.imageSize_[0],r=this.imageSize_[1]):(o=n.width,r=n.height);var s=gi(i)/r,a=Math.ceil(wi(i)/s);if(a!=o){var u=xn(a,r),l=u.canvas;u.drawImage(n,0,0,o,r,0,0,l.width,l.height),this.image_.setImage(l)}}t.prototype.handleImageChange.call(this,e)},e}(Qc),eh=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ih=function(t){function e(e){var i=e||{};return t.call(this,i)||this}return eh(e,t),e}(Qi),nh=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),oh=function(t){function e(e){var i=t.call(this,e)||this;return i.image_=null,i}return nh(e,t),e.prototype.getImage=function(){return this.image_?this.image_.getImage():null},e.prototype.prepareFrame=function(t){var e=t.layerStatesArray[t.layerIndex],i=t.pixelRatio,n=t.viewState,o=n.resolution,r=this.getLayer().getSource(),s=t.viewHints,a=t.extent;if(void 0!==e.extent&&(a=mi(a,rr(e.extent,n.projection))),!s[_o]&&!s[bo]&&!Si(a))if(r){var u=n.projection,l=r.getImage(a,o,i,u);l&&this.loadImage(l)&&(this.image_=l)}else this.image_=null;return!!this.image_},e.prototype.renderFrame=function(t,e){var i=this.image_,n=i.getExtent(),o=i.getResolution(),r=i.getPixelRatio(),s=t.layerStatesArray[t.layerIndex],a=t.pixelRatio,u=t.viewState,l=u.center,c=u.resolution,h=t.size,f=a*o/(c*r),p=Math.round(h[0]*a),d=Math.round(h[1]*a),y=u.rotation;if(y){var v=Math.round(Math.sqrt(p*p+d*d));p=v,d=v}An(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/a,1/a,y,-p/2,-d/2),Nn(this.inversePixelTransform,this.pixelTransform);var g=io(this.pixelTransform);this.useContainer(e,g,s.opacity);var m=this.context,_=m.canvas;_.width!=p||_.height!=d?(_.width=p,_.height=d):this.containerReused||m.clearRect(0,0,p,d);var b=!1;if(s.extent){var w=rr(s.extent,u.projection);(b=!ti(w,t.extent)&&xi(w,t.extent))&&this.clipUnrotated(m,t,w)}var x=i.getImage(),S=An(this.tempTransform_,p/2,d/2,f,f,0,r*(n[0]-l[0])/o,r*(l[1]-n[3])/o);this.renderedResolution=o*a/r;var T=S[4],O=S[5],C=x.width*S[0],E=x.height*S[3];if(this.preRender(m,t),C>=.5&&E>=.5){var P=s.opacity,R=void 0;1!==P&&(R=this.context.globalAlpha,this.context.globalAlpha=P),this.context.drawImage(x,0,0,+x.width,+x.height,Math.round(T),Math.round(O),Math.round(C),Math.round(E)),1!==P&&(this.context.globalAlpha=R)}return this.postRender(m,t),b&&m.restore(),g!==_.style.transform&&(_.style.transform=g),this.container},e}(cs),rh=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),sh=function(t){function e(e){return t.call(this,e)||this}return rh(e,t),e.prototype.createRenderer=function(){return new oh(this)},e}(ih);function ah(t){return(ah="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function uh(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function lh(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ch(t,e){return(ch=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function hh(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=ph(t);if(e){var o=ph(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return fh(this,i)}}function fh(t,e){return!e||"object"!==ah(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ph(t){return(ph=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var dh=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ch(t,e)}(r,t);var e,i,n,o=hh(r);function r(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.url,n=void 0===i?void 0:i,s=e.datetime,a=void 0===s?void 0:s,u=e.mimetype,l=void 0===u?void 0:u,c=e.reloadTime,h=void 0===c?void 0:c,f=e.className,p=void 0===f?void 0:f,d=e.extent,y=e.ol,v=void 0===y?{}:y;return uh(this,r),(t=o.call(this,{url:n,datetime:a,mimetype:l,reloadTime:h,className:p,ol:v})).options.extent=d,t}return e=r,(i=[{key:"makeOLLayer",value:function(){var t=this.options.ol.source;return t.url=this.options.url,t.imageExtent=$o(this.options.extent,"EPSG:4326","EPSG:3857"),new sh({source:new th(t),className:this.className})}},{key:"makeLLLayer",value:function(){return L.imageOverlay(this.options.url,[[this.options.extent[1],this.options.extent[0]],[this.options.extent[3],this.options.extent[2]]])}}])&&lh(e.prototype,i),n&&lh(e,n),r}(ea),yh=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();var vh=function(t){function e(e,i,n,o,r,s){var a=t.call(this,e,i,s)||this;return a.crossOrigin_=o,a.src_=n,a.image_=new Image,null!==o&&(a.image_.crossOrigin=o),a.unlisten_=null,a.tileLoadFunction_=r,a}return yh(e,t),e.prototype.getImage=function(){return this.image_},e.prototype.getKey=function(){return this.src_},e.prototype.handleImageError_=function(){var t;this.state=Sl,this.unlistenImage_(),this.image_=((t=xn(1,1)).fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas),this.changed()},e.prototype.handleImageLoad_=function(){var t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=xl:this.state=Tl,this.unlistenImage_(),this.changed()},e.prototype.load=function(){this.state==Sl&&(this.state=bl,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==bl&&(this.state=wl,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=Ds(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))},e.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},e}(El),gh=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),mh=function(t){function e(e,i,n,o,r,s,a,u,l,c,h){var f=t.call(this,r,bl)||this;f.renderEdges_=void 0!==h&&h,f.pixelRatio_=a,f.gutter_=u,f.canvas_=null,f.sourceTileGrid_=i,f.targetTileGrid_=o,f.wrappedTileCoord_=s||r,f.sourceTiles_=[],f.sourcesListenerKeys_=null,f.sourceZ_=0;var p=o.getTileCoordExtent(f.wrappedTileCoord_),d=f.targetTileGrid_.getExtent(),y=f.sourceTileGrid_.getExtent(),v=d?mi(p,d):p;if(0===fi(v))return f.state=Tl,f;var g=e.getExtent();g&&(y=y?mi(y,g):g);var m=o.getResolution(f.wrappedTileCoord_[0]),_=Bc(e,n,yi(v),m);if(!isFinite(_)||_<=0)return f.state=Tl,f;var b=void 0!==c?c:.5;if(f.triangulation_=new zc(e,n,v,y,_*b,m),0===f.triangulation_.getTriangles().length)return f.state=Tl,f;f.sourceZ_=i.getZForResolution(_);var w=f.triangulation_.calculateSourceExtent();if(y&&(e.canWrapX()?(w[1]=Mi(w[1],y[1],y[3]),w[3]=Mi(w[3],y[1],y[3])):w=mi(w,y)),fi(w)){for(var x=i.getTileRangeForExtentAndZ(w,f.sourceZ_),S=x.minX;S<=x.maxX;S++)for(var T=x.minY;T<=x.maxY;T++){var O=l(f.sourceZ_,S,T,a);O&&f.sourceTiles_.push(O)}0===f.sourceTiles_.length&&(f.state=Tl)}else f.state=Tl;return f}return gh(e,t),e.prototype.getImage=function(){return this.canvas_},e.prototype.reproject_=function(){var t=[];if(this.sourceTiles_.forEach(function(e,i,n){e&&e.getState()==xl&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(e.tileCoord),image:e.getImage()})}.bind(this)),this.sourceTiles_.length=0,0===t.length)this.state=Sl;else{var e=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(e),n="number"==typeof i?i:i[0],o="number"==typeof i?i:i[1],r=this.targetTileGrid_.getResolution(e),s=this.sourceTileGrid_.getResolution(this.sourceZ_),a=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=Xc(n,o,this.pixelRatio_,s,this.sourceTileGrid_.getExtent(),r,a,this.triangulation_,t,this.gutter_,this.renderEdges_),this.state=xl}this.changed()},e.prototype.load=function(){if(this.state==bl){this.state=wl,this.changed();var t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(function(e,i,n){var o=e.getState();if(o==bl||o==wl){t++;var r=ce(e,Te,(function(i){var n=e.getState();n!=xl&&n!=Sl&&n!=Tl||(fe(r),0===--t&&(this.unlistenSources_(),this.reproject_()))}),this);this.sourcesListenerKeys_.push(r)}}.bind(this)),this.sourceTiles_.forEach((function(t,e,i){t.getState()==bl&&t.load()})),0===t&&setTimeout(this.reproject_.bind(this),0)}},e.prototype.unlistenSources_=function(){this.sourcesListenerKeys_.forEach(fe),this.sourcesListenerKeys_=null},e}(El),_h=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();function bh(t,e){t.getImage().src=e}var wh=function(t){function e(e){var i=t.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:bh,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection})||this;return i.crossOrigin=void 0!==e.crossOrigin?e.crossOrigin:null,i.tileClass=void 0!==e.tileClass?e.tileClass:vh,i.tileCacheForProjection={},i.tileGridForProjection={},i.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,i.renderReprojectionEdges_=!1,i}return _h(e,t),e.prototype.canExpireCache=function(){if(this.tileCache.canExpireCache())return!0;for(var t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1},e.prototype.expireCache=function(t,e){var i=this.getTileCacheForProjection(t);for(var n in this.tileCache.expireCache(this.tileCache==i?e:{}),this.tileCacheForProjection){var o=this.tileCacheForProjection[n];o.expireCache(o==i?e:{})}},e.prototype.getGutterForProjection=function(t){return this.getProjection()&&t&&!Zo(this.getProjection(),t)?0:this.getGutter()},e.prototype.getGutter=function(){return 0},e.prototype.getOpaque=function(e){return!(this.getProjection()&&e&&!Zo(this.getProjection(),e))&&t.prototype.getOpaque.call(this,e)},e.prototype.getTileGridForProjection=function(t){var e=this.getProjection();if(!this.tileGrid||e&&!Zo(e,t)){var i=$t(t);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=Zl(t)),this.tileGridForProjection[i]}return this.tileGrid},e.prototype.getTileCacheForProjection=function(t){var e=this.getProjection();if(!e||Zo(e,t))return this.tileCache;var i=$t(t);return i in this.tileCacheForProjection||(this.tileCacheForProjection[i]=new zl(this.tileCache.highWaterMark)),this.tileCacheForProjection[i]},e.prototype.createTile_=function(t,e,i,n,o,r){var s=[t,e,i],a=this.getTileCoordForTileUrlFunction(s,o),u=a?this.tileUrlFunction(a,n,o):void 0,l=new this.tileClass(s,void 0!==u?bl:Tl,void 0!==u?u:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return l.key=r,l.addEventListener(Te,this.handleTileChange.bind(this)),l},e.prototype.getTile=function(t,e,i,n,o){var r=this.getProjection();if(r&&o&&!Zo(r,o)){var s=this.getTileCacheForProjection(o),a=[t,e,i],u=void 0,l=Dl(a);s.containsKey(l)&&(u=s.get(l));var c=this.getKey();if(u&&u.key==c)return u;var h=this.getTileGridForProjection(r),f=this.getTileGridForProjection(o),p=this.getTileCoordForTileUrlFunction(a,o),d=new mh(r,h,o,f,a,p,this.getTilePixelRatio(n),this.getGutter(),function(t,e,i,n){return this.getTileInternal(t,e,i,n,r)}.bind(this),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_);return d.key=c,u?(d.interimTile=u,d.refreshInterimChain(),s.replace(l,d)):s.set(l,d),d}return this.getTileInternal(t,e,i,n,r||o)},e.prototype.getTileInternal=function(t,e,i,n,o){var r=null,s=Fl(t,e,i),a=this.getKey();if(this.tileCache.containsKey(s)){if((r=this.tileCache.get(s)).key!=a){var u=r;r=this.createTile_(t,e,i,n,o,a),u.getState()==bl?r.interimTile=u.interimTile:r.interimTile=u,r.refreshInterimChain(),this.tileCache.replace(s,r)}}else r=this.createTile_(t,e,i,n,o,a),this.tileCache.set(s,r);return r},e.prototype.setRenderReprojectionEdges=function(t){if(this.renderReprojectionEdges_!=t){for(var e in this.renderReprojectionEdges_=t,this.tileCacheForProjection)this.tileCacheForProjection[e].clear();this.changed()}},e.prototype.setTileGridForProjection=function(t,e){var i=Ko(t);if(i){var n=$t(i);n in this.tileGridForProjection||(this.tileGridForProjection[n]=e)}},e}(uc),xh=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Sh=function(t){function e(e){var i=e||{},n=void 0!==i.projection?i.projection:"EPSG:3857",o=void 0!==i.tileGrid?i.tileGrid:Ul({extent:$l(n),maxResolution:i.maxResolution,maxZoom:i.maxZoom,minZoom:i.minZoom,tileSize:i.tileSize});return t.call(this,{attributions:i.attributions,cacheSize:i.cacheSize,crossOrigin:i.crossOrigin,opaque:i.opaque,projection:n,reprojectionErrorThreshold:i.reprojectionErrorThreshold,tileGrid:o,tileLoadFunction:i.tileLoadFunction,tilePixelRatio:i.tilePixelRatio,tileUrlFunction:i.tileUrlFunction,url:i.url,urls:i.urls,wrapX:void 0===i.wrapX||i.wrapX,transition:i.transition,attributionsCollapsible:i.attributionsCollapsible,zDirection:i.zDirection})||this}return xh(e,t),e}(wh),Th=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Oh=function(t){function e(e){var i,n=e||{};i=void 0!==n.attributions?n.attributions:['&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.'];var o=void 0!==n.crossOrigin?n.crossOrigin:"anonymous",r=void 0!==n.url?n.url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png";return t.call(this,{attributions:i,cacheSize:n.cacheSize,crossOrigin:o,opaque:void 0===n.opaque||n.opaque,maxZoom:void 0!==n.maxZoom?n.maxZoom:19,reprojectionErrorThreshold:n.reprojectionErrorThreshold,tileLoadFunction:n.tileLoadFunction,url:r,wrapX:n.wrapX,attributionsCollapsible:!1})||this}return Th(e,t),e}(Sh),Ch=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Eh=function(t){function e(e){var i=this,n=e||{},o=se({},n);return delete o.preload,delete o.useInterimTilesOnError,(i=t.call(this,o)||this).setPreload(void 0!==n.preload?n.preload:0),i.setUseInterimTilesOnError(void 0===n.useInterimTilesOnError||n.useInterimTilesOnError),i}return Ch(e,t),e.prototype.getPreload=function(){return this.get(fc)},e.prototype.setPreload=function(t){this.set(fc,t)},e.prototype.getUseInterimTilesOnError=function(){return this.get(pc)},e.prototype.setUseInterimTilesOnError=function(t){this.set(pc,t)},e}(Qi),Ph=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Rh=function(t){function e(e){return t.call(this,e)||this}return Ph(e,t),e.prototype.createRenderer=function(){return new _c(this)},e}(Eh);function Ih(t){return(Ih="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function kh(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function jh(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Lh(t,e){return(Lh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Mh(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Dh(t);if(e){var o=Dh(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Fh(this,i)}}function Fh(t,e){return!e||"object"!==Ih(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Dh(t){return(Dh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ah=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Lh(t,e)}(r,t);var e,i,n,o=Mh(r);function r(){return kh(this,r),o.apply(this,arguments)}return e=r,(i=[{key:"makeOLLayer",value:function(){var t=this.options.ol.source;return t.url=this.options.url,new Rh({source:new Oh(t)})}}])&&jh(e.prototype,i),n&&jh(e,n),r}(ea);function Nh(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Gh=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._isShown=!1,this._content=void 0}var e,i,n;return e=t,(i=[{key:"show",value:function(){var t=!this.isShown;return this._isShown=!0,t&&this.trigger("show:tooltip"),this}},{key:"hide",value:function(){var t=this.isShown;return this._isShown=!1,t&&this.trigger("hide:tooltip"),this}},{key:"update",value:function(){return this}},{key:"onContentChange",value:function(){}},{key:"isShown",get:function(){return this._isShown}},{key:"content",get:function(){return this._content},set:function(t){var e=this._content;this._content=t,e!==this._content&&this.onContentChange()}}])&&Nh(e.prototype,i),n&&Nh(e,n),t}();F(Gh.prototype);var Bh=Gh;i(5);function Yh(t){return(Yh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xh(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function zh(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Wh(t,e,i){return(Wh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Hh(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(i):o.value}})(t,e,i||t)}function Vh(t,e){return(Vh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Kh(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Hh(t);if(e){var o=Hh(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return qh(this,i)}}function qh(t,e){return!e||"object"!==Yh(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Hh(t){return(Hh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Zh=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Vh(t,e)}(r,t);var e,i,n,o=Kh(r);function r(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.tooltipNode,n=void 0===i?void 0:i,s=e.bootstrapOptions,a=void 0===s?void 0:s,u=e.closeOnMouseMove,l=void 0===u||u,c=e.closeOnMouseEnter,h=void 0!==c&&c;return Xh(this,r),(t=o.call(this)).bootstrapOptions=a||{},t._initBootstrapOptions(a),t.closeOnMouseMove=l,t.closeOnMouseEnter=h,t._tooltipNode=void 0,t.tooltipNode=n,t}return e=r,(i=[{key:"show",value:function(t){var e=t.posX,i=t.posY;return this.tooltipNode.css({left:"".concat(e,"px"),top:"".concat(i,"px")}).tooltip(this.isShown?"update":"show"),Wh(Hh(r.prototype),"show",this).call(this)}},{key:"hide",value:function(){return this.isShown&&this.tooltipNode.tooltip("hide").attr("data-original-title",void 0),Wh(Hh(r.prototype),"hide",this).call(this)}},{key:"update",value:function(){return this.tooltipNode.tooltip("update"),Wh(Hh(r.prototype),"update",this).call(this)}},{key:"onContentChange",value:function(){this.tooltipNode.attr("data-original-title",Uh(this.content)?this.content:"-"),this._updateNonStringContent(),this.update()}},{key:"_initBootstrapOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.trigger,i=void 0===e?"manual":e;this.bootstrapOptions.trigger=i}},{key:"_initTooltipNode",value:function(){var t=this;this.tooltipNode.tooltip(this.bootstrapOptions).on("inserted.bs.tooltip",(function(){var e=t._updateNonStringContent();e.length&&(t.closeOnMouseMove&&e.children(".tooltip-inner").mousemove((function(){return t.hide()})),t.closeOnMouseEnter&&e.children(".tooltip-inner").mouseenter((function(){return t.hide()})))}))}},{key:"_updateNonStringContent",value:function(){var t=U()(document.getElementById(this.tooltipNode.attr("aria-describedby")));if(t.length)return void 0===this.content||Uh(this.content)||t.children(".tooltip-inner").empty().append(this.content),t}},{key:"tooltipNode",get:function(){return this._tooltipNode},set:function(t){void 0!==t?(this._tooltipNode=U()(t),this._initTooltipNode()):this._tooltipNode=t}}])&&zh(e.prototype,i),n&&zh(e,n),r}(Bh),Uh=function(t){return"[object String]"==Object.prototype.toString.call(t)};function Jh(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Qh(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var $h=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.id;Jh(this,t),this._id=i}var e,i,n;return e=t,(i=[{key:"setId",value:function(){}},{key:"id",get:function(){return this._id},set:function(t){this._id=t,this.setId(t)}}])&&Qh(e.prototype,i),n&&Qh(e,n),t}();function tf(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ef(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var nf=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.fireReplace,n=void 0===i||i,o=e.fireAddRemoveOnReplace,r=void 0!==o&&o,s=e.appendOnReplace,a=void 0===s||s,u=e.sortFunction,l=e.emptyObjectMaker;tf(this,t),this.options={fireReplace:n,fireAddRemoveOnReplace:r,appendOnReplace:a,sortFunction:u,emptyObjectMaker:l},this._itemIds=[],this._items={}}var e,i,n;return e=t,(i=[{key:Symbol.iterator,value:function(){var t=this,e=0;return{next:function(){return e<t._itemIds.length?{value:t._items[t._itemIds[e++]]}:{done:!0}}}}},{key:"getItemById",value:function(t){return t in this._items?this._items[t]:void 0===this.options.emptyObjectMaker?new $h:this.options.emptyObjectMaker.call(this)}},{key:"contains",value:function(t){var e=this.containsId(t.id);return e&&(e=t===this.getItemById(t.id)),e}},{key:"containsId",value:function(t){return t in this._items}},{key:"append",value:function(){for(var t=this,e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return i.forEach((function(e){var i=e.id;if(t.containsId(i)){var n=t.getItemById(i);t.options.appendOnReplace&&(t._itemIds.splice(t._itemIds.indexOf(i),1),t._itemIds.push(i)),n!==e&&(t._items[i]=e,t.options.fireReplace&&t.trigger("replace:item",e,n),t.options.fireAddRemoveOnReplace&&(t.trigger("remove:item",n),t.trigger("add:item",e)))}else t._itemIds.push(i),t._items[i]=e,t.trigger("add:item",e)})),this._sort(),this}},{key:"remove",value:function(){for(var t=this,e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return i.forEach((function(e){var i=t._itemIds.indexOf(e.id);if(i>-1){var n=t._items[e.id];delete t._items[e.id],t._itemIds.splice(i,1),t.trigger("remove:item",n)}})),this}},{key:"removeById",value:function(){for(var t=this,e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return i.forEach((function(e){var i=t._itemIds.indexOf(e);if(i>-1){var n=t._items[e];delete t._items[e],t._itemIds.splice(i,1),t.trigger("remove:item",n)}})),this}},{key:"_sort",value:function(){var t=this;void 0!==this.options.sortFunction&&this._itemIds.sort((function(e,i){return t.options.sortFunction(t._items[e],t._items[i])}))}},{key:"count",get:function(){return this._itemIds.length}},{key:"items",get:function(){var t=this;return this._itemIds.map((function(e){return t._items[e]}))}},{key:"itemIds",get:function(){return this._itemIds}},{key:"sortFunction",get:function(){return this.options.sortFunction},set:function(t){this.options.sortFunction=t,this._sort()}}])&&ef(e.prototype,i),n&&ef(e,n),t}();F(nf.prototype);var of=nf;function rf(t){return(rf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sf(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function af(t,e){return(af=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function uf(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=cf(t);if(e){var o=cf(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return lf(this,i)}}function lf(t,e){return!e||"object"!==rf(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function cf(t){return(cf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var hf=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&af(t,e)}(i,t);var e=uf(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=n.id,r=void 0===o?void 0:o,s=n.pres,a=void 0===s?void 0:s,u=n.tmpc,l=void 0===u?void 0:u,c=n.dwpc,h=void 0===c?void 0:c,f=n.ptrace,p=void 0===f?void 0:f,d=n.ttrace,y=void 0===d?void 0:d,v=n.blayer,g=void 0===v?void 0:v,m=n.tlayer,_=void 0===m?void 0:m,b=n.lclpres,w=void 0===b?void 0:b,x=n.lclhght,S=void 0===x?void 0:x,T=n.lfcpres,O=void 0===T?void 0:T,C=n.lfchght,E=void 0===C?void 0:C,P=n.elpres,R=void 0===P?void 0:P,I=n.elhght,k=void 0===I?void 0:I,j=n.mplpres,L=void 0===j?void 0:j,M=n.mplhght,F=void 0===M?void 0:M,D=n.bplus,A=void 0===D?void 0:D,N=n.bminus,G=void 0===N?void 0:N,B=n.bfzl,Y=void 0===B?void 0:B,X=n.b3km,z=void 0===X?void 0:X,W=n.b6km,V=void 0===W?void 0:W,K=n.p0c,q=void 0===K?void 0:K,H=n.pm10c,Z=void 0===H?void 0:H,U=n.pm20c,J=void 0===U?void 0:U,Q=n.pm30c,$=void 0===Q?void 0:Q,tt=n.hght0c,et=void 0===tt?void 0:tt,it=n.hghtm10c,nt=void 0===it?void 0:it,ot=n.hghtm20c,rt=void 0===ot?void 0:ot,st=n.hghtm30c,at=void 0===st?void 0:st,ut=n.wm10c,lt=void 0===ut?void 0:ut,ct=n.wm20c,ht=void 0===ct?void 0:ct,ft=n.wm30c,pt=void 0===ft?void 0:ft,dt=n.li5,yt=void 0===dt?void 0:dt,vt=n.li3,gt=void 0===vt?void 0:vt,mt=n.brnshear,_t=void 0===mt?void 0:mt,bt=n.brnu,wt=void 0===bt?void 0:bt,xt=n.brnv,St=void 0===xt?void 0:xt,Tt=n.limax,Ot=void 0===Tt?void 0:Tt,Ct=n.limaxpres,Et=void 0===Ct?void 0:Ct,Pt=n.cap,Rt=void 0===Pt?void 0:Pt,It=n.cappres,kt=void 0===It?void 0:It,jt=n.bmin,Lt=void 0===jt?void 0:jt,Mt=n.bminpres,Ft=void 0===Mt?void 0:Mt;return sf(this,i),(t=e.call(this,{id:r})).pres=a,t.tmpc=l,t.dwpc=h,t.ptrace=p,t.ttrace=y,t.blayer=g,t.tlayer=_,t.lclpres=w,t.lclhght=S,t.lfcpres=O,t.lfchght=E,t.elpres=R,t.elhght=k,t.mplpres=L,t.mplhght=F,t.bplus=A,t.bminus=G,t.bfzl=Y,t.b3km=z,t.b6km=V,t.p0c=q,t.pm10c=Z,t.pm20c=J,t.pm30c=$,t.hght0c=et,t.hghtm10c=nt,t.hghtm20c=rt,t.hghtm30c=at,t.wm10c=lt,t.wm20c=ht,t.wm30c=pt,t.li5=yt,t.li3=gt,t.brnshear=_t,t.brnu=wt,t.brnv=St,t.limax=Ot,t.limaxpres=Et,t.cap=Rt,t.cappres=kt,t.bmin=Lt,t.bminpres=Ft,t}return i}($h);function ff(t){return function(t){if(Array.isArray(t))return pf(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return pf(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return pf(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pf(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function df(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yf(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var vf=function(){function t(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=i.calcMissing,o=void 0!==n&&n,r=i.parcels,s=void 0===r?[]:r;df(this,t),this.options={calcMissing:o},this.levels={},this._parcelCollection=new of({fireAddRemoveOnReplace:!0,fireReplace:!1,emptyObjectMaker:function(){return new hf}}),(e=this._parcelCollection).append.apply(e,ff(s))}var e,i,n;return e=t,(i=[{key:"addLevels",value:function(t,e){return t.forEach((function(t){this.addLevel(t,e)}),this),this}},{key:"addLevel",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.calcMissing;return i=i||this.options.calcMissing,"pres"in t&&void 0!==t.pres&&(i&&(t=this.calculateMissingData(t)),this.levels[t.pres]=t),this}},{key:"calculateMissingData",value:function(t){var e={pres:t.pres,hght:t.hght,u:t.u,v:t.v,wdir:t.wdir,wspd:t.wspd,tmpk:t.tmpk,dwpk:t.dwpk,relh:t.relh,mixr:t.mixr,theta:t.theta,thetae:t.thetae,wetbulb:t.wetbulb,vtmp:t.vtmp};return void 0===e.hght&&(e.hght=o(e.pres)),void 0===e.u&&void 0===e.v&&void 0!==e.wdir&&void 0!==e.wspd?(e.u=e.wspd*Math.sin(e.wdir/180*Math.PI),e.v=e.wspd*Math.cos(e.wdir/180*Math.PI)):void 0!==e.u&&void 0!==e.v&&void 0===e.wdir&&void 0===e.wspd&&(e.wspd=Math.sqrt(Math.pow(e.u,2)+Math.pow(e.v,2)),e.wdir=Math.arctan(e.u/e.v)/Math.PI*180),void 0!==e.tmpk&&void 0!==e.dwpk?(void 0===e.theta&&(e.theta=s(e.tmpk,e.pres)),void 0===e.thetae&&(e.thetae=h(e.tmpk,e.dwpk,e.pres))):void 0!==e.mixr&&void 0===e.dwpk&&(e.dwpk=l(e.mixr,e.pres)),e}},{key:"removeLevel",value:function(t){return t in this.levels&&delete this.levels[t],this}},{key:"getData",value:function(t){return t in this.levels?this.levels[t]:{pres:void 0,hght:void 0,tmpk:void 0,dwpk:void 0,wdir:void 0,wspd:void 0,u:void 0,v:void 0,relh:void 0,mixr:void 0,theta:void 0,thetae:void 0,wetbulb:void 0,vtmp:void 0}}},{key:"getLevels",value:function(){return Object.keys(this.levels).map((function(t){return+t})).sort((function(t,e){return t-e}))}},{key:"getNearestLevel",value:function(t){if(!(Object.keys(this.levels).length<1))return Object.keys(this.levels).sort((function(e,i){return Math.abs(e-t)-Math.abs(i-t)})).shift()}},{key:"parcelCollection",get:function(){return this._parcelCollection}}])&&yf(e.prototype,i),n&&yf(e,n),t}(),gf=i(1);function mf(t,e){if(null==t)return{};var i,n,o=function(t,e){if(null==t)return{};var i,n,o={},r=Object.keys(t);for(n=0;n<r.length;n++)i=r[n],e.indexOf(i)>=0||(o[i]=t[i]);return o}(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(n=0;n<r.length;n++)i=r[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(o[i]=t[i])}return o}function _f(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.color,i=void 0===e?void 0:e,n=t.width,o=void 0===n?void 0:n,r=mf(t,["color","width"]),s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r.color=xf(i,s.color,"black"),r.width=xf(o,s.width,1),Object.keys(s).forEach((function(t){"color"!=t&&"width"!=t&&void 0===r[t]&&(r[t]=s[t])})),r}function bf(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.size,i=void 0===e?void 0:e,n=t.color,o=void 0===n?void 0:n,r=t.anchor,s=void 0===r?void 0:r,a=mf(t,["size","color","anchor"]),u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return a.size=xf(i,u.size,12),a.color=xf(o,u.color,"black"),void 0!==(s=xf(s,u.anchor))&&(a.anchor=s),Object.keys(u).forEach((function(t){"color"!=t&&"size"!=t&&"anchor"!=t&&void 0===a[t]&&(a[t]=u[t])})),a}function wf(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.visible,i=void 0===e?void 0:e,n=t.style,o=void 0===n?{}:n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{visible:xf(i,r.visible,!0),style:_f(o,r.style)}}function xf(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return e.reduce((function(t,e){return void 0!==t?t:e}))}function Sf(t){var e=t.node,i=t.text,n=t.x,o=t.y,r=t.horizontalMargin,s=void 0===r?0:r,a=t.verticalMargin,u=void 0===a?0:a,l=t.font,c=void 0===l?{}:l,h=t.fill,f=void 0===h?{}:h,p=e.group();"color"in f||(f.color="white");var d=p.rect().fill(f),y=p.text(i).attr({x:n,y:o}).font(c);return"bottom"==c["alignment-baseline"]&&y.dy(-y.bbox().height-5),y.dx(s*("end"==y.attr("text-anchor")?-1:1)).dy(u*("bottom"==c["alignment-baseline"]?-1:1)),d.attr({x:y.bbox().x,y:y.bbox().y,width:y.bbox().width,height:y.bbox().height}),p}function Tf(t){return(Tf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Of(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Cf(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ef(t,e){return(Ef=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Pf(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=If(t);if(e){var o=If(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Rf(this,i)}}function Rf(t,e){return!e||"object"!==Tf(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function If(t){return(If=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var kf=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ef(t,e)}(r,t);var e,i,n,o=Pf(r);function r(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=i.visible,s=void 0===n||n,a=i.diagram,u=void 0===a?{}:a,l=i.windprofile,c=void 0===l?{}:l,h=i.hodograph,f=void 0===h?{}:h,p=i.parcels,d=void 0===p?{}:p;return Of(this,r),(e=o.call(this))._sounding=t,e._visible=s,e._options={diagram:Lf(u),windprofile:Ff(c),hodograph:wf(f),parcels:Af(d)},e}return e=r,(i=[{key:"update",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.visible,i=void 0===e?void 0:e,n=t.diagram,o=void 0===n?void 0:n,r=t.windprofile,s=void 0===r?void 0:r,a=t.hodograph,u=void 0===a?void 0:a,l=t.parcels,c=void 0===l?void 0:l,h=!1;void 0===o?o={}:h=!0,void 0===s?s={}:h=!0,void 0===u?u={}:h=!0,void 0===c?c={}:h=!0,this._options.diagram=Mf(this._options.diagram,o),this._options.windprofile=Df(this._options.windprofile,s),this._options.hodograph=Bf(this._options.hodograph,u),this._options.parcels=Nf(this._options.parcels,c),h&&this.trigger("change:options"),void 0!==i&&(this.visible=i)}},{key:"getParcelOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,e={visible:this.options.parcels.default.visible,temp:{visible:this.options.parcels.default.temp.visible,style:this.options.parcels.default.temp.style},dewp:{visible:this.options.parcels.default.dewp.visible,style:this.options.parcels.default.dewp.style}};return void 0!==t&&t.id in this.options.parcels&&(e=Gf(e,this.options.parcels[t.id],["temp","dewp"])),e}},{key:"sounding",get:function(){return this._sounding}},{key:"visible",get:function(){return this._visible},set:function(t){var e=this._visible;this._visible=!!t,e!=this._visible&&this.trigger("change:visible")}},{key:"options",get:function(){return this._options}}])&&Cf(e.prototype,i),n&&Cf(e,n),r}($h);F(kf.prototype);var jf=kf;function Lf(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.visible,i=void 0===e||e,n=t.temp,o=void 0===n?{}:n,r=t.dewp,s=void 0===r?{}:r,a=t.wetbulb,u=void 0===a?{}:a;return{visible:i,temp:wf(o,{style:{color:"red",width:3,linecap:"round"}}),dewp:wf(s,{style:{color:"blue",width:3,linecap:"round"}}),wetbulb:wf(u,{style:{color:"green",width:2,linecap:"round"}})}}function Mf(t,e){return Gf(t,e,["temp","dewp","wetbulb"])}function Ff(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.visible,i=void 0===e||e,n=t.windbarbs,o=void 0===n?{}:n,r=t.windspeed,s=void 0===r?{}:r;return{visible:i,windbarbs:wf(o),windspeed:wf(s)}}function Df(t,e){return Gf(t,e,["windbarbs","windspeed"])}function Af(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return void 0===t.visible&&(t.visible=!0),void 0===t.default&&(t.default={}),void 0===t.default.visible&&(t.default.visible=!1),void 0===t.default.temp&&(t.default.temp={}),void 0===t.default.temp.visible&&(t.default.temp.visible=!0),void 0===t.default.temp.style&&(t.default.temp.style={}),void 0===t.default.temp.style.color&&(t.default.temp.style.color="rgb(255, 153, 0)"),void 0===t.default.temp.style.width&&(t.default.temp.style.width=3),void 0===t.default.temp.style.linecap&&(t.default.temp.style.linecap="round"),void 0===t.default.dewp&&(t.default.dewp={}),void 0===t.default.dewp.visible&&(t.default.dewp.visible=!0),void 0===t.default.dewp.style&&(t.default.dewp.style={}),void 0===t.default.dewp.style.color&&(t.default.dewp.style.color="rgb(255, 194, 102)"),void 0===t.default.dewp.style.width&&(t.default.dewp.style.width=3),void 0===t.default.dewp.style.linecap&&(t.default.dewp.style.linecap="round"),t}function Nf(t,e){return"visible"in e&&(t.visible=e.visible),"default"in e&&(t.default=Gf(t.default,e.default,["temp","dewp"])),Object.keys(e).filter((function(t){return"visible"!=t&&"default"!=t})).forEach((function(i){return t[i]=Mf(i in t?t[i]:{},e[i])})),t}function Gf(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return"visible"in e&&(t.visible=e.visible),i.forEach((function(i){i in e&&(t[i]=Bf(t[i]?t[i]:{style:{}},e[i]))})),t}function Bf(t,e){return"visible"in e&&(t.visible=e.visible),"style"in e&&["color","width","opacity","linecap","linejoin","dasharray"].forEach((function(i){i in e.style&&(t.style[i]=e.style[i])})),t}function Yf(t){return(Yf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xf(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(!t)return;if("string"==typeof t)return zf(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return zf(t,e)}(t))){var e=0,i=function(){};return{s:i,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,o,r=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return r=t.done,t},e:function(t){s=!0,o=t},f:function(){try{r||null==n.return||n.return()}finally{if(s)throw o}}}}function zf(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Wf(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Vf(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Kf(t,e){return(Kf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function qf(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Zf(t);if(e){var o=Zf(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Hf(this,i)}}function Hf(t,e){return!e||"object"!==Yf(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Zf(t){return(Zf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Uf=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Kf(t,e)}(r,t);var e,i,n,o=qf(r);function r(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.renderTo,n=void 0===i?void 0:i,s=e.width,a=void 0===s?void 0:s,u=e.height,l=void 0===u?void 0:u;if(Wf(this,r),(t=o.call(this,{fireReplace:!1,fireAddRemoveOnReplace:!0,emptyObjectMaker:function(){return new jf}}))._svgNode=void 0===n||"node"in n||"instance"in n?Object(gf.SVG)(n):Object(gf.SVG)().addTo(n),void 0!==a||void 0!==l)t._svgNode.size(a,l);else if(void 0===a&&void 0===l&&void 0!==n&&"getBoundingClientRect"in n){var c=n.getBoundingClientRect(),h=window.getComputedStyle(n);t._svgNode.size(c.width-parseFloat(h.getPropertyValue("padding-left"))-parseFloat(h.getPropertyValue("padding-right")),c.height-parseFloat(h.getPropertyValue("padding-top"))-parseFloat(h.getPropertyValue("padding-bottom")))}return t._plotAreas=new Set,t._svgNode.on("mousemove",(function(e){var i,n=Xf(t._plotAreas);try{for(n.s();!(i=n.n()).done;){var o=i.value;"isHoverLabelsRemote"in o&&o.svgNode.dispatchEvent(e)}}catch(t){n.e(t)}finally{n.f()}})),t._svgNode.on("mouseout",(function(e){if(t._svgNode.node===e.target){var i,n=Xf(t._plotAreas);try{for(n.s();!(i=n.n()).done;){var o=i.value;"_hoverLabelsGroup"in o&&o._hoverLabelsGroup.clear()}}catch(t){n.e(t)}finally{n.f()}}})),t.on("add:item",(function(e){var i,n=Xf(t._plotAreas);try{for(n.s();!(i=n.n()).done;){var o=i.value;"addSounding"in o&&o.addSounding(e)}}catch(t){n.e(t)}finally{n.f()}})),t.on("remove:item",(function(e){var i,n=Xf(t._plotAreas);try{for(n.s();!(i=n.n()).done;){var o=i.value;"removeSounding"in o&&o.removeSounding(e)}}catch(t){n.e(t)}finally{n.f()}})),t}return e=r,(i=[{key:"appendPlotArea",value:function(t){if(!this._plotAreas.has(t)){this._plotAreas.add(t),t.addTo(this.svgNode);var e,i=Xf(this);try{for(i.s();!(e=i.n()).done;){var n=e.value;"addSounding"in t&&t.addSounding(n)}}catch(t){i.e(t)}finally{i.f()}return this}}},{key:"removePlotArea",value:function(t){if(this._plotAreas.has(t)){var e,i=Xf(this);try{for(i.s();!(e=i.n()).done;){var n=e.value;t.removeSounding(n)}}catch(t){i.e(t)}finally{i.f()}return this._plotAreas.delete(t),this}}},{key:"exchangeCoordinateSystem",value:function(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=Xf(this._plotAreas);try{for(n.s();!(e=n.n()).done;){var o=e.value;void 0!==i&&o.coordinateSystem!==i||(o.coordinateSystem=t)}}catch(t){n.e(t)}finally{n.f()}}},{key:"addSounding",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=new jf(t,e),n=1,o="sounding-".concat(n);this.containsId(o);)n++,o="sounding-".concat(n);return i.id=o,this.append(i),i}},{key:"svgNode",get:function(){return this._svgNode}}])&&Vf(e.prototype,i),n&&Vf(e,n),r}(of);function Jf(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Qf(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var $f=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.width,n=void 0===i?100:i,o=e.height,r=void 0===o?100:o,s=e.pressure,a=void 0===s?{}:s,u=e.temperature,l=void 0===u?{}:u;Jf(this,t),this._width=n,this._height=r,this.temperatureBottomLeft,this.temperatureBottomRight,this.inclinationTan,this.options={pressure:{},temperature:{}},this._initPressureOptions(a),this._initTemperatureOptions(l)}var e,i,n;return e=t,(i=[{key:"isIsobarsStraightLine",value:function(){return!0}},{key:"isDryAdiabatStraightLine",value:function(){return!1}},{key:"isIsothermsVertical",value:function(){return void 0!==this.options.temperature.inclinationAngle&&0==this.options.temperature.inclinationAngle}},{key:"getPByXY",value:function(t,e){return Math.pow(this.options.pressure.min,e/this.height)*Math.pow(this.options.pressure.max,(this.height-e)/this.height)}},{key:"getTByXY",value:function(t,e){var i=t-e*this.inclinationTan;return this.temperatureBottomLeft+i*(this.temperatureBottomRight-this.temperatureBottomLeft)/this.width}},{key:"getYByXP",value:function(t,e){return this.height*Math.log(this.options.pressure.max/e)/Math.log(this.options.pressure.max/this.options.pressure.min)}},{key:"getTByXP",value:function(t,e){return this.getTByXY(t,this.getYByXP(t,e))}},{key:"getXByYT",value:function(t,e){return(e-this.temperatureBottomLeft)*this.width/(this.temperatureBottomRight-this.temperatureBottomLeft)+t*this.inclinationTan}},{key:"getYByXT",value:function(t,e){return 0!=this.inclinationTan?(t-this.getXByYT(0,e))/this.inclinationTan:void 0}},{key:"getXByPT",value:function(t,e){return this.getXByYT(this.getYByXP(0,t),e)}},{key:"getYByPT",value:function(t){return this.getYByXP(0,t)}},{key:"getXByYPotentialTemperature",value:function(t,e){return e=a(e,this.getPByXY(0,t)),this.getXByYT(t,e)}},{key:"getYByXPotentialTemperature",value:function(t,e){var i=this.getPByXY(t,0),n=this.getPByXY(t,this.height);if(!(s(this.getTByXP(t,n),n)<e||e<s(this.getTByXP(t,i),i))){for(;i-n>10;){var o=n+(i-n)/2,r=s(this.getTByXP(t,o),o);if(void 0===r)return;r<e?i=o:n=o}return this.getYByXP(t,n+(i-n)/2)}}},{key:"getXByPPotentialTemperatur",value:function(t,e){return e=a(e,t),this.getXByPT(t,e)}},{key:"getYByPPotentialTemperatur",value:function(t,e){var i=this.getXByPPotentialTemperatur(t,e);return this.getYByXPotentialTemperature(i,e)}},{key:"getXByYHMR",value:function(t,e){var i=this.getPByXY(0,t);return this.getXByYT(t,l(e,i))}},{key:"getYByXHMR",value:function(t,e){for(var i=this.getPByXY(t,0),n=this.getPByXY(t,this.height);i-n>10;){var o=n+(i-n)/2,r=p(this.getTByXP(t,o),o);if(void 0===r)return;r<e?n=o:i=o}return this.getYByXP(t,n+(i-n)/2)}},{key:"getXByPHMR",value:function(t,e){var i=l(e,t);return this.getXByPT(t,i)}},{key:"getYByPHMR",value:function(t,e){var i=l(e,t);return this.getYByPT(t,i)}},{key:"getXByYEquiPotTemp",value:function(t,e){var i=u(e,this.getPByXY(0,t));return this.getXByYT(t,i)}},{key:"getYByXEquiPotTemp",value:function(t,e){for(var i=0,n=this.height,o=void 0;n-i>10;){o=i+(n-i)/2;var r=this.getYByXT(t,u(e,this.getPByXY(t,o)));if(void 0===r)return;r<e?n=o:i=o}return o}},{key:"getXByPEquiPotTemp",value:function(t,e){var i=u(e,t);return this.getXByPT(t,i)}},{key:"getYByPEquiPotTemp",value:function(t,e){var i=u(e,t);return this.getYByPT(t,i)}},{key:"update",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.pressure,i=void 0===e?{}:e,n=t.temperature,o=void 0===n?{}:n;"min"in i&&(this.options.pressure.min=void 0===i.min?100:i.min),"max"in i&&(this.options.pressure.max=void 0===i.max?1e3:i.max),"min"in o&&(this.options.temperature.min=void 0===o.min?g(-40):o.min),"max"in o&&(this.options.temperature.max=void 0===o.max?g(-45):o.max),"reference"in o&&(this.options.temperature.reference=void 0===o.reference?"base":o.reference),"inclinationAngle"in o&&(this.options.temperature.inclinationAngle=void 0===o.inclinationAngle?45:o.inclinationAngle),this._normalizeTemperatureRange(),this.trigger("change:options")}},{key:"_initPressureOptions",value:function(t){var e=t.min,i=void 0===e?100:e,n=t.max,o=void 0===n?1050:n;this.options.pressure={min:i,max:o}}},{key:"_initTemperatureOptions",value:function(t){var e=t.min,i=void 0===e?g(-40):e,n=t.max,o=void 0===n?g(45):n,r=t.reference,s=void 0===r?"base":r,a=t.inclinationAngle,u=void 0===a?45:a;this.options.temperature={min:i,max:o,reference:s,inclinationAngle:u},this._normalizeTemperatureRange()}},{key:"_normalizeTemperatureRange",value:function(){if(this.temperatureBottomLeft=this.options.temperature.min,this.temperatureBottomRight=this.options.temperature.max,this.inclinationTan=45==this.options.temperature.inclinationAngle?1:0==this.options.temperature.inclinationAngle?0:Math.tan(this.options.temperature.inclinationAngle*Math.PI/180),/^[0-9]+$/.test(this.options.temperature.reference)){var t=this.getYByXP(0,this.options.temperature.reference),e=this.inclinationTan*t,i=(this.temperatureBottomRight-this.temperatureBottomLeft)/this.width;this.temperatureBottomLeft+=i*e,this.temperatureBottomRight+=i*e}}},{key:"width",get:function(){return this._width},set:function(t){var e=this._width;this._width=t,e!=this._width&&this.trigger("change:options")}},{key:"height",get:function(){return this._height},set:function(t){var e=this._height;this._height=t,e!=this._height&&this.trigger("change:options")}}])&&Qf(e.prototype,i),n&&Qf(e,n),t}();F($f.prototype);var tp=$f;function ep(t){return(ep="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ip(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function np(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function op(t,e){return(op=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function rp(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=ap(t);if(e){var o=ap(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return sp(this,i)}}function sp(t,e){return!e||"object"!==ep(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ap(t){return(ap=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var up=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&op(t,e)}(r,t);var e,i,n,o=rp(r);function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.width,i=void 0===e?100:e,n=t.height,s=void 0===n?100:n,a=t.pressure,u=void 0===a?{}:a,l=t.temperature,c=void 0===l?{}:l;return ip(this,r),c.inclinationAngle=0,o.call(this,{width:i,height:s,pressure:u,temperature:c})}return e=r,(i=[{key:"isDryAdiabatStraightLine",value:function(){return!0}},{key:"getPByXY",value:function(t,e){return Math.pow(Math.pow(this.options.pressure.max,.2857)-e*(Math.pow(this.options.pressure.max,.2857)-Math.pow(this.options.pressure.min,.2857))/this.height,1/.2857)}},{key:"getYByXP",value:function(t,e){return this.height*(Math.pow(this.options.pressure.max,.2857)-Math.pow(e,.2857))/(Math.pow(this.options.pressure.max,.2857)-Math.pow(this.options.pressure.min,.2857))}},{key:"getYByXT",value:function(){}}])&&np(e.prototype,i),n&&np(e,n),r}(tp);function lp(t){return(lp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function cp(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function hp(t,e){return(hp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function fp(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=dp(t);if(e){var o=dp(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return pp(this,i)}}function pp(t,e){return!e||"object"!==lp(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function dp(t){return(dp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var yp=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&hp(t,e)}(i,t);var e=fp(i);function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.width,o=void 0===n?100:n,r=t.height,s=void 0===r?100:r,a=t.pressure,u=void 0===a?{}:a,l=t.temperature,c=void 0===l?{}:l;return cp(this,i),c.inclinationAngle=0,e.call(this,{width:o,height:s,pressure:u,temperature:c})}return i}(tp);function vp(t){return(vp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gp(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function mp(t,e){return(mp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _p(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=wp(t);if(e){var o=wp(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return bp(this,i)}}function bp(t,e){return!e||"object"!==vp(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function wp(t){return(wp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var xp=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&mp(t,e)}(i,t);var e=_p(i);function i(){return gp(this,i),e.apply(this,arguments)}return i}(tp);function Sp(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Tp(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Op=function(){function t(){var e=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=i.svgNode,o=void 0===n?void 0:n,r=i.coordinateSystem,s=void 0===r?void 0:r,a=i.x,u=void 0===a?0:a,l=i.y,c=void 0===l?0:l,h=i.width,f=void 0===h?100:h,p=i.height,d=void 0===p?100:p,y=i.style,v=void 0===y?{}:y,g=i.visible,m=void 0===g||g,_=i.events,b=void 0===_?{}:_;Sp(this,t),this._svgNode=Object(gf.SVG)().attr({x:u,y:c,width:f,height:d}).css(this._getNormalizedStyle(v)).css("display",m?"inline":"none"),void 0!==o&&this.addTo(o),this._svgNodeBackground=this._svgNode.group(),this._visible=m,this._coordinateSystem=s,this._coordinateSystemListenerKey=void 0!==this._coordinateSystem?this._coordinateSystem.on("change:options",(function(){return e.onCoordinateSystemChange()})):void 0,this.on("change:extent",(function(){return e.onCoordinateSystemChange()})),this._initEvents(b)}var e,i,n;return e=t,(i=[{key:"addTo",value:function(t){this._svgNode.addTo(t)}},{key:"init",value:function(){this.onCoordinateSystemChange()}},{key:"onCoordinateSystemChange",value:function(){void 0!==this._coordinateSystem&&this.drawBackground(this._svgNodeBackground)}},{key:"drawBackground",value:function(t){t.clear()}},{key:"_getNormalizedStyle",value:function(t){var e=t.overflow;return{overflow:void 0===e?"hidden":e}}},{key:"_initEvents",value:function(t){var e=this,i=t.click,n=void 0===i?void 0:i,o=t.dblclick,r=void 0===o?void 0:o,s=t.mousedown,a=void 0===s?void 0:s,u=t.mouseup,l=void 0===u?void 0:u,c=t.mouseover,h=void 0===c?void 0:c,f=t.mouseout,p=void 0===f?void 0:f,d=t.mousemove,y=void 0===d?void 0:d,v=t.touchstart,g=void 0===v?void 0:v,m=t.touchmove,_=void 0===m?void 0:m,b=t.touchleave,w=void 0===b?void 0:b,x=t.touchend,S=void 0===x?void 0:x,T=t.touchcancel,O={click:n,dblclick:r,mousedown:a,mouseup:l,mouseover:h,mouseout:p,mousemove:y,touchstart:g,touchmove:_,touchleave:w,touchend:S,touchcancel:void 0===T?void 0:T};Object.keys(O).forEach((function(t){e._svgNode.on(t,(function(i){var n=e.getExtendedEvent(i,e._svgNode.point(i.pageX-window.pageXOffset,i.pageY-window.pageYOffset));void 0!==O[t]&&O[t].call(e,n),e.trigger(t,n)}))}))}},{key:"getExtendedEvent",value:function(t,e){return t.elementX=e.x,t.elementY=e.y,t}},{key:"svgNode",get:function(){return this._svgNode}},{key:"visible",get:function(){return this._visible},set:function(t){var e=this._visible;this._visible=t,e!=this._visible&&(this._svgNode.style("display",this._visible?"inline":"none"),this.trigger("change:visible"))}},{key:"x",get:function(){return this._svgNode.attr("x")},set:function(t){this._svgNode.attr({x:t}),this.trigger("change:position")}},{key:"y",get:function(){return this._svgNode.attr("y")},set:function(t){this._svgNode.attr({y:t}),this.trigger("change:position")}},{key:"width",get:function(){return this._svgNode.attr("width")},set:function(t){this._svgNode.attr({width:t}),this.trigger("change:extent")}},{key:"height",get:function(){return this._svgNode.attr("height")},set:function(t){this._svgNode.attr({height:t}),this.trigger("change:extent")}},{key:"style",get:function(){return this._svgNode.css()},set:function(t){this._svgNode.css(t)}},{key:"coordinateSystem",get:function(){return this._coordinateSystem},set:function(t){var e=this;void 0!==this._coordinateSystemListenerKey&&this._coordinateSystem.un("change:options",this._coordinateSystemListenerKey),this._coordinateSystem=t,this._coordinateSystemListenerKey=this._coordinateSystem.on("change:options",(function(){return e.onCoordinateSystemChange()})),this.onCoordinateSystemChange()}},{key:"minExtentLength",get:function(){return Math.min(this.width,this.height)}},{key:"maxExtentLength",get:function(){return Math.max(this.width,this.height)}}])&&Tp(e.prototype,i),n&&Tp(e,n),t}();F(Op.prototype);var Cp=Op;function Ep(t){return(Ep="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pp(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(!t)return;if("string"==typeof t)return Rp(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Rp(t,e)}(t))){var e=0,i=function(){};return{s:i,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,o,r=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return r=t.done,t},e:function(t){s=!0,o=t},f:function(){try{r||null==n.return||n.return()}finally{if(s)throw o}}}}function Rp(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Ip(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function kp(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function jp(t,e,i){return(jp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Dp(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(i):o.value}})(t,e,i||t)}function Lp(t,e){return(Lp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Mp(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Dp(t);if(e){var o=Dp(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Fp(this,i)}}function Fp(t,e){return!e||"object"!==Ep(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Dp(t){return(Dp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ap=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Lp(t,e)}(r,t);var e,i,n,o=Mp(r);function r(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.svgNode,n=void 0===i?void 0:i,s=e.coordinateSystem,a=void 0===s?void 0:s,u=e.x,l=void 0===u?0:u,c=e.y,h=void 0===c?0:c,f=e.width,p=void 0===f?100:f,d=e.height,y=void 0===d?100:d,v=e.style,g=void 0===v?{}:v,m=e.visible,_=void 0===m||m,b=e.events,w=void 0===b?{}:b,x=e.getSoundingVisibility,S=void 0===x?function(t){return t.visible}:x,T=e.dataGroupIds,O=void 0===T?[]:T,C=e.getCoordinatesByLevelData,E=void 0===C?function(){return{x:void 0,y:void 0}}:C,P=e.insertDataGroupInto,R=void 0===P?function(){}:P;return Ip(this,r),(t=o.call(this,{svgNode:n,coordinateSystem:a,x:l,y:h,width:p,height:y,style:g,visible:_,events:w}))._getSoundingVisibility=S,t._dataGroupIds=O,t._getCoordinatesByLevelData=E,t._insertDataGroupInto=R,t._svgNodeData=t.svgNode.group(),t._soundings=new Map,t}return e=r,(i=[{key:"addSounding",value:function(t){var e=this,i=this._svgNodeData.group(),n=function(){void 0!==e.coordinateSystem&&e.drawSounding(t,i),e.onChangeSoundingVisibility(t,i)},o=t.on("change:visible",(function(){return e.onChangeSoundingVisibility(t,i)})),r=t.on("change:options",n);this._soundings.set(t,{group:i,listenerKeyVisible:o,listenerKeyOptions:r}),this.trigger("add:sounding",t),n()}},{key:"removeSounding",value:function(t){this._soundings.has(t)&&(this._soundings.get(t).group.remove(),t.un(this._soundings.get(t).listenerKeyVisible),t.un(this._soundings.get(t).listenerKeyOptions),this._soundings.delete(t)),this.trigger("remove:sounding",t)}},{key:"onCoordinateSystemChange",value:function(){if(jp(Dp(r.prototype),"onCoordinateSystemChange",this).call(this),void 0!==this.coordinateSystem){var t,e=Pp(this._soundings.keys());try{for(e.s();!(t=e.n()).done;){var i=t.value;this.drawSounding(i,this._soundings.get(i).group)}}catch(t){e.e(t)}finally{e.f()}}}},{key:"onChangeSoundingVisibility",value:function(t,e){e.css("display",this._getSoundingVisibility(t)?"inline":"none")}},{key:"drawSounding",value:function(t,e){var i=this;e.clear();var n=e.group(),o={};t.sounding.getLevels().forEach((function(e){var n=t.sounding.getData(e);i._dataGroupIds.forEach((function(e){e in o||(o[e]=[]);var r={levelData:n,x:void 0,y:void 0},s=i._getCoordinatesByLevelData(e,t,r.levelData,i),a=s.x,u=s.y;void 0===a&&void 0===u||(r.x=a,r.y=u,o[e].push(r))}))})),Object.keys(o).forEach((function(e){o[e].length>0&&i._insertDataGroupInto(n,e,t,o[e],i)}))}},{key:"dataGroupIds",get:function(){return this._dataGroupIds}},{key:"getCoordinatesByLevelData",get:function(){return this._getCoordinatesByLevelData}}])&&kp(e.prototype,i),n&&kp(e,n),r}(Cp);function Np(t){return(Np="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Gp(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(!t)return;if("string"==typeof t)return Bp(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Bp(t,e)}(t))){var e=0,i=function(){};return{s:i,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,o,r=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return r=t.done,t},e:function(t){s=!0,o=t},f:function(){try{r||null==n.return||n.return()}finally{if(s)throw o}}}}function Bp(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Yp(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Xp(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function zp(t,e,i){return(zp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=qp(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(i):o.value}})(t,e,i||t)}function Wp(t,e){return(Wp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Vp(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=qp(t);if(e){var o=qp(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Kp(this,i)}}function Kp(t,e){return!e||"object"!==Np(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function qp(t){return(qp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Hp=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Wp(t,e)}(r,t);var e,i,n,o=Vp(r);function r(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.svgNode,n=void 0===i?void 0:i,s=e.coordinateSystem,a=void 0===s?void 0:s,u=e.x,l=void 0===u?0:u,c=e.y,h=void 0===c?0:c,f=e.width,p=void 0===f?100:f,d=e.height,y=void 0===d?100:d,v=e.style,g=void 0===v?{}:v,m=e.visible,_=void 0===m||m,b=e.events,w=void 0===b?{}:b,x=e.hoverLabels,S=void 0===x?{}:x,T=e.getSoundingVisibility,O=void 0===T?function(t){return t.visible}:T,C=e.dataGroupIds,E=void 0===C?void 0:C,P=e.getCoordinatesByLevelData,R=void 0===P?void 0:P,I=e.insertDataGroupInto,k=void 0===I?void 0:I;return Yp(this,r),(t=o.call(this,{svgNode:n,coordinateSystem:a,x:l,y:h,width:p,height:y,style:g,visible:_,events:w,getSoundingVisibility:O,dataGroupIds:E,getCoordinatesByLevelData:R,insertDataGroupInto:k}))._hoverLabelsGroup=t.svgNode.group(),t._isHoverLabelsRemote=!0,t._initHoverLabels(S),t}return e=r,(i=[{key:"onChangeSoundingVisibility",value:function(t,e){zp(qp(r.prototype),"onChangeSoundingVisibility",this).call(this,t,e),this._hoverLabelsGroup.clear()}},{key:"drawSounding",value:function(t,e){zp(qp(r.prototype),"drawSounding",this).call(this,t,e),this._hoverLabelsGroup.clear()}},{key:"getExtendedEvent",value:function(t,e){return(t=zp(qp(r.prototype),"getExtendedEvent",this).call(this,t,e)).diagramPres=void 0,void 0!==this.coordinateSystem&&(t.diagramPres=this.coordinateSystem.getPByXY(0,this.coordinateSystem.height-t.elementY)),t}},{key:"_initHoverLabels",value:function(t){var e=this,i=t.visible,n=void 0===i||i,o=t.type,r=void 0===o?"mousemove":o,s=t.remote,a=void 0===s||s,u=t.insertLabelsFunc,l=void 0===u?void 0:u;this._isHoverLabelsRemote=a,n&&void 0!==l&&(this.on("change:extent",(function(){return e._hoverLabelsGroup.clear()})),this.on(r,(function(t){if(t.diagramPres){var i=e.hoverLabelsSounding;if(void 0!==i){var n=i.sounding;l(i,n.getData(n.getNearestLevel(t.diagramPres)),e._hoverLabelsGroup)}}})))}},{key:"isHoverLabelsRemote",get:function(){return this._isHoverLabelsRemote}},{key:"hoverLabelsSounding",get:function(){var t,e=Gp(this._soundings.keys());try{for(e.s();!(t=e.n()).done;){var i=t.value;if(this._getSoundingVisibility(i))return i}}catch(t){e.e(t)}finally{e.f()}}}])&&Xp(e.prototype,i),n&&Xp(e,n),r}(Ap);function Zp(t){return(Zp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Up(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(!t)return;if("string"==typeof t)return Jp(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Jp(t,e)}(t))){var e=0,i=function(){};return{s:i,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,o,r=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return r=t.done,t},e:function(t){s=!0,o=t},f:function(){try{r||null==n.return||n.return()}finally{if(s)throw o}}}}function Jp(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Qp(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $p(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function td(t,e,i){return(td="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=od(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(i):o.value}})(t,e,i||t)}function ed(t,e){return(ed=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function id(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=od(t);if(e){var o=od(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return nd(this,i)}}function nd(t,e){return!e||"object"!==Zp(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function od(t){return(od=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var rd=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ed(t,e)}(a,t);var e,i,n,r=id(a);function a(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.svgNode,n=void 0===i?void 0:i,o=e.coordinateSystem,s=void 0===o?void 0:o,u=e.x,l=void 0===u?0:u,h=e.y,f=void 0===h?0:h,p=e.width,d=void 0===p?100:p,y=e.height,v=void 0===y?100:y,_=e.style,b=void 0===_?{}:_,w=e.visible,x=void 0===w||w,S=e.events,T=void 0===S?{}:S,O=e.dataGroupIds,C=void 0===O?["temp","dewp","wetbulb"]:O,E=e.getCoordinatesByLevelData,P=void 0===E?function(t,e,i,n){if(void 0===i.pres)return{};var o=void 0;switch(t){case"temp":o=i.tmpk;break;case"dewp":o=i.dwpk;break;case"wetbulb":o=c(i.tmpk,i.dwpk,i.pres)}return void 0===o?{}:{x:n.coordinateSystem.getXByPT(i.pres,o),y:n.coordinateSystem.height-n.coordinateSystem.getYByPT(i.pres,o),value:Math.round(10*m(o))/10,unit:""}}:E,R=e.insertDataGroupInto,I=void 0===R?function(t,e,i,n){var o=e in i.options.diagram?i.options.diagram[e].style:{};t.group().polyline(n.map((function(t){return[t.x,t.y]}))).fill("none").stroke(o)}:R,k=e.isobars,j=void 0===k?{}:k,L=e.isotherms,M=void 0===L?{}:L,F=e.dryadiabats,D=void 0===F?{}:F,A=e.pseudoadiabats,N=void 0===A?{}:A,G=e.mixingratio,B=void 0===G?{}:G,Y=e.hoverLabels,X=void 0===Y?{}:Y,z=e.parcels,W=void 0===z?{}:z;return Qp(this,a),(t=r.call(this,{svgNode:n,coordinateSystem:s,x:l,y:f,width:d,height:v,style:b,visible:x,events:T,hoverLabels:X,getSoundingVisibility:function(t){return t.visible&&t.options.diagram.visible},dataGroupIds:C,getCoordinatesByLevelData:P,insertDataGroupInto:I})).options={isobars:sd(j),isotherms:sd(M,{highlightedLines:[g(0)]}),dryadiabats:sd(D),pseudoadiabats:sd(N,{style:{color:"rgb(102, 51, 0)",dasharray:6}}),mixingratio:sd(B,{minPressure:500,style:{color:"rgb(102, 51, 0)",dasharray:2}})},t.svgGroups={border:t._svgNodeBackground.group(),isobars:t._svgNodeBackground.group(),isotherms:t._svgNodeBackground.group(),dryadiabats:t._svgNodeBackground.group(),mixingratio:t._svgNodeBackground.group(),pseudoadiabats:t._svgNodeBackground.group()},t._parcelsOptions=W,"visible"in t._parcelsOptions||(t._parcelsOptions.visible=!0),t._parcels=new Map,t.on("add:sounding",(function(e){t._parcels.set(e,{parcelsGroup:void 0,listenerKey:e.sounding.parcelCollection.on("add:item",(function(){return t.drawParcels(e)}))})})),t.on("remove:sounding",(function(e){t._parcels.has(e)&&e.sounding.parcelCollection.un("add:item",t._parcels.get(e).listenerKey),t._parcels.delete(e)})),t.init(),t}return e=a,(i=[{key:"getIsobarsVisible",value:function(){return this.options.isobars.visible}},{key:"setIsobarsVisible",value:function(t){return this.options.isobars.visible=!!t,this.plotIsobars(),this}},{key:"getIsothermsVisible",value:function(){return this.options.isotherms.visible}},{key:"setIsothermsVisible",value:function(t){return this.options.isotherms.visible=!!t,this.plotIsotherms(),this}},{key:"getDryadiabatsVisible",value:function(){return this.options.dryadiabats.visible}},{key:"setDryadiabatsVisible",value:function(t){return this.options.dryadiabats.visible=!!t,this.plotDryadiabats(),this}},{key:"getPseudoadiabatsVisible",value:function(){return this.options.pseudoadiabats.visible}},{key:"setPseudoadiabatsVisible",value:function(t){return this.options.pseudoadiabats.visible=!!t,this.plotPseudoadiabats(),this}},{key:"getMixingratioVisible",value:function(){return this.options.mixingratio.visible}},{key:"setMixingratioVisible",value:function(t){return this.options.mixingratio.visible=!!t,this.plotMixingratio(),this}},{key:"drawSounding",value:function(t,e){if(td(od(a.prototype),"drawSounding",this).call(this,t,e),this._parcels.has(t)){var i=this._parcels.get(t);i.parcelsGroup=e.group(),t.options.parcels.visible||i.parcelsGroup.hide(),this._parcels.set(t,i)}this.drawParcels(t)}},{key:"drawParcels",value:function(t){if(this._parcelsOptions.visible&&this._parcels.has(t)){var e=this._parcels.get(t).parcelsGroup;e.clear();var i,n=Up(t.sounding.parcelCollection);try{for(n.s();!(i=n.n()).done;){var o=i.value;this.drawParcel(t,o,e.group())}}catch(t){n.e(t)}finally{n.f()}}}},{key:"drawParcel",value:function(t,e,i){var n=this;if(void 0!==e.pres&&void 0!==e.tmpc&&void 0!==e.dwpc){var o=s(g(e.tmpc),e.pres),r=p(g(e.dwpc),e.pres),a=d(o,r),u=v(g(e.tmpc),g(e.dwpc)),l=h(u,u,a),c=t.getParcelOptions(e);c.visible||i.hide();var f=i.group();c.temp.visible||f.hide();var y=i.group();c.dewp.visible||y.hide();var m=this.coordinateSystem.getYByPT(e.pres,g(e.tmpc)),_=this.coordinateSystem.getXByYPotentialTemperature(m,o),b=this.coordinateSystem.getYByPPotentialTemperatur(a,o),w=this.coordinateSystem.getXByYPotentialTemperature(b,o),x=[[_,m]];if(!this.coordinateSystem.isDryAdiabatStraightLine())for(var S=m+10;S<b;S+=10)x.push([this.coordinateSystem.getXByYPotentialTemperature(S,o),S]);x.push([w,b]);for(var T=this.coordinateSystem.height,O=this.coordinateSystem.getXByYEquiPotTemp(T,l),C=b+10;C<T;C+=10)x.push([this.coordinateSystem.getXByYEquiPotTemp(C,l),C]);x.push([O,T]),f.polyline(x.map((function(t){return t[1]=n.coordinateSystem.height-t[1],t}))).fill("none").stroke(c.temp.style);for(var E=this.coordinateSystem.getXByYHMR(m,r),P=this.coordinateSystem.getXByYHMR(b,r),R=[[E,m]],I=m+10;I<b;I+=10)R.push([this.coordinateSystem.getXByYHMR(I,r),I]);R.push([P,b]),y.polyline(R.map((function(t){return t[1]=n.coordinateSystem.height-t[1],t}))).fill("none").stroke(c.dewp.style)}}},{key:"drawBackground",value:function(t){td(od(a.prototype),"drawBackground",this).call(this,t),this.svgGroups={border:t.group(),isobars:t.group(),isotherms:t.group(),dryadiabats:t.group(),mixingratio:t.group(),pseudoadiabats:t.group()},this.svgGroups.border.clear(),this.svgGroups.border.rect(this.coordinateSystem.width,this.coordinateSystem.height).attr({stroke:"black","stroke-width":1,"fill-opacity":0}),this.plotIsobars(!0),this.plotIsotherms(!0),this.plotDryadiabats(!0),this.plotPseudoadiabats(!0),this.plotMixingratio(!0)}},{key:"plotIsobars",value:function(t){var e=this,i=this.coordinateSystem.getPByXY(0,this.coordinateSystem.height),n=this.coordinateSystem.getPByXY(0,0),o=n-i;this._plotLines(this.svgGroups.isobars,this.options.isobars,{min:i,max:n,interval:o>500?100:o>50?10:1},(function(t){var i=e.coordinateSystem.getYByXP(0,t);return[[0,i],[e.coordinateSystem.width,i]]}),t)}},{key:"plotIsotherms",value:function(t){var e=this,i=m(this.coordinateSystem.getTByXY(0,this.coordinateSystem.height)),n=m(this.coordinateSystem.getTByXY(this.coordinateSystem.width,0)),o=n-i;this._plotLines(this.svgGroups.isotherms,this.options.isotherms,{min:i,max:n,interval:o>50?10:5},(function(t){t=g(t);var i=[[void 0,void 0],[void 0,void 0]];return e.coordinateSystem.isIsothermsVertical()?(i[0][1]=0,i[1][1]=e.coordinateSystem.height,i[0][0]=i[1][0]=e.coordinateSystem.getXByYT(i[0][1],t)):(i[0][1]=0,i[0][0]=e.coordinateSystem.getXByYT(i[0][1],t),i[0][0]<0&&(i[0][1]=e.coordinateSystem.getYByXT(i[0][0]=0,t)),i[1][0]=e.coordinateSystem.width,i[1][1]=e.coordinateSystem.getYByXT(i[1][0],t),void 0===i[1][1]?(i[1][0]=i[0][0],i[1][1]=e.coordinateSystem.height):i[1][1]>e.coordinateSystem.height&&(i[1][1]=e.coordinateSystem.height,i[1][0]=e.coordinateSystem.getXByYT(i[1][1],t))),i}),t)}},{key:"plotDryadiabats",value:function(t){var e=this;this._plotLines(this.svgGroups.dryadiabats,this.options.dryadiabats,{min:m(s(this.coordinateSystem.getTByXY(0,0),this.coordinateSystem.getPByXY(0,0))),max:m(s(this.coordinateSystem.getTByXY(this.coordinateSystem.width,this.coordinateSystem.height),this.coordinateSystem.getPByXY(this.coordinateSystem.width,this.coordinateSystem.height))),interval:10},(function(t){var i=g(t),n=0,o=e.coordinateSystem.getXByYPotentialTemperature(n,i);(void 0===o||o>e.coordinateSystem.width)&&(o=e.coordinateSystem.width,n=e.coordinateSystem.getYByXPotentialTemperature(o,i));var r=0,s=e.coordinateSystem.getYByXPotentialTemperature(r,i);if((void 0===s||s>e.coordinateSystem.height)&&(s=e.coordinateSystem.height,r=e.coordinateSystem.getXByYPotentialTemperature(s,i)),void 0!==o&&void 0!==n&&void 0!==r&&void 0!==s){if(e.coordinateSystem.isDryAdiabatStraightLine())return[[o,n],[r,s]];for(var a=[[o,n]],u=n+10;u<s;u+=10)a.push([e.coordinateSystem.getXByYPotentialTemperature(u,i),u]);return a.push([r,s]),a}}),t)}},{key:"plotPseudoadiabats",value:function(t){var e=this;this._plotLines(this.svgGroups.pseudoadiabats,this.options.pseudoadiabats,{lines:[-18,-5,10,30,60,110,180]},(function(t){for(var i=g(t),n=Math.max(0,void 0===e.options.pseudoadiabats.maxPressure?0:e.coordinateSystem.getYByPEquiPotTemp(e.options.pseudoadiabats.maxPressure,i)),o=e.coordinateSystem.getXByYEquiPotTemp(n,i),r=Math.min(e.coordinateSystem.height,void 0===e.options.pseudoadiabats.minPressure?e.coordinateSystem.height:e.coordinateSystem.getYByPEquiPotTemp(e.options.pseudoadiabats.minPressure,i)),s=e.coordinateSystem.getXByYEquiPotTemp(r,i),a=[[o,n]],u=n+10;u<r;u+=10)a.push([e.coordinateSystem.getXByYEquiPotTemp(u,i),u]);return a.push([s,r]),a}),t)}},{key:"plotMixingratio",value:function(t){var e=this;this._plotLines(this.svgGroups.mixingratio,this.options.mixingratio,{lines:[.01,.1,1,2,4,7,10,16,21,32,40]},(function(t){for(var i=Math.max(0,void 0===e.options.mixingratio.maxPressure?0:e.coordinateSystem.getYByPHMR(e.options.mixingratio.maxPressure,t)),n=e.coordinateSystem.getXByYHMR(i,t),o=Math.min(e.coordinateSystem.height,void 0===e.options.mixingratio.minPressure?e.coordinateSystem.height:e.coordinateSystem.getYByPHMR(e.options.mixingratio.minPressure,t)),r=e.coordinateSystem.getXByYHMR(o,t),s=[[n,i]],a=i+10;a<o;a+=10)s.push([e.coordinateSystem.getXByYHMR(a,t),a]);return s.push([r,o]),s}),t)}},{key:"_plotLines",value:function(t,e,i,n,o){if(t.style("display",e.visible?"inline":"none"),o){t.clear();var r=[];if(void 0!==e.lines)r=e.lines;else if(void 0===e.min&&void 0===e.max&&void 0===e.interval&&void 0!==i.lines)r=i.lines;else{void 0!==e.min&&(i.min=e.min),void 0!==e.max&&(i.max=e.max);var s=e.interval;void 0===s&&(s=i.interval);for(var a=Math.ceil(i.min/s)*s,u=Math.floor(i.max/s)*s,l=a;l<=u;l+=s)r.push(l)}var c=3;void 0!==e.style.width&&(c=e.style.width+2),r.forEach((function(i){var o=n.call(this,i),r=2==o.length?t.line(o[0][0],this.coordinateSystem.height-o[0][1],o[1][0],this.coordinateSystem.height-o[1][1]).stroke(e.style):t.polyline(o.map((function(t){return t[1]=this.coordinateSystem.height-t[1],t}),this)).fill("none").stroke(e.style);void 0!==e.highlightedLines&&e.highlightedLines.forEach((function(t){i==t&&r.stroke({width:c})}),this)}),this)}}},{key:"getExtendedEvent",value:function(t,e){return(t=td(od(a.prototype),"getExtendedEvent",this).call(this,t,e)).diagramTmpk=this.coordinateSystem.getTByXY(t.elementX,this.coordinateSystem.height-t.elementY),t}},{key:"_initHoverLabels",value:function(t){var e=t.visible,i=void 0===e||e,n=t.type,o=void 0===n?"mousemove":n,r=t.snapToData,s=void 0===r||r,u=t.remote,l=void 0===u||u,c=t.insertLabelsFunc,h=void 0===c?void 0:c,f=t.pres,p=void 0===f?{}:f,d=t.temp,y=void 0===d?{}:d,v=t.dewp,g=void 0===v?{}:v,m=t.wetbulb,_=void 0===m?{}:m;p.length="length"in p?p.length:60,p.align="align"in p?p.align:"left","visible"in p||(p.visible=!0),"style"in p||(p.style={}),p.font=bf(p.font,{anchor:"right"==p.align?"end":"start"}),"fill"in p||(p.fill={}),void 0===p.fill.opacity&&(p.fill.opacity=.7),void 0===p.horizontalMargin&&(p.horizontalMargin=5),"visible"in y||(y.visible=!0),"style"in y||(y.style={}),y.font=bf(y.font,{anchor:"start","alignment-baseline":"bottom"}),"fill"in y||(y.fill={}),void 0===y.fill.opacity&&(y.fill.opacity=.7),y.radius="radius"in y?y.radius:void 0,y.radiusPlus="radiusPlus"in y?y.radiusPlus:2,void 0===y.horizontalMargin&&(y.horizontalMargin=10),"visible"in g||(g.visible=!0),"style"in g||(g.style={}),g.font=bf(g.font,{anchor:"end","alignment-baseline":"bottom"}),"fill"in g||(g.fill={}),void 0===g.fill.opacity&&(g.fill.opacity=.7),g.radius="radius"in g?g.radius:void 0,g.radiusPlus="radiusPlus"in g?g.radiusPlus:2,void 0===g.horizontalMargin&&(g.horizontalMargin=10),"visible"in _||(_.visible=!0),"style"in _||(_.style={}),_.font=bf(_.font,{anchor:"middle"}),"fill"in _||(_.fill={}),void 0===_.fill.opacity&&(_.fill.opacity=.7),_.radius="radius"in _?_.radius:void 0,_.radiusPlus="radiusPlus"in _?_.radiusPlus:2,void 0===_.verticalMargin&&(_.verticalMargin=10),void 0===h&&(h=this._makeInsertLabelsFunc(p,y,g,_)),td(od(a.prototype),"_initHoverLabels",this).call(this,{visible:i,type:o,snapToData:s,remote:l,insertLabelsFunc:h})}},{key:"_makeInsertLabelsFunc",value:function(t,e,i,n){var r=this;return function(s,a,u){u.clear(),void 0!==a.pres&&(t.visible&&function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=n.length,s=void 0===r?60:r,a=n.align,u=void 0===a?"left":a,l=n.horizontalMargin,c=void 0===l?void 0:l,h=n.verticalMargin,f=void 0===h?void 0:h,p=n.style,d=void 0===p?{}:p,y=n.font,v=void 0===y?{}:y,g=n.fill,m=void 0===g?{}:g,_=0,b=s,w=/^([0-9]+)%$/.exec(b);w&&(b=w[1]/100*i.width),"right"==u&&(_=i.width,b=i.width-b);var x=i.height-i.getYByXP(0,e.pres);d=_f(d),t.line([[Math.min(_,b),x],[Math.max(_,b),x]]).stroke(d),(v=bf(v))["alignment-baseline"]="bottom",Sf({node:t,text:"".concat(Math.round(e.pres)," hPa"),x:_,y:x,horizontalMargin:c,verticalMargin:f,font:v,fill:m}),v["alignment-baseline"]="top";var S=void 0===e.hght?"~".concat(Math.round(o(e.pres))," m"):"".concat(Math.round(e.hght)," m");Sf({node:t,text:S,x:_,y:x,horizontalMargin:c,verticalMargin:f,font:v,fill:m})}(u,a,r.coordinateSystem,t),r.dataGroupIds.reverse().forEach((function(t){var o={visible:!1};switch(t){case"temp":o=e;break;case"dewp":o=i;break;case"wetbulb":o=n}if(o.visible){var l=r._getCoordinatesByLevelData(t,s,a,r),c=l.x,h=l.y,f=l.value,p=l.unit;if(void 0!==c&&void 0!==h){var d=t in r.hoverLabelsSounding.options.diagram?r.hoverLabelsSounding.options.diagram[t].style.width:3,y=void 0===o.radius?d+o.radiusPlus:o.radius,v=o.style;!("color"in v)&&t in r.hoverLabelsSounding.options.diagram&&(v.color=s.options.diagram[t].style.color),u.circle(2*y).attr({cx:c,cy:h}).fill(v),Sf({node:u,text:"".concat(f," ").concat(p),x:c,y:h,horizontalMargin:o.horizontalMargin,verticalMargin:o.verticalMargin,font:o.font,fill:o.fill})}}})))}}}])&&$p(e.prototype,i),n&&$p(e,n),a}(Hp);function sd(t){var e=t.highlightedLines,i=void 0===e?void 0:e,n=t.interval,o=void 0===n?void 0:n,r=t.lines,s=void 0===r?void 0:r,a=t.max,u=void 0===a?void 0:a,l=t.min,c=void 0===l?void 0:l,h=t.maxPressure,f=void 0===h?void 0:h,p=t.minPressure,d=void 0===p?void 0:p,y=t.style,v=void 0===y?void 0:y,g=t.visible,m=void 0===g?void 0:g,_=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{highlightedLines:xf(i,_.highlightedLines),interval:xf(o,_.interval),lines:xf(s,_.lines),max:xf(u,_.max),min:xf(c,_.min),maxPressure:xf(f,_.maxPressure),minPressure:xf(d,_.minPressure),style:_f(v,_.style),visible:xf(m,_.visible,!0)}}function ad(t){return(ad="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ud(t,e){return(ud=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ld(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=hd(t);if(e){var o=hd(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return cd(this,i)}}function cd(t,e){return!e||"object"!==ad(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function hd(t){return(hd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var fd=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ud(t,e)}(i,t);var e=ld(i);function i(t){var n,o=t.svgNode,r=void 0===o?void 0:o,s=t.coordinateSystem,a=void 0===s?void 0:s,u=t.x,l=void 0===u?void 0:u,c=t.y,h=void 0===c?void 0:c,f=t.width,p=void 0===f?void 0:f,d=t.height,y=void 0===d?void 0:d,v=t.style,g=void 0===v?{}:v,m=t.visible,_=void 0===m||m,b=t.events,x=void 0===b?{}:b,S=t.hoverLabels,T=void 0===S?{}:S,O=t.windbarbLength,C=void 0===O?void 0:O,E=t.dataGroupIds,P=void 0===E?["windbarbs"]:E,R=t.getCoordinatesByLevelData,I=void 0===R?function(t,e,i,n){return void 0===i.pres||void 0===i.wspd||void 0===i.wdir?{}:{x:n.width/2,y:n.coordinateSystem.height-n.coordinateSystem.getYByXP(0,i.pres)}}:R,k=t.insertDataGroupInto,j=void 0===k?function(t,e,i,n,o){var r=o.width/2;n.forEach((function(e){var n=t.group(),s=e.y-o._windbarbLength,a=o._windbarbLength/4;n.line(r,s,r,e.y).stroke(i.options.windprofile.windbarbs.style);for(var u=w(e.levelData.wspd);u>=50;)n.polyline([[r,s],[r+2*a,s+.8*a/2],[r,s+.8*a]]).fill("none").stroke(i.options.windprofile.windbarbs.style),s+=a,u-=50;for(;u>=10;)n.line(r,s+a/2,r+2*a,s).stroke(i.options.windprofile.windbarbs.style),s+=a/2,u-=10;u>=5&&n.line(r,s+a/2,r+a,s+a/4).stroke(i.options.windprofile.windbarbs.style),n.rotate(e.levelData.wdir,r,e.y)}))}:k;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(n=e.call(this,{svgNode:r,coordinateSystem:a,x:l,y:h,width:p,height:y,style:g,visible:_,events:x,hoverLabels:T,getSoundingVisibility:function(t){return t.visible&&t.options.windprofile.windbarbs.visible},dataGroupIds:P,getCoordinatesByLevelData:I,insertDataGroupInto:j}))._windbarbLength=C,void 0===n._windbarbLength&&(n._windbarbLength=2*n.width/5),n.init(),n}return i}(Hp);function pd(t){return(pd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function dd(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function yd(t,e,i){return(yd="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_d(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(i):o.value}})(t,e,i||t)}function vd(t,e){return(vd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function gd(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=_d(t);if(e){var o=_d(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return md(this,i)}}function md(t,e){return!e||"object"!==pd(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function _d(t){return(_d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var bd=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vd(t,e)}(r,t);var e,i,n,o=gd(r);function r(t){var e,i=t.svgNode,n=void 0===i?void 0:i,s=t.coordinateSystem,a=void 0===s?void 0:s,u=t.x,l=void 0===u?void 0:u,c=t.y,h=void 0===c?void 0:c,f=t.width,p=void 0===f?void 0:f,d=t.height,y=void 0===d?void 0:d,v=t.style,g=void 0===v?{}:v,m=t.visible,_=void 0===m||m,b=t.events,x=void 0===b?{}:b,S=t.hoverLabels,T=void 0===S?{}:S,O=t.dataGroupIds,C=void 0===O?["windspeed"]:O,E=t.getCoordinatesByLevelData,P=void 0===E?function(t,e,i,n){return void 0===i.pres||void 0===i.wspd?{}:{x:w(n.width*i.wspd)/150,y:n.coordinateSystem.height-n.coordinateSystem.getYByXP(0,i.pres)}}:E,R=t.insertDataGroupInto,I=void 0===R?function(t,e,i,n){t.polyline(n.map((function(t){return[t.x,t.y]}))).fill("none").stroke(i.options.windprofile.windspeed.style)}:R;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),(e=o.call(this,{svgNode:n,coordinateSystem:a,x:l,y:h,width:p,height:y,style:g,visible:_,events:x,hoverLabels:T,getSoundingVisibility:function(t){return t.visible&&t.options.windprofile.windspeed.visible},dataGroupIds:C,getCoordinatesByLevelData:P,insertDataGroupInto:I})).init(),e}return e=r,(i=[{key:"drawBackground",value:function(t){yd(_d(r.prototype),"drawBackground",this).call(this,t),t.line(0,0,0,this.height).stroke({color:"black",width:1}),t.line(this.width,0,this.width,this.height).stroke({color:"black",width:1})}},{key:"_initHoverLabels",value:function(t){var e=t.visible,i=void 0===e||e,n=t.type,o=void 0===n?"mousemove":n,s=t.snapToData,a=void 0===s||s,u=t.remote,l=void 0===u||u,c=t.insertLabelsFunc,h=void 0===c?void 0:c,f=t.windspeed,p=void 0===f?{}:f;"visible"in p||(p.visible=!0),"style"in p||(p.style={}),p.font=bf(p.font,{anchor:"end","alignment-baseline":"bottom"}),"fill"in p||(p.fill={}),void 0===p.fill.opacity&&(p.fill.opacity=.7),p.radius="radius"in p?p.radius:void 0,p.radiusPlus="radiusPlus"in p?p.radiusPlus:2,void 0===p.horizontalMargin&&(p.horizontalMargin=10),void 0===h&&(h=this._makeInsertLabelsFunc(p)),yd(_d(r.prototype),"_initHoverLabels",this).call(this,{visible:i,type:o,snapToData:a,remote:l,insertLabelsFunc:h})}},{key:"_makeInsertLabelsFunc",value:function(t){var e=this;return function(i,n,o){if(o.clear(),void 0!==n.pres&&t.visible&&void 0!==n.wspd){var r=e._getCoordinatesByLevelData("windspeed",i,n,e),s=r.x,a=r.y;if(void 0!==s&&void 0!==a){var u=void 0===t.radius?e.hoverLabelsSounding.options.windprofile.windspeed.style.width/2+t.radiusPlus:t.radius,l=t.style;"color"in l||(l.color=i.options.windprofile.windspeed.style.color),o.circle(2*u).attr({cx:s,cy:a}).fill(l),Sf({node:o,text:"".concat(Math.round(10*w(n.wspd))/10," kn"),x:s,y:a,horizontalMargin:t.horizontalMargin,verticalMargin:t.verticalMargin,font:t.font,fill:t.fill})}}}}}])&&dd(e.prototype,i),n&&dd(e,n),r}(Hp);function wd(t){return(wd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xd(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Sd(t,e,i){return(Sd="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ed(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(i):o.value}})(t,e,i||t)}function Td(t,e){return(Td=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Od(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Ed(t);if(e){var o=Ed(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Cd(this,i)}}function Cd(t,e){return!e||"object"!==wd(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ed(t){return(Ed=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Pd=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Td(t,e)}(r,t);var e,i,n,o=Od(r);function r(t){var e,i=t.svgNode,n=void 0===i?void 0:i,s=t.coordinateSystem,a=t.x,u=t.y,l=t.width,c=t.height,h=t.style,f=void 0===h?{}:h,p=t.visible,d=void 0===p||p,y=t.events,v=void 0===y?{}:y,g=t.grid,m=void 0===g?{}:g,_=t.windspeedMax,b=void 0===_?x(150):_,w=t.origin,S=void 0===w?void 0:w;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),(e=o.call(this,{svgNode:n,coordinateSystem:s,x:a,y:u,width:l,height:c,style:f,visible:d,events:v,getSoundingVisibility:function(t){return t.visible&&t.options.hodograph.visible}}))._gridOptions=e.getNormalizedGridOptions(m),e.center=[e.width/2,e.height/2],void 0!==S&&(e.center[0]-=S[0]*e.minLength/2,e.center[1]+=S[1]*e.minLength/2),e.pixelPerSpeed=Math.min(Math.max(e.width-e.center[0],e.center[0]),Math.max(e.height-e.center[1],e.center[1]))/b,void 0===e._gridOptions.max&&(e._gridOptions.max=b),e.init(),e}return e=r,(i=[{key:"drawSounding",value:function(t,e){var i=this;Sd(Ed(r.prototype),"drawSounding",this).call(this,t,e);var n=[];t.sounding.getLevels().forEach((function(e){if(void 0!==e){var o=t.sounding.getData(e);if(void 0!==o.wdir&&void 0!==o.wspd){var r=o.wspd*-Math.sin(o.wdir/180*Math.PI),s=o.wspd*Math.cos(o.wdir/180*Math.PI);n.push([i.center[0]+r*i.pixelPerSpeed,i.center[1]+s*i.pixelPerSpeed])}}})),e.polyline(n).fill("none").stroke(t.options.hodograph.style)}},{key:"drawBackground",value:function(t){if(Sd(Ed(r.prototype),"drawBackground",this).call(this,t),t.rect(this.width-2,this.height-2).move(1,1).fill({color:"white"}).stroke({color:"black",width:1}),this._gridOptions.axes.visible){var e=this._gridOptions.max+this._gridOptions.circles.interval/2;t.line(Math.max(0,this.center[0]-e*this.pixelPerSpeed),this.center[1],Math.min(this.width,this.center[0]+e*this.pixelPerSpeed),this.center[1]).stroke(this._gridOptions.axes.style),t.line(this.center[0],Math.max(0,this.center[1]-e*this.pixelPerSpeed),this.center[0],Math.min(this.height,this.center[1]+e*this.pixelPerSpeed)).stroke(this._gridOptions.axes.style)}for(var i=this._gridOptions.circles.interval;i<=this._gridOptions.max;i+=this._gridOptions.circles.interval){var n=i*this.pixelPerSpeed;if(t.circle(2*n).attr({cx:this.center[0],cy:this.center[1]}).fill("none").stroke(this._gridOptions.circles.style),this._gridOptions.labels.visible){var o=n*Math.cos((this._gridOptions.labels.angle-90)/180*Math.PI),s=n*Math.sin((this._gridOptions.labels.angle-90)/180*Math.PI),a="middle",u=0,l=-this._gridOptions.labels.font.size;0==this._gridOptions.labels.angle||180==this._gridOptions.labels.angle?(u=-3,a="end"):90!=this._gridOptions.labels.angle&&270!=this._gridOptions.labels.angle||(l=-3);var c=t.plain(""+Math.round(_(i))).move(this.center[0]+o,this.center[1]+s).attr({"text-anchor":a,dx:u,dy:l}).font(this._gridOptions.labels.font),h=c.bbox();c.before(t.rect(h.width,h.height).move(h.x,h.y).fill("white"))}}}},{key:"getNormalizedGridOptions",value:function(t){var e=t.axes,i=void 0===e?{}:e,n=t.circles,o=void 0===n?{}:n,r=t.labels,s=void 0===r?{}:r,a=t.max,u=void 0===a?void 0:a;return i=wf(i),"interval"in(o=wf(o))&&void 0!==o.interval||(o.interval=b(50)),"angle"in(s=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.visible,i=void 0===e||e,n=t.font,o=void 0===n?{}:n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{visible:xf(i,r.visible,!0),font:bf(o,r.font)}}(s))&&void 0!==s.angle||(s.angle=225),void 0===s.font.size&&(s.font.size=10),{axes:i,circles:o,labels:s,max:u}}}])&&xd(e.prototype,i),n&&xd(e,n),r}(Ap);function Rd(t){return(Rd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Id(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function kd(t,e,i){return(kd="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Fd(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(i):o.value}})(t,e,i||t)}function jd(t,e){return(jd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ld(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Fd(t);if(e){var o=Fd(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Md(this,i)}}function Md(t,e){return!e||"object"!==Rd(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Fd(t){return(Fd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Dd=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&jd(t,e)}(r,t);var e,i,n,o=Ld(r);function r(t){var e,i,n,s,a,u,l=t.svgNode,c=void 0===l?void 0:l,h=t.coordinateSystem,f=t.x,p=t.y,d=t.width,y=t.height,v=t.style,g=void 0===v?{}:v,m=t.visible,_=void 0===m||m,b=t.events,w=void 0===b?{}:b,x=t.labels,S=void 0===x?{}:x,T=t.title,O=void 0===T?{}:T;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),void 0===g.overflow&&(g.overflow="visible"),(e=o.call(this,{svgNode:c,coordinateSystem:h,x:f,y:p,width:d,height:y,style:g,visible:_,events:w}))._labelsOptions=(n=(i=S).enabled,s=void 0===n||n,a=i.style,(u={enabled:s,style:void 0===a?{}:a}).style=_f(u.style),u),e._titleOptions=function(t){var e=t.align,i=void 0===e?"middle":e,n=t.style,o=void 0===n?{}:n,r=t.text,s=void 0===r?void 0:r,a={align:i,style:o,text:s};return a.style=_f(a.style),a}(O),e.init(),e}return e=r,(i=[{key:"drawBackground",value:function(t){if(kd(Fd(r.prototype),"drawBackground",this).call(this,t),this._labelsOptions.enabled)for(var e=t.group(),i=50*Math.ceil(this.coordinateSystem.getPByXY(0,this.height)/50),n=50*Math.floor(this.coordinateSystem.getPByXY(0,0)/50),o=i;o<=n;o+=50){var s=this.height-this.coordinateSystem.getYByXP(0,o);e.plain(o).attr({y:s+3.3,x:this.width}).font({size:"11px",anchor:"end"}).attr({fill:this._labelsOptions.style.color})}void 0!==this._titleOptions.text&&t.group().plain(this._titleOptions.text).attr({x:12*.4,y:this.height/2,fill:this._titleOptions.style.color}).font({size:12,anchor:"middle"}).rotate(-90)}}])&&Id(e.prototype,i),n&&Id(e,n),r}(Cp),Ad=Dd;function Nd(t){return(Nd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Gd(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Bd(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Yd(t,e){return(Yd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Xd(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Wd(t);if(e){var o=Wd(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return zd(this,i)}}function zd(t,e){return!e||"object"!==Nd(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Wd(t){return(Wd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Vd=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Yd(t,e)}(r,t);var e,i,n,o=Xd(r);function r(){return Gd(this,r),o.apply(this,arguments)}return e=r,(i=[{key:"drawBackground",value:function(t){if(t.clear(),this._labelsOptions.enabled)for(var e=t.group(),i=10*Math.ceil(m(this.coordinateSystem.getTByXY(0,0))/10),n=10*Math.floor(m(this.coordinateSystem.getTByXY(this.width,0))/10),o=i;o<=n;o+=10){var r=g(o);e.plain(Math.round(m(r))).attr({x:this.coordinateSystem.getXByYT(0,r),y:10,fill:this._labelsOptions.style.color}).font({size:"10px",anchor:"middle"})}void 0!==this._titleOptions.text&&t.group().plain(this._titleOptions.text).attr({x:this.width/2,y:this.height-12*.3,fill:this._titleOptions.style.color}).font({size:12,anchor:"middle"}).rotate(-90)}}])&&Bd(e.prototype,i),n&&Bd(e,n),r}(Ad),Kd=Vd;function qd(t){return(qd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Hd(t,e){if(null==t)return{};var i,n,o=function(t,e){if(null==t)return{};var i,n,o={},r=Object.keys(t);for(n=0;n<r.length;n++)i=r[n],e.indexOf(i)>=0||(o[i]=t[i]);return o}(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(n=0;n<r.length;n++)i=r[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(o[i]=t[i])}return o}function Zd(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ud(t,e){return(Ud=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Jd(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=$d(t);if(e){var o=$d(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Qd(this,i)}}function Qd(t,e){return!e||"object"!==qd(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function $d(t){return($d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ty=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ud(t,e)}(r,t);var e,i,n,o=Jd(r);function r(t){var e,i=t.renderTo,n=void 0===i?void 0:i,s=t.width,a=void 0===s?void 0:s,u=t.height,l=void 0===u?void 0:u,c=t.coordinateSystem,h=void 0===c?{}:c,f=t.diagram,p=void 0===f?{}:f,d=t.windbarbsProfile,y=void 0===d?{}:d,v=t.windspeedProfile,g=void 0===v?{}:v,m=t.hodograph,_=void 0===m?{}:m,b=t.xAxis,w=void 0===b?{}:b,x=t.yAxis,S=void 0===x?{}:x;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),e=o.call(this,{renderTo:n,width:a,height:l}),p=ey(p),y=ey(y),g=ey(g),_=ey(_),w=ey(w),S=ey(S);var T=.05*e.svgNode.width();return void 0===w.width&&void 0===p.width&&void 0===y.width&&void 0===g.width?(S.width=.1*(e.svgNode.width()-2*T),p.width=.7*(e.svgNode.width()-2*T),y.width=.2*(e.svgNode.width()-2*T)*1/3,g.width=.2*(e.svgNode.width()-2*T)*2/3):void 0===p.width?p.width=e.svgNode.width()-2*T-y.width-g.width:void 0===y.width&&void 0===g.width&&(y.width=1*(e.svgNode.width()-2*T-p.width)/3,g.width=2*(e.svgNode.width()-2*T-p.width)/3),void 0===S.x&&void 0===p.x&&void 0===y.x&&void 0===g.x?(S.x=T,p.x=S.x+S.width,y.x=p.x+p.width,g.x=y.x+y.width):void 0===p.x?p.x=y.x-y.width:void 0===y.x&&void 0===g.x&&(y.x=p.x+p.width,g.x=y.x+y.width),void 0===w.height&&(w.height=.06*e.svgNode.height()),void 0===p.height&&(p.height=e.svgNode.height()-w.height-2*T),void 0===S.height&&(S.height=p.height),void 0===y.height&&(y.height=p.height),void 0===g.height&&(g.height=p.height),void 0===p.y&&(p.y=T),void 0===S.y&&(S.y=p.y),void 0===y.y&&(y.y=p.y),void 0===g.y&&(g.y=p.y),void 0===w.width&&(w.width=p.width),void 0===w.x&&(w.x=p.x),void 0===w.y&&(w.y=p.y+p.height),void 0===w.height&&(w.height=T),void 0===_.x&&(_.x=p.x),void 0===_.y&&(_.y=p.y),void 0===_.width&&(_.width=.4*Math.min(p.width,p.height)),void 0===_.height&&(_.height=_.width),e.diagram=new rd(p),e.appendPlotArea(e.diagram),e.yAxis=new Dd(S),e.appendPlotArea(e.yAxis),e.xAxis=new Vd(w),e.appendPlotArea(e.xAxis),e.windbarbsProfile=new fd(y),e.appendPlotArea(e.windbarbsProfile),e.windspeedProfile=new bd(g),e.appendPlotArea(e.windspeedProfile),e.hodograph=new Pd(_),e.appendPlotArea(e.hodograph),void 0===h.type&&(h.type="skewTlogP"),h.width=p.width,h.height=p.height,e._coordinateSystem,e.coordinateSystem="stueve"==h.type?new up(h):"emagram"==h.type?new yp(h):new xp(h),e}return e=r,(i=[{key:"getDiagramPlotArea",value:function(){return this.diagram}},{key:"coordinateSystem",get:function(){return this._coordinateSystem},set:function(t){this._coordinateSystem=t,this.exchangeCoordinateSystem(this._coordinateSystem)}}])&&Zd(e.prototype,i),n&&Zd(e,n),r}(Uf);function ey(t){var e=t.svgNode,i=void 0===e?void 0:e,n=t.coordinateSystem,o=void 0===n?void 0:n,r=t.x,s=void 0===r?void 0:r,a=t.y,u=void 0===a?void 0:a,l=t.width,c=void 0===l?void 0:l,h=t.height,f=void 0===h?void 0:h,p=t.style,d=void 0===p?{}:p,y=t.visible,v=void 0===y||y,g=t.events,m=void 0===g?{}:g,_=t.hoverLabels,b=void 0===_?{}:_,w=Hd(t,["svgNode","coordinateSystem","x","y","width","height","style","visible","events","hoverLabels"]);return w.svgNode=i,w.coordinateSystem=o,w.x=s,w.y=u,w.width=c,w.height=f,w.style=d,w.visible=v,w.events=m,w.hoverLabels=b,w}var iy={addEventFunctions:F},ny={Animation:tt,Visualisation:lt,makeTimeTextCallbackFunction:function(t){return function(e,i){var n=t.utc(e);return void 0!==this.options.outputTimezone&&("local"==this.options.outputTimezone?n.local():n.tz(this.options.outputTimezone)),n.format(i)}},animation:{ToggleButton:rt,insertFrequencyInput:et,insertFrequencyRange:it,insertFrequencyButtonGroup:function(t,e){var i=e.animation,n=e.frequencies,o=e.btnGroupClass,r=void 0===o?"btn-group":o,s=e.btnClass,a=void 0===s?"btn btn-primary":s,u=e.suffix,l=void 0===u?"fps":u,c=U()("<div>").addClass(r);(n=n||[]).forEach((function(t){c.append(U()("<button>").addClass(a).data("frequency",t).text(t+" "+l).click((function(){return i.setImageFrequency(t)})))}));var h=function(){c.children("button").removeClass("active").each((function(){U()(this).data("frequency")==i.getImageFrequency()&&U()(this).addClass("active")}))};return i.on("change:imageFrequency",h),h(),t.append(c),c},insertRestartPauseInput:nt,insertRestartPauseRange:function(t,e){var i=e.animation,n=e.pauses;n=(n=n||[1]).map((function(t){return Math.round(1e3*t)}));var o=U()("<input>").addClass("custom-range").attr("type","range").attr("min",0).attr("max",n.length-1);o.on("change input",(function(){var t=o.val();t<n.length&&i.setRestartPause(n[t]/1e3)}));var r=function(){var t=n.indexOf(Math.round(1e3*i.getRestartPause()));t>-1&&o.val(t)};return i.on("change:imageFrequency",r),r(),t.append(o),o},insertRestartPauseButtonGroup:function(t,e){var i=e.animation,n=e.pauses,o=e.btnGroupClass,r=void 0===o?"btn-group":o,s=e.btnClass,a=void 0===s?"btn btn-primary":s,u=e.suffix,l=void 0===u?"s":u,c=U()("<div>").addClass(r);(n=n||[]).forEach((function(t){c.append(U()("<button>").addClass(a).data("pause",t).text(t+" "+l).click((function(){return i.setRestartPause(t)})))}));var h=function(){c.children("button").removeClass("active").each((function(){U()(this).data("pause")==i.getRestartPause()&&U()(this).addClass("active")}))};return i.on("change:restartPause",h),h(),t.append(c),c}},visualisation:{Text:mt,Slider:Ot,bsButtons:Mt,bsDropdown:Wt}},oy={Collection:Ut,Map:qt,map:{MapOL:Fa,MapLL:Xa},Resource:ea,resource:{GeoJSON:_l,GeoJSONTile:Gc,Image:dh,OSM:Ah,Vector:pl,VectorTile:Lc},ResourceCollection:la,Tooltip:xa,Type:pa,TypeCollection:wa},ry={BootstrapTooltip:Zh},sy={Parcel:hf},ay={CoordinateSystem:tp,coordinateSystem:{StueveDiagram:up,Emagram:yp,SkewTlogPDiagram:xp},DiagramSounding:jf,Hodograph:Pd,TDDiagram:rd,WindbarbsProfile:fd,WindspeedProfile:bd,axes:{xAxis:Kd,yAxis:Ad}}}]);
//# sourceMappingURL=meteoJS.min.js.map