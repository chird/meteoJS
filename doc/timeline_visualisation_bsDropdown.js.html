<!doctype html>
<html>

<head>
  <meta name="generator" content="JSDoc 3.6.4">
  <meta charset="utf-8">
  <title>Source: timeline/visualisation/bsDropdown.js</title>
  <link rel="stylesheet" href="https://brick.a.ssl.fastly.net/Karla:400,400i,700,700i" type="text/css">
  <link rel="stylesheet" href="https://brick.a.ssl.fastly.net/Noto+Serif:400,400i,700,700i" type="text/css">
  <link rel="stylesheet" href="https://brick.a.ssl.fastly.net/Inconsolata:500" type="text/css">
  <link href="css/baseline.css" rel="stylesheet">
</head>

<body onload="prettyPrint()">
  <nav id="jsdoc-navbar" role="navigation" class="jsdoc-navbar">
    <div id="jsdoc-navbar-container">
      <div id="jsdoc-navbar-content">
        <a href="index.html" class="jsdoc-navbar-package-name">Home</a>
      </div>
    </div>
  </nav>
  <div id="jsdoc-body-container">
    <div id="jsdoc-content">
      <div id="jsdoc-content-container">
        <div id="jsdoc-banner" role="banner">
        </div>
        <div id="jsdoc-main" role="main">
          <header class="page-header">
            <h1>Source: timeline/visualisation/bsDropdown.js</h1>
          </header>
          <article>
            <pre class="prettyprint linenums"><code>/**
 * @module meteoJS/timeline/visualisation/bsDropdown
 */

import $ from &#x27;jquery&#x27;;
import Visualisation from &#x27;../Visualisation.js&#x27;;
import Text from &#x27;./Text.js&#x27;;

/**
 * Options for constructor.
 * 
 * @typedef {module:meteoJS/timeline/visualisation~options}
 *   module:meteoJS/timeline/visualisation/bsDropdown~options
 * @param {string|undefined} format
 *   Format string for dropdown items, used for
 *   {@link external:moment#format}
 * @param {string|undefined} buttonFormat
 *   Format string for dropdown button, used for {@link external:moment#format}.
 * @param {string} grouping
 *   &#x27;daily&#x27;, &#x27;hourly&#x27; or a format string. Defines if items will be grouped and
 *   be title depending on groupingDivider and groupingFormat.
 * @param {boolean} groupingDivider Show dropdown divider above an item group.
 * @param {undefined|string} groupingFormat
 *   Format string for a dropdown header above an item group.
 * @param {undefined|string} classMain Class for the main node.
 * @param {undefined|string} classDropdownMenu Class for the dropdown node.
 * @param {undefined|string} classDropdownItem Class for a dropdown item.
 * @param {undefined|string} classItemActive Class for an active item.
 * @param {undefined|string} classItemNotEnabled Class for a not enabled item.
 * @param {undefined|string} classItemEnabled Class for an enabled item.
 * @param {undefined|string} classItemAllEnabled Class for an all enabled item.
 * @param {undefined|string} classDropdownHeader Class for dropdown header.
 * @param {undefined|string} classDropdownDivider Class for dropdown divider.
 * @param {undefined|string} classDropdownButton Class for the dropdown button.
 * @param {undefined|string} classButtonNotEnabled
 *   Class for the dropdown button if the selected time is not enabled.
 * @param {undefined|string} classButtonEnabled
 *   Class for the dropdown button if the selected time is enabled.
 * @param {undefined|string} classButtonAllEnabled
 *   Class for the dropdown button if the selected time is all enabled.
 */

/**
 * Show timeline in a dropdown menu. The menu will be build according to
 * bootstrap.
 * 
 * @extends module:meteoJS/timeline/visualisation.Visualisation
 */
export class bsDropdown extends Visualisation {
  
  /**
   * @param {module:meteoJS/timeline/visualisation/bsDropdown~options} options - Options.
   */
  constructor(options) {
    /* Sets explictly values, if an option is not existing. $.extend overrides
     * undefined values by the values passed. Without this explictly check you
     * could not pass undefined values, but this is itended. */
    if (!(&#x27;format&#x27; in options))
      options.format &#x3D; &#x27;HH:mm&#x27;;
    if (!(&#x27;buttonFormat&#x27; in options))
      options.buttonFormat &#x3D; &#x27;DD. MMMM YYYY HH:mm&#x27;;
    if (!(&#x27;groupingFormat&#x27; in options))
      options.groupingFormat &#x3D; &#x27;ddd, DD. MMMM YYYY&#x27;;
    if (!(&#x27;classMain&#x27; in options))
      options.classMain &#x3D; &#x27;dropdown&#x27;;
    if (!(&#x27;classDropdownMenu&#x27; in options))
      options.classDropdownMenu &#x3D; &#x27;dropdown-menu&#x27;;
    if (!(&#x27;classDropdownItem&#x27; in options))
      options.classDropdownItem &#x3D; &#x27;dropdown-item&#x27;;
    if (!(&#x27;classItemActive&#x27; in options))
      options.classItemActive &#x3D; &#x27;active&#x27;;
    if (!(&#x27;classItemNotEnabled&#x27; in options))
      options.classItemNotEnabled &#x3D; &#x27;disabled&#x27;;
    if (!(&#x27;classDropdownHeader&#x27; in options))
      options.classDropdownHeader &#x3D; &#x27;dropdown-header&#x27;;
    if (!(&#x27;classDropdownDivider&#x27; in options))
      options.classDropdownDivider &#x3D; &#x27;dropdown-divider&#x27;;
    if (!(&#x27;classDropdownButton&#x27; in options))
      options.classDropdownButton &#x3D; &#x27;btn dropdown-toggle&#x27;;
    options &#x3D; $.extend(true, {
      format: undefined,
      buttonFormat: undefined,
      grouping: &#x27;daily&#x27;,
      groupingDivider: true,
      groupingFormat: undefined,
      classMain: undefined,
      classDropdownMenu: undefined,
      classDropdownItem: undefined,
      classItemActive: undefined,
      classItemNotEnabled: undefined,
      classItemEnabled: undefined,
      classItemAllEnabled: undefined,
      classDropdownHeader: undefined,
      classDropdownDivider: undefined,
      classDropdownButton: undefined,
      classButtonNotEnabled: undefined,
      classButtonEnabled: undefined,
      classButtonAllEnabled: undefined
    }, options);
    
    super(options);
    
    /**
     * @member {module:meteoJS/timeline/visualisation/text.Text}
     * @private
     */
    this.visualisationButtonText &#x3D; new Text({
      timeline: this.options.timeline,
      format: this.options.buttonFormat,
      textInvalid: this.options.textInvalid,
      outputTimezone: this.options.outputTimezone
    });
    /**
     * @member {external:jQuery|undefined}
     * @private
     */
    this.dropdownNode &#x3D; undefined;
    
    this.setNode(this.options.node);
  }
  
  /**
   * @inheritdoc
   */
  setOutputTimezone(outputTimezone) {
    super.setOutputTimezone(outputTimezone);
    this.visualisationButtonText.setOutputTimezone(outputTimezone);
    return this;
  }
  
  /**
   * @inheritdoc
   */
  onChangeTime() {
    if (this.dropdownNode &#x3D;&#x3D;&#x3D; undefined)
      return;
    
    var time &#x3D; this.options.timeline.getSelectedTime();
    this.options.node.children(&#x27;button&#x27;)
      .removeClass(this.options.classButtonActive)
      .removeClass(this.options.classButtonNotEnabled)
      .removeClass(this.options.classButtonEnabled)
      .removeClass(this.options.classButtonAllEnabled);
    if (this.options.timeline.isTimeAllEnabled(time))
      this.options.node.children(&#x27;button&#x27;)
        .addClass(this.options.classButtonAllEnabled);
    else if (this.options.timeline.isTimeEnabled(time))
      this.options.node.children(&#x27;button&#x27;)
        .addClass(this.options.classButtonEnabled);
    else
      this.options.node.children(&#x27;button&#x27;)
        .addClass(this.options.classButtonNotEnabled);
    var that &#x3D; this;
    this.dropdownNode
      .children(&#x27;button.&#x27;+this.options.classDropdownItem)
      .each(function () {
        var t &#x3D; new Date(+$(this).data(&#x27;time&#x27;));
        $(this)
          .removeClass(that.options.classItemActive)
          .removeClass(that.options.classItemNotEnabled)
          .removeClass(that.options.classItemEnabled)
          .removeClass(that.options.classItemAllEnabled);
        if (time.valueOf() &#x3D;&#x3D; t.valueOf())
          $(this).addClass(that.options.classItemActive);
        else if (that.options.timeline.isTimeAllEnabled(t))
          $(this).addClass(that.options.classItemAllEnabled);
        else if (that.options.timeline.isTimeEnabled(t))
          $(this).addClass(that.options.classItemEnabled);
        else
          $(this).addClass(that.options.classItemNotEnabled);
      });
  }
  
  /**
   * @inheritdoc
   */
  onChangeTimes() {
    if (this.dropdownNode &#x3D;&#x3D;&#x3D; undefined)
      this.dropdownNode &#x3D; $(&#x27;&amp;lt;div&gt;&#x27;);
    this.dropdownNode.empty();
    
    var groupingFormat &#x3D;
            (this.options.grouping &#x3D;&#x3D; &#x27;daily&#x27;) ? &#x27;YYYY-MM-DD&#x27; :
              (this.options.grouping &#x3D;&#x3D; &#x27;hourly&#x27;) ? &#x27;YYYY-MM-DD HH&#x27; :
                this.options.grouping;
    var lastGroupTimeStr &#x3D; undefined;
    this.getTimelineTimes().forEach(function (time) {
      if (lastGroupTimeStr &#x3D;&#x3D;&#x3D; undefined ||
                    lastGroupTimeStr !&#x3D; this.timeToText(time, groupingFormat)) {
        if (lastGroupTimeStr !&#x3D;&#x3D; undefined &amp;amp;&amp;amp; // No divider at the beginning
                        this.options.groupingDivider)
          this.dropdownNode
            .append($(&#x27;&amp;lt;div&gt;&#x27;)
              .addClass(this.options.classDropdownDivider));
        if (this.options.groupingFormat !&#x3D;&#x3D; undefined)
          this.dropdownNode
            .append($(&#x27;&amp;lt;h6&gt;&#x27;)
              .addClass(this.options.classDropdownHeader)
              .text(this.timeToText(time, this.options.groupingFormat)));
        lastGroupTimeStr &#x3D; this.timeToText(time, groupingFormat);
      }
      var btn &#x3D; $(&#x27;&amp;lt;button&gt;&#x27;)
        .addClass(this.options.classDropdownItem)
        .attr(&#x27;type&#x27;, &#x27;button&#x27;)
        .text(this.timeToText(time, this.options.format))
        .data(&#x27;time&#x27;, time.valueOf());
      var that &#x3D; this;
      btn.click(function () {
        that.options.timeline.setSelectedTime(new Date(+$(this).data(&#x27;time&#x27;)));
        that.trigger(&#x27;input&#x27;);
      });
      this.dropdownNode.append(btn);
    }, this);
  }
  
  /**
   * @inheritdoc
   */
  emptyNode() {
    if (this.visualisationButtonText !&#x3D;&#x3D; undefined)
      this.visualisationButtonText.setNode(undefined);
    this.dropdownNode &#x3D; undefined;
    this.options.node.empty();
  }
  
  /**
   * @inheritdoc
   */
  onInitNode() {
    var id &#x3D; &#x27;dropdownMenuButton&#x27;;
    var i&#x3D;0;
    while (document.getElementById(id) !&#x3D; null) {
      id &#x3D; &#x27;dropdownMenuButton&#x27;+(++i);
    }
    
    var button &#x3D; $(&#x27;&amp;lt;button&gt;&#x27;)
      .addClass(this.options.classDropdownButton)
      .attr(&#x27;type&#x27;, &#x27;button&#x27;)
      .attr(&#x27;id&#x27;, id)
      .attr(&#x27;data-toggle&#x27;, &#x27;dropdown&#x27;)
      .attr(&#x27;aria-haspopup&#x27;, true)
      .attr(&#x27;aria-expanded&#x27;, false);
    this.visualisationButtonText.setNode(button);
    this.dropdownNode &#x3D; $(&#x27;&amp;lt;div&gt;&#x27;)
      .addClass(this.options.classDropdownMenu)
      .attr(&#x27;aria-labelledby&#x27;, id);
    this.options.node
      .addClass(this.options.classMain)
      .append(button)
      .append(this.dropdownNode);
  }
  
}
export default bsDropdown;</code></pre>
          </article>
        </div>
      </div>
      <nav id="jsdoc-toc-nav" role="navigation"></nav>
    </div>
  </div>
  <footer id="jsdoc-footer" class="jsdoc-footer">
    <div id="jsdoc-footer-container">
      <p>
        Generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc</a> 3.6.4 on May 26, 2020.
      </p>
    </div>
  </footer>
  <script src="scripts/jquery.min.js"></script>
  <script src="scripts/tree.jquery.js"></script>
  <script src="scripts/prettify.js"></script>
  <script src="scripts/jsdoc-toc.js"></script>
  <script src="scripts/linenumber.js"></script>
  <script src="scripts/scrollanchor.js"></script>
</body>

</html>